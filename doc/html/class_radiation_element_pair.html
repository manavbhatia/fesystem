<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>fesystem: RadiationElementPair Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">fesystem
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">RadiationElementPair Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="RadiationElementPair" -->
<p><code>#include &lt;<a class="el" href="_radiation_element_pair_8h_source.html">RadiationElementPair.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for RadiationElementPair:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_element_pair__coll__graph.gif" border="0" usemap="#_radiation_element_pair_coll__map" alt="Collaboration graph"/></div>
<map name="_radiation_element_pair_coll__map" id="_radiation_element_pair_coll__map">
<area shape="rect" id="node2" href="class_radiation_element.html" title="RadiationElement" alt="" coords="30,99,156,127"/><area shape="rect" id="node4" href="struct_radiation_cavity_finite_elem.html" title="RadiationCavityFiniteElem" alt="" coords="4,6,181,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_radiation_element_pair-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532d">ShapeFactorMethod</a> { <br/>
&#160;&#160;<a class="el" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da72bd0f76624b8fbf3f594ac102388431">AUTOMATIC</a>, 
<a class="el" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da3823646906e3779acdf46d10e2212743">DOUBLE_AREA_INT</a>, 
<a class="el" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532dad6b3e29aca2783cd90a9a535eebebb2f">CONTOUR_INT</a>, 
<a class="el" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da62bd790cf2af06cb857619412c85d39e">MITALAS_CONTOUR_INT</a>, 
<br/>
&#160;&#160;<a class="el" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da91166f68da6115a37590f43beef1f5b1">ANALYTIC</a>
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">enum describing the method to be used  <a href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532d">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#ae6257b064fff52da36982dda78dfde44">RadiationElementPair</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor  <a href="#ae6257b064fff52da36982dda78dfde44"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#ab98be6a9e7ad00ce88ce367e3f3e9737">~RadiationElementPair</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor  <a href="#ab98be6a9e7ad00ce88ce367e3f3e9737"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#ac2c50e1d3bcc6f8086469389a56bb229">reinit</a> (<a class="el" href="class_radiation_element.html">RadiationElement</a> *el1, <a class="el" href="class_radiation_element.html">RadiationElement</a> *el2)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes the pair with two elements  <a href="#ac2c50e1d3bcc6f8086469389a56bb229"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#ae297673eb5565ceba91e952b2db04dec">clear</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">clears the initialization  <a href="#ae297673eb5565ceba91e952b2db04dec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#a82194ce5777e2ca4e4824bcf64a62496">getShapeFactor</a> (<a class="el" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532d">ShapeFactorMethod</a> method)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#aeda975a49693c4717d650ebbcfc455c0">analyticShapeFactor</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates and returns the analytic shape factor  <a href="#aeda975a49693c4717d650ebbcfc455c0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#afdcdeea5237500b0f052d7f110d1a668">doubleAreaIntShapeFactor</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates and returns the double area integration shape factor  <a href="#afdcdeea5237500b0f052d7f110d1a668"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#a4e95598570357c97da61af3748c63724">contourIntShapeFactor</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates and returns the contour integration shape factor  <a href="#a4e95598570357c97da61af3748c63724"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#a7364ef6efb17a95f4a5e42192edc8d9d">mitalasContourIntShapeFactor</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates and returns the shape factors using mitalas' method of intgration  <a href="#a7364ef6efb17a95f4a5e42192edc8d9d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::auto_ptr&lt; Elem &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#a0d111b15fe1ac460b0fb574ba24a71a5">createLocalElem</a> (Elem *elem, std::vector&lt; Node &gt; &amp;nodes)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#a20623ee787ccc2a182dde05dd60c9cc8">initialized</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">boolean to keep track of whether the pair has been initialized  <a href="#a20623ee787ccc2a182dde05dd60c9cc8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_radiation_element.html">RadiationElement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_radiation_element.html">RadiationElement</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="_radiation_element_pair_8h_source.html#l00028">28</a> of file <a class="el" href="_radiation_element_pair_8h_source.html">RadiationElementPair.h</a>.</p>
</div><hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="ad8dffe6ca48b084fb7f88fff36dc532d"></a><!-- doxytag: member="RadiationElementPair::ShapeFactorMethod" ref="ad8dffe6ca48b084fb7f88fff36dc532d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532d">RadiationElementPair::ShapeFactorMethod</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>enum describing the method to be used </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ad8dffe6ca48b084fb7f88fff36dc532da72bd0f76624b8fbf3f594ac102388431"></a><!-- doxytag: member="AUTOMATIC" ref="ad8dffe6ca48b084fb7f88fff36dc532da72bd0f76624b8fbf3f594ac102388431" args="" -->AUTOMATIC</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad8dffe6ca48b084fb7f88fff36dc532da3823646906e3779acdf46d10e2212743"></a><!-- doxytag: member="DOUBLE_AREA_INT" ref="ad8dffe6ca48b084fb7f88fff36dc532da3823646906e3779acdf46d10e2212743" args="" -->DOUBLE_AREA_INT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad8dffe6ca48b084fb7f88fff36dc532dad6b3e29aca2783cd90a9a535eebebb2f"></a><!-- doxytag: member="CONTOUR_INT" ref="ad8dffe6ca48b084fb7f88fff36dc532dad6b3e29aca2783cd90a9a535eebebb2f" args="" -->CONTOUR_INT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad8dffe6ca48b084fb7f88fff36dc532da62bd790cf2af06cb857619412c85d39e"></a><!-- doxytag: member="MITALAS_CONTOUR_INT" ref="ad8dffe6ca48b084fb7f88fff36dc532da62bd790cf2af06cb857619412c85d39e" args="" -->MITALAS_CONTOUR_INT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ad8dffe6ca48b084fb7f88fff36dc532da91166f68da6115a37590f43beef1f5b1"></a><!-- doxytag: member="ANALYTIC" ref="ad8dffe6ca48b084fb7f88fff36dc532da91166f68da6115a37590f43beef1f5b1" args="" -->ANALYTIC</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_element_pair_8h_source.html#l00032">32</a> of file <a class="el" href="_radiation_element_pair_8h_source.html">RadiationElementPair.h</a>.</p>
<div class="fragment"><pre class="fragment">    {
      <a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da72bd0f76624b8fbf3f594ac102388431">AUTOMATIC</a>,
      <a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da3823646906e3779acdf46d10e2212743">DOUBLE_AREA_INT</a>,
      <a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532dad6b3e29aca2783cd90a9a535eebebb2f">CONTOUR_INT</a>,
      <a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da62bd790cf2af06cb857619412c85d39e">MITALAS_CONTOUR_INT</a>,
      <a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da91166f68da6115a37590f43beef1f5b1">ANALYTIC</a>
    };
</pre></div>
</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ae6257b064fff52da36982dda78dfde44"></a><!-- doxytag: member="RadiationElementPair::RadiationElementPair" ref="ae6257b064fff52da36982dda78dfde44" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_radiation_element_pair.html#ae6257b064fff52da36982dda78dfde44">RadiationElementPair::RadiationElementPair</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>constructor </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8_c_source.html#l00033">33</a> of file <a class="el" href="_radiation_element_pair_8_c_source.html">RadiationElementPair.C</a>.</p>
<div class="fragment"><pre class="fragment">                                          :
<a class="code" href="class_radiation_element_pair.html#a20623ee787ccc2a182dde05dd60c9cc8" title="boolean to keep track of whether the pair has been initialized">initialized</a>(<span class="keyword">false</span>),
<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>(NULL),
<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>(NULL)
<span class="preprocessor">#ifdef WITH_MATHEMATICA</span>
<span class="preprocessor"></span>,mathematica_link(NULL)
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>{
}
</pre></div>
</div>
</div>
<a class="anchor" id="ab98be6a9e7ad00ce88ce367e3f3e9737"></a><!-- doxytag: member="RadiationElementPair::~RadiationElementPair" ref="ab98be6a9e7ad00ce88ce367e3f3e9737" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_radiation_element_pair.html#ab98be6a9e7ad00ce88ce367e3f3e9737">RadiationElementPair::~RadiationElementPair</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>destructor </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8_c_source.html#l00047">47</a> of file <a class="el" href="_radiation_element_pair_8_c_source.html">RadiationElementPair.C</a>.</p>
<div class="fragment"><pre class="fragment">{

}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aeda975a49693c4717d650ebbcfc455c0"></a><!-- doxytag: member="RadiationElementPair::analyticShapeFactor" ref="aeda975a49693c4717d650ebbcfc455c0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; double, double &gt; <a class="el" href="class_radiation_element_pair.html#aeda975a49693c4717d650ebbcfc455c0">RadiationElementPair::analyticShapeFactor</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates and returns the analytic shape factor </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8_c_source.html#l00145">145</a> of file <a class="el" href="_radiation_element_pair_8_c_source.html">RadiationElementPair.C</a>.</p>

<p>References <a class="el" href="_radiation_element_8h_source.html#l00175">RadiationElement::FeElementFaceID()</a>, <a class="el" href="_radiation_element_8h_source.html#l00195">RadiationElement::getArea()</a>, <a class="el" href="_radiation_element_8_c_source.html#l00221">RadiationElement::getRadiationGeometricElem()</a>, <a class="el" href="_radiation_element_8h_source.html#l00205">RadiationElement::getSurfaceNormal()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00088">rad_elem1</a>, and <a class="el" href="_radiation_element_pair_8h_source.html#l00091">rad_elem2</a>.</p>

<p>Referenced by <a class="el" href="_radiation_element_pair_8_c_source.html#l00107">getShapeFactor()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// get the geometric element for this element pair, and call the librarry function </span>
  <span class="comment">// to get the shape factors</span>
  Elem* elem1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>();
  Elem* elem2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>();

  <span class="keywordtype">double</span> factor_12 = 0.0, factor_21 = 0.0;
  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes1 = elem1-&gt;n_nodes();
  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes2 = elem2-&gt;n_nodes();
  
  <span class="keywordtype">double</span> * node1_coords[3];
  <span class="keywordtype">double</span> * node2_coords[3];
  <span class="comment">// create the matrices for passing to the FormFactor routine</span>
<span class="comment">//  double *x_coords1 = new double[n_nodes1], *y_coords1 = new double[n_nodes1],</span>
<span class="comment">//  *z_coords1 = new double[n_nodes1];</span>
<span class="comment">//  double *x_coords2 = new double[n_nodes2], *y_coords2 = new double[n_nodes2],</span>
<span class="comment">//  *z_coords2 = new double[n_nodes2];</span>

<span class="comment">//  for (unsigned int i=0; i &lt; n_nodes1; i++)</span>
<span class="comment">//    std::cout &lt;&lt; elem1-&gt;point(i);</span>
<span class="comment">//  </span>
<span class="comment">//  std::cout &lt;&lt; &quot; \n \n&quot;;</span>
<span class="comment">//  </span>
<span class="comment">//  for (unsigned int i=0; i &lt; n_nodes2; i++)</span>
<span class="comment">//    std::cout &lt;&lt; elem2-&gt;point(i);</span>

  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; 3; j++)
    {
      node1_coords[j] = <span class="keyword">new</span> <span class="keywordtype">double</span>[n_nodes1];
      node2_coords[j] = <span class="keyword">new</span> <span class="keywordtype">double</span>[n_nodes2];
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_nodes1; i++)
        {
          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ada5a7265983fb39e0ce10eebeeea8aca" title="face ID for the finite element">FeElementFaceID</a>() &lt; 0)
            node1_coords[j][n_nodes1-1-i] = (elem1-&gt;point(i))(j);
          <span class="keywordflow">else</span>
            node1_coords[j][i] = (elem1-&gt;point(i))(j);
        }

      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_nodes2; i++)
        {
          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ada5a7265983fb39e0ce10eebeeea8aca" title="face ID for the finite element">FeElementFaceID</a>() &lt; 0)
            node1_coords[j][n_nodes2-1-i] = (elem2-&gt;point(i))(j);
          <span class="keywordflow">else</span>
            node1_coords[j][i] = (elem2-&gt;point(i))(j);
        }
    }
  
<span class="comment">//  for (unsigned int i=0; i &lt; n_nodes1; i++)</span>
<span class="comment">//    for (unsigned int j=0; j &lt; 3; j++)</span>
<span class="comment">//      {</span>
<span class="comment">//      if (this-&gt;rad_elem1-&gt;FeElementFaceID() &lt; 0)</span>
<span class="comment">//        elem1_points[((n_nodes1-1)-i)*3+j] = (elem1-&gt;point(i))(j);</span>
<span class="comment">//      else</span>
<span class="comment">//        elem1_points[i*3+j] = (elem1-&gt;point(i))(j);</span>
<span class="comment">//      }  </span>
          
<span class="comment">//  for (unsigned int i=0; i &lt; n_nodes2; i++)</span>
<span class="comment">//    for (unsigned int j=0; j &lt; 3; j++)</span>
<span class="comment">//      {</span>
<span class="comment">//      if (this-&gt;rad_elem2-&gt;FeElementFaceID() &lt; 0)</span>
<span class="comment">//        elem2_points[((n_nodes2-1)-i)*3+j] = (elem2-&gt;point(i))(j);</span>
<span class="comment">//      else</span>
<span class="comment">//        elem2_points[i*3+j] = (elem2-&gt;point(i))(j);</span>
<span class="comment">//      }</span>

  Assert(<span class="keyword">false</span>, ExcInternalError());
  
<span class="comment">//      FormFactor( node1_coords, n_nodes1, node2_coords, n_nodes2, </span>
<span class="comment">//                  &amp;factor_12, &amp;factor_21);</span>

<span class="preprocessor">#ifdef WITH_MATHEMATICA</span>
<span class="preprocessor"></span>  <span class="comment">// get the factor from mathematica</span>
  <span class="keywordtype">double</span> factor = MathematicaFormFactor(this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>, this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>, this-&gt;mathematica_link);
  <span class="comment">//  factor_12 = factor / this-&gt;rad_elem1-&gt;getArea();</span>
<span class="comment">//  factor_21 = factor / this-&gt;rad_elem2-&gt;getArea();</span>
  std::cout &lt;&lt; factor_12 &lt;&lt;  <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; factor / this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element">getArea</a>() 
    &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; factor_21 &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; factor / this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element">getArea</a>() &lt;&lt; std::endl;
  <span class="comment">//  std::cout &lt;&lt; factor_12 &lt;&lt;  &quot;  &quot; &lt;&lt; factor &lt;&lt; std::endl; </span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  
  <span class="keywordflow">if</span> (factor_12 &lt; 0)
    factor_12 = 0.0;
  <span class="keywordflow">if</span> (factor_21 &lt; 0)
    factor_21 = 0.0;


  <span class="comment">// if the factor is 1.0, then certain checks need to be made, since the</span>
  <span class="comment">// analytic method is unable to catch the error of surfaces lying on top </span>
  <span class="comment">// of each other, but with opposite orientation, in which case, the factor</span>
  <span class="comment">// is 0.</span>
  <span class="keywordflow">if</span> (fabs(factor_12 -1.0) &lt;= 1.0e-10)
    {
      <span class="keyword">const</span> Point&amp; normal1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>(), 
        normal2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>();
      
      <span class="keywordflow">if</span> (normal1 * normal2 &lt; 0.0)
        {
          factor_12 = 0.0;
          
          <span class="comment">// also, check the other shape factor for the pair.</span>
          <span class="keywordflow">if</span> (fabs(factor_21 -1.0) &lt;= 1.0e-10)
                factor_21 = 0.0;
        }
    }

  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; 3; j++)
    {
      <span class="keyword">delete</span>[] node1_coords[j];
      <span class="keyword">delete</span>[] node2_coords[j];
    }      

  <span class="keywordflow">return</span> std::pair&lt;double, double&gt;(factor_12, factor_21);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_element_pair_aeda975a49693c4717d650ebbcfc455c0_cgraph.gif" border="0" usemap="#class_radiation_element_pair_aeda975a49693c4717d650ebbcfc455c0_cgraph" alt=""/></div>
<map name="class_radiation_element_pair_aeda975a49693c4717d650ebbcfc455c0_cgraph" id="class_radiation_element_pair_aeda975a49693c4717d650ebbcfc455c0_cgraph">
<area shape="rect" id="node3" href="class_radiation_element.html#ada5a7265983fb39e0ce10eebeeea8aca" title="face ID for the finite element" alt="" coords="363,5,605,33"/><area shape="rect" id="node5" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element" alt="" coords="394,57,574,85"/><area shape="rect" id="node11" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem" alt="" coords="334,109,634,137"/><area shape="rect" id="node14" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element" alt="" coords="363,161,605,189"/><area shape="rect" id="node7" href="class_radiation_element.html#a6d2ab9caa8a639051ddcff42e2a8967f" title="init this object" alt="" coords="683,109,834,137"/><area shape="rect" id="node9" href="class_radiation_element.html#af283e728f86eea3d9dcdc15e4a513999" title="method to init the local radiation element in its own coordinates" alt="" coords="883,109,1171,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae297673eb5565ceba91e952b2db04dec"></a><!-- doxytag: member="RadiationElementPair::clear" ref="ae297673eb5565ceba91e952b2db04dec" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_element_pair.html#ae297673eb5565ceba91e952b2db04dec">RadiationElementPair::clear</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>clears the initialization </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8h_source.html#l00156">156</a> of file <a class="el" href="_radiation_element_pair_8h_source.html">RadiationElementPair.h</a>.</p>

<p>References <a class="el" href="_radiation_element_pair_8h_source.html#l00085">initialized</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00088">rad_elem1</a>, and <a class="el" href="_radiation_element_pair_8h_source.html#l00091">rad_elem2</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">RadiationCavityAnalysis::calculateShapeFactorMatrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// this element should be initialized</span>
  this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a> = NULL;
  this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a> = NULL;
  
  this-&gt;<a class="code" href="class_radiation_element_pair.html#a20623ee787ccc2a182dde05dd60c9cc8" title="boolean to keep track of whether the pair has been initialized">initialized</a> = <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4e95598570357c97da61af3748c63724"></a><!-- doxytag: member="RadiationElementPair::contourIntShapeFactor" ref="a4e95598570357c97da61af3748c63724" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; double, double &gt; <a class="el" href="class_radiation_element_pair.html#a4e95598570357c97da61af3748c63724">RadiationElementPair::contourIntShapeFactor</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates and returns the contour integration shape factor </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8_c_source.html#l00379">379</a> of file <a class="el" href="_radiation_element_pair_8_c_source.html">RadiationElementPair.C</a>.</p>

<p>References <a class="el" href="_contour_integration_8h_source.html#l00093">EdgeFactor()</a>, <a class="el" href="_f_e_system_numbers_8h_source.html#l00013">FESystemNumbers::Epsilon</a>, <a class="el" href="_radiation_element_8h_source.html#l00195">RadiationElement::getArea()</a>, <a class="el" href="_radiation_element_8_c_source.html#l00221">RadiationElement::getRadiationGeometricElem()</a>, <a class="el" href="_radiation_element_8h_source.html#l00205">RadiationElement::getSurfaceNormal()</a>, <a class="el" href="_f_e_system_numbers_8h_source.html#l00015">FESystemNumbers::Pi</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00088">rad_elem1</a>, and <a class="el" href="_radiation_element_pair_8h_source.html#l00091">rad_elem2</a>.</p>

<p>Referenced by <a class="el" href="_radiation_element_pair_8_c_source.html#l00107">getShapeFactor()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> <span class="keywordtype">double</span> factor;
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sides1, n_sides2, j1, j2;
  factor = 0.0;
    
  Point&amp; normal1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>();
  Point&amp; normal2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>();
  
  <span class="comment">// since the cavity is assumed to be convex, if the normals are parallel, </span>
  <span class="comment">// and if the dot product of the normals is not negative, then they lie in</span>
  <span class="comment">// the same plane, and their shape factor should be zero.</span>
  <span class="keywordflow">if</span> (fabs(normal1 * normal2 - 1.0) &lt;= <a class="code" href="namespace_f_e_system_numbers.html#a125baf0bb57a1b430fb84d29716bf619" title="the smallest size limit for division in the code">FESystemNumbers::Epsilon</a>)
    <span class="keywordflow">return</span> std::pair&lt;double, double&gt;(0.0, 0.0);

  <span class="comment">// get the elems from the rad elems</span>
  <span class="keyword">const</span> Elem* elem1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>();
  <span class="keyword">const</span> Elem* elem2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>();

  n_sides1 = elem1-&gt;n_sides();
  n_sides2 = elem2-&gt;n_sides();

  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_sides1; i++)
    {
    <span class="comment">// get the nodes for this side</span>
    <span class="keywordflow">if</span> (i == (n_sides1-1))
      j1 = 0;
    <span class="keywordflow">else</span> 
      j1 = i + 1;

    <span class="keyword">const</span> Point&amp; p1 = elem1-&gt;point(i);
    <span class="keyword">const</span> Point&amp; q1 = elem1-&gt;point(j1);

    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; elem2-&gt;n_sides(); j++)
      {
      <span class="keywordflow">if</span> (j == (n_sides2-1))
        j2 = 0;
      <span class="keywordflow">else</span>
        j2 = j + 1;

      <span class="keyword">const</span> Point&amp; p2 = elem2-&gt;point(j);
      <span class="keyword">const</span> Point&amp; q2 = elem2-&gt;point(j2);
      
      factor += <a class="code" href="_contour_integration_8h.html#a30908586f46b5340e5287573d1ad50d4">EdgeFactor</a>(p1, q1, p2, q2);
      }
    }
  
  factor /= (2.0 * <a class="code" href="namespace_f_e_system_numbers.html#ac0772631a425b77ff7f67e05d1080a41">FESystemNumbers::Pi</a>);
  
  <span class="keywordtype">double</span> area1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element">getArea</a>(),
    area2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element">getArea</a>();
  
  <span class="keywordflow">if</span> (factor &lt; 0.0)
    factor = 0.0;
  
  <span class="keywordflow">return</span> std::pair&lt;double, double&gt;(factor/area1, factor/area2);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_element_pair_a4e95598570357c97da61af3748c63724_cgraph.gif" border="0" usemap="#class_radiation_element_pair_a4e95598570357c97da61af3748c63724_cgraph" alt=""/></div>
<map name="class_radiation_element_pair_a4e95598570357c97da61af3748c63724_cgraph" id="class_radiation_element_pair_a4e95598570357c97da61af3748c63724_cgraph">
<area shape="rect" id="node3" href="_contour_integration_8h.html#a30908586f46b5340e5287573d1ad50d4" title="EdgeFactor" alt="" coords="452,57,542,85"/><area shape="rect" id="node11" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element" alt="" coords="407,109,588,137"/><area shape="rect" id="node17" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem" alt="" coords="347,161,648,189"/><area shape="rect" id="node20" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element" alt="" coords="377,213,618,241"/><area shape="rect" id="node5" href="_contour_integration_8h.html#ad84e65074db2b5ea6d44efce76c3a679" title="F1" alt="" coords="753,5,791,33"/><area shape="rect" id="node7" href="_contour_integration_8h.html#acbcd2ccad2ab5d4231a258dcb2a81f2a" title="F2" alt="" coords="753,57,791,85"/><area shape="rect" id="node9" href="_contour_integration_8h.html#ae6f7aa8b9240a7cc1092283a5cf61f75" title="F3" alt="" coords="753,109,791,137"/><area shape="rect" id="node13" href="class_radiation_element.html#a6d2ab9caa8a639051ddcff42e2a8967f" title="init this object" alt="" coords="696,161,848,189"/><area shape="rect" id="node15" href="class_radiation_element.html#af283e728f86eea3d9dcdc15e4a513999" title="method to init the local radiation element in its own coordinates" alt="" coords="896,161,1184,189"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0d111b15fe1ac460b0fb574ba24a71a5"></a><!-- doxytag: member="RadiationElementPair::createLocalElem" ref="a0d111b15fe1ac460b0fb574ba24a71a5" args="(Elem *elem, std::vector&lt; Node &gt; &amp;nodes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::auto_ptr&lt; Elem &gt; <a class="el" href="class_radiation_element_pair.html#a0d111b15fe1ac460b0fb574ba24a71a5">RadiationElementPair::createLocalElem</a> </td>
          <td>(</td>
          <td class="paramtype">Elem *&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Node &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>returns the elem in its local coordinated </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">elem</td><td>the elem in global space for which local mesh has to be created </td></tr>
    <tr><td class="paramname">nodes</td><td>nodes for the elem will be returned in this vector of nodes </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_element_pair_8_c_source.html#l00055">55</a> of file <a class="el" href="_radiation_element_pair_8_c_source.html">RadiationElementPair.C</a>.</p>
<div class="fragment"><pre class="fragment">{
                
  <span class="comment">//get the four nodes of this elem</span>
  <span class="keyword">const</span> Point&amp; point0 = elem-&gt;point(0);
  <span class="keyword">const</span> Point&amp; point1 = elem-&gt;point(1);
  <span class="keyword">const</span> Point&amp; point2 = elem-&gt;point(2);
  <span class="keyword">const</span> Point&amp; point3 = elem-&gt;point(3);
                
  <span class="comment">//calculate the position vectors from point 0</span>
  Point vector01, vector02, vector03, tmp_vector1, tmp_vector2;
  vector01.assign(point1 - point0);
  vector02.assign(point2 - point0);
  vector03.assign(point3 - point0);
                
  Point new_unit_vec_x = vector01.unit();
                
  tmp_vector1.assign(new_unit_vec_x.cross(vector03));
  tmp_vector2 = tmp_vector1.unit();
                
  Point new_unit_vec_y = tmp_vector2.cross(new_unit_vec_x);
                
  <span class="comment">//create a new element and set its two nodes at the</span>
  <span class="comment">//origin and the elem length</span>
  Point new_point0(0. ,0. ,0. );
  Point new_point1(vector01.size() ,0. ,0.);
  Point new_point2(vector02 * new_unit_vec_x, 
                   vector02 * new_unit_vec_y, 
                   0.);
  Point new_point3(vector03 * new_unit_vec_x, 
                   vector03 * new_unit_vec_y, 
                   0.);
                
  nodes.push_back(Node(new_point0, 0));
  nodes.push_back(Node(new_point1, 1));
  nodes.push_back(Node(new_point2, 2));
  nodes.push_back(Node(new_point3, 3));
                
  <span class="comment">// now create the local element and set its nodes</span>
  std::auto_ptr&lt;Elem&gt; local_elem(<span class="keyword">new</span> Quad4);
  local_elem-&gt;set_node(0) = &amp;(nodes[0]);
  local_elem-&gt;set_node(1) = &amp;(nodes[1]);
  local_elem-&gt;set_node(2) = &amp;(nodes[2]);
  local_elem-&gt;set_node(3) = &amp;(nodes[3]);
  
  <span class="keywordflow">return</span> local_elem;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afdcdeea5237500b0f052d7f110d1a668"></a><!-- doxytag: member="RadiationElementPair::doubleAreaIntShapeFactor" ref="afdcdeea5237500b0f052d7f110d1a668" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; double, double &gt; <a class="el" href="class_radiation_element_pair.html#afdcdeea5237500b0f052d7f110d1a668">RadiationElementPair::doubleAreaIntShapeFactor</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates and returns the double area integration shape factor </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8_c_source.html#l00265">265</a> of file <a class="el" href="_radiation_element_pair_8_c_source.html">RadiationElementPair.C</a>.</p>

<p>References <a class="el" href="_f_e_system_numbers_8h_source.html#l00013">FESystemNumbers::Epsilon</a>, <a class="el" href="_radiation_element_8h_source.html#l00195">RadiationElement::getArea()</a>, <a class="el" href="_radiation_element_8h_source.html#l00235">RadiationElement::getLocalRadiationGeometricElem()</a>, <a class="el" href="_radiation_element_8_c_source.html#l00221">RadiationElement::getRadiationGeometricElem()</a>, <a class="el" href="_radiation_element_8h_source.html#l00205">RadiationElement::getSurfaceNormal()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00085">initialized</a>, <a class="el" href="_f_e_system_numbers_8h_source.html#l00015">FESystemNumbers::Pi</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00088">rad_elem1</a>, and <a class="el" href="_radiation_element_pair_8h_source.html#l00091">rad_elem2</a>.</p>

<p>Referenced by <a class="el" href="_radiation_element_pair_8_c_source.html#l00107">getShapeFactor()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">bool</span> <a class="code" href="class_radiation_element_pair.html#a20623ee787ccc2a182dde05dd60c9cc8" title="boolean to keep track of whether the pair has been initialized">initialized</a> = <span class="keyword">false</span>;

  FEType fetype(FIRST, LAGRANGE);
<span class="comment">//  std::auto_ptr&lt;Elem&gt; local_elem1(NULL), local_elem2(NULL);</span>
<span class="comment">//  std::vector&lt;Node&gt; local_elem1_nodes, local_elem2_nodes;</span>
  std::auto_ptr&lt;FEBase &gt; 
    fe_elem1(FEBase::build(2,fetype).release()), 
    fe_elem2(FEBase::build(2,fetype).release()); 
  std::auto_ptr&lt;QBase&gt; 
    qbase_elem1(QBase::build(QGAUSS, 2, ELEVENTH).release()), 
    qbase_elem2(QBase::build(QGAUSS, 2, ELEVENTH).release());
  
  <span class="comment">// get the elems from the rad elems</span>
  Elem* elem1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>();
  Elem* elem2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>();

  Point&amp; normal1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>();
  Point&amp; normal2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>();

  <span class="comment">// since the cavity is assumed to be convex, if the normals are parallel, </span>
  <span class="comment">// and if the dot product of the normals is not negative, then they lie in</span>
  <span class="comment">// the same plane, and their shape factor should be zero.</span>
  <span class="keywordflow">if</span> (fabs(normal1 * normal2 - 1.0) &lt;= <a class="code" href="namespace_f_e_system_numbers.html#a125baf0bb57a1b430fb84d29716bf619" title="the smallest size limit for division in the code">FESystemNumbers::Epsilon</a>)
    <span class="keywordflow">return</span> std::pair&lt;double, double&gt;(0.0, 0.0);
  
  <span class="comment">// now, initialize the elements</span>
        <span class="keywordflow">if</span> (!initialized)
    {
    fe_elem1-&gt;attach_quadrature_rule(qbase_elem1.get());
    fe_elem2-&gt;attach_quadrature_rule(qbase_elem2.get());
    initialized = <span class="keyword">true</span>;
    }

  <span class="comment">// this has been commented out, since the local element is now being </span>
  <span class="comment">// obtained from the radiation element</span>
<span class="comment">//  // now create local elements</span>
<span class="comment">//  local_elem1.reset(this-&gt;createLocalElem(elem1,</span>
<span class="comment">//                                        local_elem1_nodes).release());</span>
<span class="comment">//  </span>
<span class="comment">//  local_elem2.reset(this-&gt;createLocalElem(elem2,</span>
<span class="comment">//                                        local_elem2_nodes).release());</span>
  
  fe_elem1-&gt;reinit(this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#a7e94cd8e52f1c0744a35a8d0c99ad637" title="returns the local radiation element">getLocalRadiationGeometricElem</a>());
  fe_elem2-&gt;reinit(this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#a7e94cd8e52f1c0744a35a8d0c99ad637" title="returns the local radiation element">getLocalRadiationGeometricElem</a>());

  <span class="keywordtype">double</span> factor = 0.0, area1 = 0.0, area2 = 0.0;
  <span class="keywordtype">double</span> length = 0.0, cos_theta1 = 0.0, cos_theta2 = 0.0;
  Point point1, point2, point12;

  area1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element">getArea</a>();
  area2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element">getArea</a>();

  <span class="keyword">const</span> std::vector&lt;Real&gt;&amp; JxW1 = fe_elem1-&gt;get_JxW();
  <span class="keyword">const</span> std::vector&lt;std::vector&lt;Real&gt; &gt;&amp; phi1 = fe_elem1-&gt;get_phi();
  <span class="keyword">const</span> std::vector&lt;Real&gt;&amp; JxW2 = fe_elem2-&gt;get_JxW();
  <span class="keyword">const</span> std::vector&lt;std::vector&lt;Real&gt; &gt;&amp; phi2 = fe_elem2-&gt;get_phi();
  
  
  <span class="comment">// get the location of the nodes of the two elements</span>
  <span class="comment">// this is available from the local_elem_node pointers</span>
  
  <span class="comment">// iterate  over the quadrature points of both the elements</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp1=0; qp1&lt;qbase_elem1-&gt;n_points(); qp1++)
    {
      point1.zero();
                
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> node_it=0; node_it&lt;phi1.size(); node_it++)
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> coord_it=0; coord_it&lt;3; coord_it++)
        point1(coord_it) += 
              phi1[node_it][qp1] * (elem1-&gt;point(node_it))(coord_it);
                                
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp2=0; qp2&lt;qbase_elem2-&gt;n_points(); qp2++)
      {                 
      point2.zero();
      point12.zero(); length = 0.0; cos_theta1 = 0.0; cos_theta2= 0.0;
      <span class="comment">// get location of the quadrature points 1 and 2 using the nodal location</span>
      <span class="comment">// and shape function values at the quadrature points</span>
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> node_it=0; node_it&lt;phi2.size(); node_it++)
        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> coord_it=0; coord_it&lt;3; coord_it++)
          point2(coord_it) += 
          phi2[node_it][qp2] * (elem2-&gt;point(node_it))(coord_it);
          
          
      <span class="comment">// calculate the vector from point 1 to 2</span>
      point12.assign(point2);
      point12 -= point1;
      length = point12.size();
      
      <span class="comment">// calculate the value of cos(theta) at point 1 and 2</span>
      <span class="keywordflow">if</span> (length &gt;  1.0e-12)
        {
        cos_theta1 = fabs((normal1) * point12) / length;
        cos_theta2 = fabs((normal2) * point12) / length;
        
        factor += (cos_theta1 * cos_theta2)/(<a class="code" href="namespace_f_e_system_numbers.html#ac0772631a425b77ff7f67e05d1080a41">FESystemNumbers::Pi</a>* length * length) * 
          JxW1[qp1] * JxW2[qp2];
        }
      }
    }
    
    <span class="keywordflow">if</span> (factor &lt; 0.0)
      factor = 0.0;
    
    <span class="keywordflow">return</span> std::pair&lt;double, double&gt;(factor/area1, factor/area2);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_element_pair_afdcdeea5237500b0f052d7f110d1a668_cgraph.gif" border="0" usemap="#class_radiation_element_pair_afdcdeea5237500b0f052d7f110d1a668_cgraph" alt=""/></div>
<map name="class_radiation_element_pair_afdcdeea5237500b0f052d7f110d1a668_cgraph" id="class_radiation_element_pair_afdcdeea5237500b0f052d7f110d1a668_cgraph">
<area shape="rect" id="node3" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element" alt="" coords="447,5,628,33"/><area shape="rect" id="node9" href="class_radiation_element.html#a7e94cd8e52f1c0744a35a8d0c99ad637" title="returns the local radiation element" alt="" coords="371,57,704,85"/><area shape="rect" id="node12" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem" alt="" coords="387,109,688,137"/><area shape="rect" id="node15" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element" alt="" coords="417,161,658,189"/><area shape="rect" id="node5" href="class_radiation_element.html#a6d2ab9caa8a639051ddcff42e2a8967f" title="init this object" alt="" coords="752,83,904,111"/><area shape="rect" id="node7" href="class_radiation_element.html#af283e728f86eea3d9dcdc15e4a513999" title="method to init the local radiation element in its own coordinates" alt="" coords="952,83,1240,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a82194ce5777e2ca4e4824bcf64a62496"></a><!-- doxytag: member="RadiationElementPair::getShapeFactor" ref="a82194ce5777e2ca4e4824bcf64a62496" args="(ShapeFactorMethod method)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; double, double &gt; <a class="el" href="class_radiation_element_pair.html#a82194ce5777e2ca4e4824bcf64a62496">RadiationElementPair::getShapeFactor</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532d">ShapeFactorMethod</a>&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>returns the shape factors between the elements as a pair, first element is F1-&gt;2, and the second is F2-&gt;1 </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8_c_source.html#l00107">107</a> of file <a class="el" href="_radiation_element_pair_8_c_source.html">RadiationElementPair.C</a>.</p>

<p>References <a class="el" href="_radiation_element_pair_8h_source.html#l00038">ANALYTIC</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00145">analyticShapeFactor()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00036">CONTOUR_INT</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00379">contourIntShapeFactor()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00035">DOUBLE_AREA_INT</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00265">doubleAreaIntShapeFactor()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00037">MITALAS_CONTOUR_INT</a>, and <a class="el" href="_radiation_element_pair_8_c_source.html#l00443">mitalasContourIntShapeFactor()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">RadiationCavityAnalysis::calculateShapeFactorMatrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">switch</span> (method)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da3823646906e3779acdf46d10e2212743">DOUBLE_AREA_INT</a>:
      {
        <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_radiation_element_pair.html#afdcdeea5237500b0f052d7f110d1a668" title="calculates and returns the double area integration shape factor">doubleAreaIntShapeFactor</a>();
      }
      <span class="keywordflow">break</span>;
      
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da91166f68da6115a37590f43beef1f5b1">ANALYTIC</a>:
      {
        <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_radiation_element_pair.html#aeda975a49693c4717d650ebbcfc455c0" title="calculates and returns the analytic shape factor">analyticShapeFactor</a>();
      }
      <span class="keywordflow">break</span>;
      

    <span class="keywordflow">case</span> <a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532dad6b3e29aca2783cd90a9a535eebebb2f">CONTOUR_INT</a>:
      {
        <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_radiation_element_pair.html#a4e95598570357c97da61af3748c63724" title="calculates and returns the contour integration shape factor">contourIntShapeFactor</a>();
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da62bd790cf2af06cb857619412c85d39e">MITALAS_CONTOUR_INT</a>:
      {
        <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_radiation_element_pair.html#a7364ef6efb17a95f4a5e42192edc8d9d" title="calculates and returns the shape factors using mitalas&#39; method of intgration">mitalasContourIntShapeFactor</a>();
      }
      <span class="keywordflow">break</span>;

    <span class="keywordflow">default</span>:
      abort();
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_element_pair_a82194ce5777e2ca4e4824bcf64a62496_cgraph.gif" border="0" usemap="#class_radiation_element_pair_a82194ce5777e2ca4e4824bcf64a62496_cgraph" alt=""/></div>
<map name="class_radiation_element_pair_a82194ce5777e2ca4e4824bcf64a62496_cgraph" id="class_radiation_element_pair_a82194ce5777e2ca4e4824bcf64a62496_cgraph">
<area shape="rect" id="node3" href="class_radiation_element_pair.html#aeda975a49693c4717d650ebbcfc455c0" title="calculates and returns the analytic shape factor" alt="" coords="336,109,616,137"/><area shape="rect" id="node19" href="class_radiation_element_pair.html#a4e95598570357c97da61af3748c63724" title="calculates and returns the contour integration shape factor" alt="" coords="329,213,623,241"/><area shape="rect" id="node32" href="class_radiation_element_pair.html#afdcdeea5237500b0f052d7f110d1a668" title="calculates and returns the double area integration shape factor" alt="" coords="317,161,635,189"/><area shape="rect" id="node40" href="class_radiation_element_pair.html#a7364ef6efb17a95f4a5e42192edc8d9d" title="calculates and returns the shape factors using mitalas&#39; method of intgration" alt="" coords="307,57,645,85"/><area shape="rect" id="node5" href="class_radiation_element.html#ada5a7265983fb39e0ce10eebeeea8aca" title="face ID for the finite element" alt="" coords="739,57,981,85"/><area shape="rect" id="node7" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element" alt="" coords="770,109,950,137"/><area shape="rect" id="node13" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem" alt="" coords="710,161,1010,189"/><area shape="rect" id="node16" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element" alt="" coords="739,213,981,241"/><area shape="rect" id="node9" href="class_radiation_element.html#a6d2ab9caa8a639051ddcff42e2a8967f" title="init this object" alt="" coords="1075,187,1226,215"/><area shape="rect" id="node11" href="class_radiation_element.html#af283e728f86eea3d9dcdc15e4a513999" title="method to init the local radiation element in its own coordinates" alt="" coords="1275,187,1563,215"/><area shape="rect" id="node21" href="_contour_integration_8h.html#a30908586f46b5340e5287573d1ad50d4" title="EdgeFactor" alt="" coords="815,317,905,345"/><area shape="rect" id="node23" href="_contour_integration_8h.html#ad84e65074db2b5ea6d44efce76c3a679" title="F1" alt="" coords="1131,265,1170,293"/><area shape="rect" id="node25" href="_contour_integration_8h.html#acbcd2ccad2ab5d4231a258dcb2a81f2a" title="F2" alt="" coords="1131,317,1170,345"/><area shape="rect" id="node27" href="_contour_integration_8h.html#ae6f7aa8b9240a7cc1092283a5cf61f75" title="F3" alt="" coords="1131,369,1170,397"/><area shape="rect" id="node35" href="class_radiation_element.html#a7e94cd8e52f1c0744a35a8d0c99ad637" title="returns the local radiation element" alt="" coords="694,265,1026,293"/><area shape="rect" id="node44" href="_mitalas_integration_8h.html#a9ef658341de25246820d0aaf0771337e" title="MitalasEdgeFactor" alt="" coords="794,5,926,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7364ef6efb17a95f4a5e42192edc8d9d"></a><!-- doxytag: member="RadiationElementPair::mitalasContourIntShapeFactor" ref="a7364ef6efb17a95f4a5e42192edc8d9d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; double, double &gt; <a class="el" href="class_radiation_element_pair.html#a7364ef6efb17a95f4a5e42192edc8d9d">RadiationElementPair::mitalasContourIntShapeFactor</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates and returns the shape factors using mitalas' method of intgration </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8_c_source.html#l00443">443</a> of file <a class="el" href="_radiation_element_pair_8_c_source.html">RadiationElementPair.C</a>.</p>

<p>References <a class="el" href="_f_e_system_numbers_8h_source.html#l00013">FESystemNumbers::Epsilon</a>, <a class="el" href="_radiation_element_8h_source.html#l00175">RadiationElement::FeElementFaceID()</a>, <a class="el" href="_radiation_element_8h_source.html#l00195">RadiationElement::getArea()</a>, <a class="el" href="_radiation_element_8_c_source.html#l00221">RadiationElement::getRadiationGeometricElem()</a>, <a class="el" href="_radiation_element_8h_source.html#l00205">RadiationElement::getSurfaceNormal()</a>, <a class="el" href="_mitalas_integration_8h_source.html#l00018">MitalasEdgeFactor()</a>, <a class="el" href="_f_e_system_numbers_8h_source.html#l00015">FESystemNumbers::Pi</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00088">rad_elem1</a>, and <a class="el" href="_radiation_element_pair_8h_source.html#l00091">rad_elem2</a>.</p>

<p>Referenced by <a class="el" href="_radiation_element_pair_8_c_source.html#l00107">getShapeFactor()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> <span class="keywordtype">double</span> factor;
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sides1, n_sides2, j1, j2;
  factor = 0.0;

<span class="comment">//  double val1, val2;</span>
  
  Point&amp; normal1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>();
  Point&amp; normal2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>();
  
  <span class="comment">// since the cavity is assumed to be convex, if the normals are parallel, </span>
  <span class="comment">// and if the dot product of the normals is not negative, then they lie in</span>
  <span class="comment">// the same plane, and their shape factor should be zero.</span>
  <span class="keywordflow">if</span> (fabs(normal1 * normal2 - 1.0) &lt;= <a class="code" href="namespace_f_e_system_numbers.html#a125baf0bb57a1b430fb84d29716bf619" title="the smallest size limit for division in the code">FESystemNumbers::Epsilon</a>)
    <span class="keywordflow">return</span> std::pair&lt;double, double&gt;(0.0, 0.0);
  
  <span class="comment">// get the elems from the rad elems</span>
  <span class="keyword">const</span> Elem* elem1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>();
  <span class="keyword">const</span> Elem* elem2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>();
  
  n_sides1 = elem1-&gt;n_sides();
  n_sides2 = elem2-&gt;n_sides();
  
<span class="comment">//  for (unsigned int i=0; i &lt; elem1-&gt;n_nodes(); i++)</span>
<span class="comment">//    std::cout &lt;&lt; elem1-&gt;point(i);</span>
<span class="comment">//  std::cout &lt;&lt; std::endl;</span>
<span class="comment">//  for (unsigned int i=0; i &lt; elem2-&gt;n_nodes(); i++)</span>
<span class="comment">//    std::cout &lt;&lt; elem2-&gt;point(i);</span>
<span class="comment">//  std::cout &lt;&lt; std::endl;</span>
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_sides1; i++)
    {
    <span class="comment">// get the nodes for this side</span>
    <span class="keywordflow">if</span> (i == (n_sides1-1))
      j1 = 0;
    <span class="keywordflow">else</span> 
      j1 = i + 1;
    
    <span class="keyword">const</span> Point&amp; p1 = elem1-&gt;point(i);
    <span class="keyword">const</span> Point&amp; q1 = elem1-&gt;point(j1);
    
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; n_sides2; j++)
      {
      <span class="keywordflow">if</span> (j == (n_sides2-1))
        j2 = 0;
      <span class="keywordflow">else</span>
        j2 = j + 1;
      
      <span class="keyword">const</span> Point&amp; p2 = elem2-&gt;point(j);
      <span class="keyword">const</span> Point&amp; q2 = elem2-&gt;point(j2);
      
<span class="comment">//      val1 = MitalasEdgeFactor(p1, q1, p2, q2);</span>
<span class="comment">//      val2 = NumIntEdgeFactor(p1, q1, p2, q2);</span>
<span class="comment">//      if (fabs(val1 - val2) &gt; 1.0e-5)</span>
<span class="comment">//        {</span>
<span class="comment">//        std::cout &lt;&lt; p1 &lt;&lt; q1;</span>
<span class="comment">//        std::cout &lt;&lt; p2 &lt;&lt; q2;</span>
<span class="comment">//        std::cout &lt;&lt; &quot;milatas : &quot; &lt;&lt; val1 &lt;&lt; &quot;  numeric: &quot; &lt;&lt;  val2&lt;&lt; std::endl; </span>
<span class="comment">//        }</span>
  
      factor += <a class="code" href="_mitalas_integration_8h.html#a9ef658341de25246820d0aaf0771337e">MitalasEdgeFactor</a>(p1, q1, p2, q2);
      }
    }

  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ada5a7265983fb39e0ce10eebeeea8aca" title="face ID for the finite element">FeElementFaceID</a>() &lt; 0)
    factor *= -1.0;
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ada5a7265983fb39e0ce10eebeeea8aca" title="face ID for the finite element">FeElementFaceID</a>() &lt; 0)
    factor *= -1.0;
  
  factor /= (2.0 * <a class="code" href="namespace_f_e_system_numbers.html#ac0772631a425b77ff7f67e05d1080a41">FESystemNumbers::Pi</a>);

  
  <span class="keywordtype">double</span> area1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element">getArea</a>(),
    area2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element">getArea</a>();
  
<span class="comment">//  std::cout &lt;&lt; this-&gt;rad_elem1-&gt;FeElementID() &lt;&lt; &quot;,&quot; &lt;&lt; </span>
<span class="comment">//    this-&gt;rad_elem2-&gt;FeElementID() &lt;&lt; &quot; : &quot; &lt;&lt; </span>
<span class="comment">//    factor/area1 &lt;&lt; &quot;,&quot; &lt;&lt; factor/area2 &lt;&lt; std::endl;</span>

  <span class="comment">//  std::cout &lt;&lt; &quot;factor : &quot; &lt;&lt; factor &lt;&lt; std::endl;</span>
<span class="comment">//  std::cout &lt;&lt; std::endl;</span>
  
  <span class="keywordflow">if</span> (factor &lt; 0.0)
    factor = 0.0;
  
  <span class="keywordflow">return</span> std::pair&lt;double, double&gt;(factor/area1, factor/area2); 
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_element_pair_a7364ef6efb17a95f4a5e42192edc8d9d_cgraph.gif" border="0" usemap="#class_radiation_element_pair_a7364ef6efb17a95f4a5e42192edc8d9d_cgraph" alt=""/></div>
<map name="class_radiation_element_pair_a7364ef6efb17a95f4a5e42192edc8d9d_cgraph" id="class_radiation_element_pair_a7364ef6efb17a95f4a5e42192edc8d9d_cgraph">
<area shape="rect" id="node3" href="class_radiation_element.html#ada5a7265983fb39e0ce10eebeeea8aca" title="face ID for the finite element" alt="" coords="422,5,663,33"/><area shape="rect" id="node5" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element" alt="" coords="452,57,633,85"/><area shape="rect" id="node11" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem" alt="" coords="392,109,693,137"/><area shape="rect" id="node14" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element" alt="" coords="422,161,663,189"/><area shape="rect" id="node17" href="_mitalas_integration_8h.html#a9ef658341de25246820d0aaf0771337e" title="MitalasEdgeFactor" alt="" coords="476,213,609,241"/><area shape="rect" id="node7" href="class_radiation_element.html#a6d2ab9caa8a639051ddcff42e2a8967f" title="init this object" alt="" coords="742,109,893,137"/><area shape="rect" id="node9" href="class_radiation_element.html#af283e728f86eea3d9dcdc15e4a513999" title="method to init the local radiation element in its own coordinates" alt="" coords="941,109,1229,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac2c50e1d3bcc6f8086469389a56bb229"></a><!-- doxytag: member="RadiationElementPair::reinit" ref="ac2c50e1d3bcc6f8086469389a56bb229" args="(RadiationElement *el1, RadiationElement *el2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_element_pair.html#ac2c50e1d3bcc6f8086469389a56bb229">RadiationElementPair::reinit</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_radiation_element.html">RadiationElement</a> *&#160;</td>
          <td class="paramname"><em>el1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_radiation_element.html">RadiationElement</a> *&#160;</td>
          <td class="paramname"><em>el2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>initializes the pair with two elements </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8h_source.html#l00104">104</a> of file <a class="el" href="_radiation_element_pair_8h_source.html">RadiationElementPair.h</a>.</p>

<p>References <a class="el" href="_radiation_element_8h_source.html#l00168">RadiationElement::FeElementID()</a>, <a class="el" href="_radiation_element_8_c_source.html#l00221">RadiationElement::getRadiationGeometricElem()</a>, <a class="el" href="_radiation_element_8h_source.html#l00205">RadiationElement::getSurfaceNormal()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00085">initialized</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00088">rad_elem1</a>, and <a class="el" href="_radiation_element_pair_8h_source.html#l00091">rad_elem2</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">RadiationCavityAnalysis::calculateShapeFactorMatrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// this element should be initialized</span>
  Assert(!this-&gt;<a class="code" href="class_radiation_element_pair.html#a20623ee787ccc2a182dde05dd60c9cc8" title="boolean to keep track of whether the pair has been initialized">initialized</a>, ExcInternalError());
  Assert(el1 != NULL, ExcInternalError());
  Assert(el2 != NULL, ExcInternalError());

  this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a> = el1;
  this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a> = el2;
  
<span class="preprocessor">#ifdef DEBUG</span>
<span class="preprocessor"></span>  <span class="comment">// make sure that the elements &quot;see&quot; each other </span>
  <span class="comment">// for this, the dot product of the surface normal of an element </span>
  <span class="comment">// to any vector to the other surface should be positive</span>
  <span class="keyword">const</span> Point&amp; normal1 = this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>();
  <span class="keyword">const</span> Point&amp; normal2 = this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element">getSurfaceNormal</a>();
  
  <span class="comment">// calculate the vector from node 0 of element 1 to node 0 of elem 2</span>
  <span class="keyword">static</span> Point vec;
  vec.assign(this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>()-&gt;point(0));
  vec -= (this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem">getRadiationGeometricElem</a>()-&gt;point(0));

  <span class="keyword">const</span> <span class="keywordtype">double</span> eps_num = 1.0e-11;
  <span class="keywordflow">if</span> ((vec * normal1 + eps_num) &lt; 0)
    {
    std::cout &lt;&lt; <span class="stringliteral">&quot;(vec * normal1) &gt;= 0.0 violated: &quot;</span> &lt;&lt; (vec * normal1) &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="stringliteral">&quot;normal 1: &quot;</span> &lt;&lt; normal1 &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="stringliteral">&quot;normal 2: &quot;</span> &lt;&lt; normal2 &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="stringliteral">&quot;rad elem 1 FE_ID: &quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to.">FeElementID</a>() &lt;&lt; <span class="stringliteral">&quot;  rad elem 2 FE_ID: &quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to.">FeElementID</a>() &lt;&lt; std::endl;
    }
  
  <span class="keywordflow">if</span> ((vec * normal2 - eps_num) &gt; 0)
    {
    std::cout &lt;&lt; <span class="stringliteral">&quot;(vec * normal2) &lt;= 0.0 violated: &quot;</span> &lt;&lt; (vec * normal2) &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="stringliteral">&quot;normal 1: &quot;</span> &lt;&lt; normal1 &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="stringliteral">&quot;normal 2: &quot;</span> &lt;&lt; normal2 &lt;&lt; std::endl;
    std::cout &lt;&lt; <span class="stringliteral">&quot;rad elem 1 FE_ID: &quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">rad_elem1</a>-&gt;<a class="code" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to.">FeElementID</a>() &lt;&lt; <span class="stringliteral">&quot;  rad elem 2 FE_ID: &quot;</span> &lt;&lt; this-&gt;<a class="code" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">rad_elem2</a>-&gt;<a class="code" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to.">FeElementID</a>() &lt;&lt; std::endl;
    }

  AssertThrow((vec * normal1 + eps_num) &gt;= 0 , ExcInternalError());
  AssertThrow((vec * normal2 - eps_num) &lt;= 0 , ExcInternalError());
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  
  this-&gt;<a class="code" href="class_radiation_element_pair.html#a20623ee787ccc2a182dde05dd60c9cc8" title="boolean to keep track of whether the pair has been initialized">initialized</a> = <span class="keyword">true</span>;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_element_pair_ac2c50e1d3bcc6f8086469389a56bb229_cgraph.gif" border="0" usemap="#class_radiation_element_pair_ac2c50e1d3bcc6f8086469389a56bb229_cgraph" alt=""/></div>
<map name="class_radiation_element_pair_ac2c50e1d3bcc6f8086469389a56bb229_cgraph" id="class_radiation_element_pair_ac2c50e1d3bcc6f8086469389a56bb229_cgraph">
<area shape="rect" id="node3" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to." alt="" coords="285,5,497,33"/><area shape="rect" id="node5" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem" alt="" coords="240,57,541,85"/><area shape="rect" id="node11" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element" alt="" coords="270,109,511,137"/><area shape="rect" id="node7" href="class_radiation_element.html#a6d2ab9caa8a639051ddcff42e2a8967f" title="init this object" alt="" coords="590,83,741,111"/><area shape="rect" id="node9" href="class_radiation_element.html#af283e728f86eea3d9dcdc15e4a513999" title="method to init the local radiation element in its own coordinates" alt="" coords="789,83,1077,111"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a20623ee787ccc2a182dde05dd60c9cc8"></a><!-- doxytag: member="RadiationElementPair::initialized" ref="a20623ee787ccc2a182dde05dd60c9cc8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_radiation_element_pair.html#a20623ee787ccc2a182dde05dd60c9cc8">RadiationElementPair::initialized</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>boolean to keep track of whether the pair has been initialized </p>

<p>Definition at line <a class="el" href="_radiation_element_pair_8h_source.html#l00085">85</a> of file <a class="el" href="_radiation_element_pair_8h_source.html">RadiationElementPair.h</a>.</p>

<p>Referenced by <a class="el" href="_radiation_element_pair_8h_source.html#l00156">clear()</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00265">doubleAreaIntShapeFactor()</a>, and <a class="el" href="_radiation_element_pair_8h_source.html#l00104">reinit()</a>.</p>

</div>
</div>
<a class="anchor" id="af86a4fd911023d29b9f51d2750e21c45"></a><!-- doxytag: member="RadiationElementPair::rad_elem1" ref="af86a4fd911023d29b9f51d2750e21c45" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_radiation_element.html">RadiationElement</a>* <a class="el" href="class_radiation_element_pair.html#af86a4fd911023d29b9f51d2750e21c45">RadiationElementPair::rad_elem1</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_radiation_element_pair_8h_source.html#l00088">88</a> of file <a class="el" href="_radiation_element_pair_8h_source.html">RadiationElementPair.h</a>.</p>

<p>Referenced by <a class="el" href="_radiation_element_pair_8_c_source.html#l00145">analyticShapeFactor()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00156">clear()</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00379">contourIntShapeFactor()</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00265">doubleAreaIntShapeFactor()</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00443">mitalasContourIntShapeFactor()</a>, and <a class="el" href="_radiation_element_pair_8h_source.html#l00104">reinit()</a>.</p>

</div>
</div>
<a class="anchor" id="ad25e0b97314b9a137fd3428299fdf25e"></a><!-- doxytag: member="RadiationElementPair::rad_elem2" ref="ad25e0b97314b9a137fd3428299fdf25e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_radiation_element.html">RadiationElement</a>* <a class="el" href="class_radiation_element_pair.html#ad25e0b97314b9a137fd3428299fdf25e">RadiationElementPair::rad_elem2</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_radiation_element_pair_8h_source.html#l00091">91</a> of file <a class="el" href="_radiation_element_pair_8h_source.html">RadiationElementPair.h</a>.</p>

<p>Referenced by <a class="el" href="_radiation_element_pair_8_c_source.html#l00145">analyticShapeFactor()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00156">clear()</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00379">contourIntShapeFactor()</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00265">doubleAreaIntShapeFactor()</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00443">mitalasContourIntShapeFactor()</a>, and <a class="el" href="_radiation_element_pair_8h_source.html#l00104">reinit()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Radiation/<a class="el" href="_radiation_element_pair_8h_source.html">RadiationElementPair.h</a></li>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Radiation/<a class="el" href="_radiation_element_pair_8_c_source.html">RadiationElementPair.C</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 12 2012 18:06:21 for fesystem by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
