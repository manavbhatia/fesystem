<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>fesystem: RadiationCavityAnalysis Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">fesystem
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">RadiationCavityAnalysis Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="RadiationCavityAnalysis" -->
<p><code>#include &lt;<a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for RadiationCavityAnalysis:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis__coll__graph.gif" border="0" usemap="#_radiation_cavity_analysis_coll__map" alt="Collaboration graph"/></div>
<map name="_radiation_cavity_analysis_coll__map" id="_radiation_cavity_analysis_coll__map">
<area shape="rect" id="node2" href="class_radiation_cavity.html" title="RadiationCavity" alt="" coords="1985,5,2100,33"/><area shape="rect" id="node4" href="class_f_e_system_1_1_f_e_system_controller.html" title="FESystem::FESystemController" alt="" coords="19,313,229,341"/><area shape="rect" id="node8" href="class_discipline_1_1_analysis_discipline_base.html" title="Discipline::AnalysisDisciplineBase" alt="" coords="1509,277,1731,305"/><area shape="rect" id="node12" href="class_solution_1_1_solution_base.html" title="this class provides the base functionality for all solutions" alt="" coords="581,383,736,411"/><area shape="rect" id="node25" href="class_driver_1_1_analysis_driver.html" title="Driver::AnalysisDriver" alt="" coords="1081,511,1231,539"/><area shape="rect" id="node6" href="class_discipline_1_1_thermal_analysis.html" title="Discipline::ThermalAnalysis" alt="" coords="1950,151,2135,179"/><area shape="rect" id="node10" href="class_discipline_1_1_discipline_info.html" title="Discipline::DisciplineInfo" alt="" coords="1073,446,1239,474"/><area shape="rect" id="node15" href="class_mesh_d_s_1_1_f_e_dof_map.html" title="MeshDS::FEDofMap" alt="" coords="1084,161,1228,189"/><area shape="rect" id="node18" href="class_mesh_d_s_1_1_f_e_mesh_data.html" title="MeshDS::FEMeshData" alt="" coords="1077,109,1235,137"/><area shape="rect" id="node20" href="class_mesh_d_s_1_1_f_e_mesh.html" title="MeshDS::FEMesh" alt="" coords="594,178,723,206"/><area shape="rect" id="node23" href="class_f_e_system_utility_1_1_loaded_solution.html" title="this class is a data structure that stores loaded solution from the database" alt="" coords="1048,329,1264,357"/><area shape="rect" id="node28" href="class_solver_1_1_f_e_system_solver_base.html" title="Solver::FESystemSolverBase" alt="" coords="1522,531,1718,559"/><area shape="rect" id="node31" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; NumericVector\&lt; double \&gt; \&gt;" alt="" coords="469,574,848,602"/><area shape="rect" id="node33" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; T \&gt;" alt="" coords="6,574,242,602"/><area shape="rect" id="node36" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters." alt="" coords="558,457,760,485"/><area shape="rect" id="node38" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html" title="FESystemNumerics::PetscSeqVector\&lt; double \&gt;" alt="" coords="1890,610,2195,638"/><area shape="rect" id="node40" href="class_f_e_system_numerics_1_1_petsc_vector_base.html" title="FESystemNumerics::PetscVectorBase\&lt; double \&gt;" alt="" coords="1464,610,1776,638"/><area shape="rect" id="node42" href="class_f_e_system_numerics_1_1_vector_base.html" title="FESystemNumerics::VectorBase\&lt; double \&gt;" alt="" coords="1017,603,1295,631"/><area shape="rect" id="node44" href="class_f_e_system_numerics_1_1_vector_base.html" title="FESystemNumerics::VectorBase\&lt; T \&gt;" alt="" coords="536,641,781,669"/><area shape="rect" id="node46" href="class_f_e_system_numerics_1_1_petsc_vector_base.html" title="FESystemNumerics::PetscVectorBase\&lt; T \&gt;" alt="" coords="1017,655,1295,683"/><area shape="rect" id="node49" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html" title="FESystemNumerics::PetscSeqVector\&lt; T \&gt;" alt="" coords="1484,675,1756,703"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_radiation_cavity_analysis-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationQty</a> { <br/>
&#160;&#160;<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">F_MATRIX</a>, 
<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a01aacfc6d2b8119467903e4413350d70">F_MATRIX_SENSITIVITY</a>, 
<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">A_MATRIX</a>, 
<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ae8bc4b7f41e205e9e6fe14a31a551ef0">A_INVERSE_MATRIX</a>, 
<br/>
&#160;&#160;<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9afc5da26c57bb9e45d36e0b65db2e061b">A_MATRIX_SENSITIVITY</a>, 
<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9abe6a1b3373498e2afa348361975f9ee9">B_MATRIX</a>, 
<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aa8e253c18366682e146778d7d9c6d09e">B_MATRIX_SENSITIVITY</a>, 
<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795">B_INVERSE_MATRIX</a>, 
<br/>
&#160;&#160;<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">G_MATRIX</a>, 
<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ab3e00964c9ce893d80049b2b2daf4967">G_MATRIX_SENSITIVITY</a>, 
<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998">FACTOR_MATRIX</a>, 
<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0">AB_INV_MATRIX</a>
<br/>
 }</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">enum for the matrix names for this analysis  <a href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a0ddae630a11c7aabb1e893846ed2c14c">RadiationCavityAnalysis</a> (<a class="el" href="class_f_e_system_1_1_f_e_system_controller.html">FESystem::FESystemController</a> &amp;fesys_controller, <a class="el" href="class_discipline_1_1_thermal_analysis.html">Discipline::ThermalAnalysis</a> &amp;thermal_anal, <a class="el" href="class_radiation_cavity.html">RadiationCavity</a> &amp;rad_cavity)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor  <a href="#a0ddae630a11c7aabb1e893846ed2c14c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a6d237076ba441b7182a6ba3390a648dd">~RadiationCavityAnalysis</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor  <a href="#a6d237076ba441b7182a6ba3390a648dd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;matrix, const <a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationQty</a> qty_name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a38932efef014877857e9cd643b69bf73">getFENodalDofIDs</a> (std::vector&lt; unsigned int &gt; &amp;vector)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a13405f2f110d5d759287f93310a92efd">getFENodalLoadVector</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;nodal_temp_val, <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;nodal_load_vector)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a61471a6ba45557144aabdef1ddc94562">getFENodalLoadVectorSensitivity</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;nodal_temp_val, <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;nodal_load_vector)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#ae155657b1fa03cee3b09bc02eea7c140">getFEJacobianMatrix</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;nodal_temp_val, <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;jacobian)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a4d8daf804dae432452faf1334b5ee457">calculateEmissivityVector</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; *vector_ptr)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates the vector of emissivities for the current temperature of the cavity  <a href="#a4d8daf804dae432452faf1334b5ee457"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a9b773a18ce7531728bf76b2b6905723b">calculateABInvFactorMatrix</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *matrix_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a84a9916a1b0228f22ffe72f5b035396b">getBaseEpsilonVector</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;vec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a3a2849b2e8421de972e93744f335e757">calculateShapeFactorMatrix</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *matrix_ptr, const bool sensitivity)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a5a8bcd110b1fab5e384846642fc90020">calculateA_Matrix</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *matrix_ptr, const bool sensitivity)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a2225147650551e23cfff7ed0e9dcdc4c">calculateA_InverseMatrix</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *matrix_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a8142f6d6d27312dc289796a6a7188a61">calculateB_Matrix</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *matrix_ptr, const bool sensitivity)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a03d86d48b9c5d0cd54a43f34a16326b6">calculateB_InverseMatrix</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *matrix_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a6d92ac9dce49cfcd2627adc86e09f58c">calculateB_TemperatureDependentJacobianContribution</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;vector, const <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;rad_temp_vector, <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;A_inv_mat, <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;AB_inv_mat)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the matrix <img class="formulaInl" alt="$ \frac{\partial B_{ij}}{\partial T_{rad_k}} \lambda_j $" src="form_1.png"/>  <a href="#a6d92ac9dce49cfcd2627adc86e09f58c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a92c0ccdda2e26fb12ef85ee8013cc314">getTemperatureDependentFluxCorrectionVector</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;correction_vec, <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;AB_inv_mat)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a1b96d789767e44f16f503128ed62a5c9">calculateG_Matrix</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *matrix_ptr, const bool sensitivity)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a2efa1a2121b55ef46dd5d57fca123d7c">calculateFactorMatrix</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *matrix_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#aef377bb5ffe6811cf1c27448ddfc0365">calculateRadElemTempVector</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; *rad_temp_vector_ptr, <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;nodal_temp_vector, const bool reduce_power_by_four, const bool sensitivity)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a3db1f2f4043524354d149fe910fd72df">initializePropertyCardAtElementTemperature</a> (<a class="el" href="class_elem_data_card.html">ElemDataCard</a> &amp;elem_data_card, const unsigned int rad_elem_ID)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">initializes the property card at the specified temperature  <a href="#a3db1f2f4043524354d149fe910fd72df"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a72530913e06cbae197063f3e3f8fa2ca">calculateQty</a> (<a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *matrix, const <a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationQty</a> qty)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a6f756b8d67e57b6d605c102fb3209e97">checkIfTemperatureDependent</a> (<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationQty</a> quantity)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#af707b1f733c9f12a5d791d18c74efc47">clearPropertyCardInitialization</a> (<a class="el" href="class_elem_data_card.html">ElemDataCard</a> &amp;elem_data_card)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">clears the property card initialization  <a href="#af707b1f733c9f12a5d791d18c74efc47"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::auto_ptr<br class="typebreak"/>
&lt; <a class="el" href="class_f_e_system_database_1_1_data_info_base.html">FESystemDatabase::DataInfoBase</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95">getDataInfoForQty</a> (<a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationQty</a> qty)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_f_e_system_1_1_f_e_system_controller.html">FESystem::FESystemController</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55">fesystem_controller</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">fesystem controller for this analysis  <a href="#a548f39e72dfdeea8e77d637931023e55"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_discipline_1_1_thermal_analysis.html">Discipline::ThermalAnalysis</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29">thermal_discipline</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">reference to the thermal analysis discipline that owns this object  <a href="#af3c8a31a3265b0251b89b5e7773c2d29"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_radiation_cavity.html">RadiationCavity</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0">radiation_cavity</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">cavity for this analysis  <a href="#a1f138bfc5a3a6de6219d5893bfb79ec0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#ae71b3b3c642d07649bbacc8073c68b14">n_ABinv_calculations</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">number of times the ABInv matrix has been calculated  <a href="#ae71b3b3c642d07649bbacc8073c68b14"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a><br class="typebreak"/>
&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#aca8fb869507838123c3e8d1e226e38cb">fe_nodal_temp_vector</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">pointer to the FE nodal temperature vector for the analysis  <a href="#aca8fb869507838123c3e8d1e226e38cb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2">performance_logging_header</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">performance logging header  <a href="#aa6dcacf6d9a9f8f15e150f7bb86c88c2"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00057">57</a> of file <a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a>.</p>
</div><hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9"></a><!-- doxytag: member="RadiationCavityAnalysis::RadiationQty" ref="aa6d260d026c174d590d65b920d0cd6e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationCavityAnalysis::RadiationQty</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>enum for the matrix names for this analysis </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607"></a><!-- doxytag: member="F_MATRIX" ref="aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607" args="" -->F_MATRIX</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9a01aacfc6d2b8119467903e4413350d70"></a><!-- doxytag: member="F_MATRIX_SENSITIVITY" ref="aa6d260d026c174d590d65b920d0cd6e9a01aacfc6d2b8119467903e4413350d70" args="" -->F_MATRIX_SENSITIVITY</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415"></a><!-- doxytag: member="A_MATRIX" ref="aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415" args="" -->A_MATRIX</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9ae8bc4b7f41e205e9e6fe14a31a551ef0"></a><!-- doxytag: member="A_INVERSE_MATRIX" ref="aa6d260d026c174d590d65b920d0cd6e9ae8bc4b7f41e205e9e6fe14a31a551ef0" args="" -->A_INVERSE_MATRIX</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9afc5da26c57bb9e45d36e0b65db2e061b"></a><!-- doxytag: member="A_MATRIX_SENSITIVITY" ref="aa6d260d026c174d590d65b920d0cd6e9afc5da26c57bb9e45d36e0b65db2e061b" args="" -->A_MATRIX_SENSITIVITY</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9abe6a1b3373498e2afa348361975f9ee9"></a><!-- doxytag: member="B_MATRIX" ref="aa6d260d026c174d590d65b920d0cd6e9abe6a1b3373498e2afa348361975f9ee9" args="" -->B_MATRIX</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9aa8e253c18366682e146778d7d9c6d09e"></a><!-- doxytag: member="B_MATRIX_SENSITIVITY" ref="aa6d260d026c174d590d65b920d0cd6e9aa8e253c18366682e146778d7d9c6d09e" args="" -->B_MATRIX_SENSITIVITY</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795"></a><!-- doxytag: member="B_INVERSE_MATRIX" ref="aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795" args="" -->B_INVERSE_MATRIX</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939"></a><!-- doxytag: member="G_MATRIX" ref="aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939" args="" -->G_MATRIX</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9ab3e00964c9ce893d80049b2b2daf4967"></a><!-- doxytag: member="G_MATRIX_SENSITIVITY" ref="aa6d260d026c174d590d65b920d0cd6e9ab3e00964c9ce893d80049b2b2daf4967" args="" -->G_MATRIX_SENSITIVITY</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998"></a><!-- doxytag: member="FACTOR_MATRIX" ref="aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998" args="" -->FACTOR_MATRIX</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0"></a><!-- doxytag: member="AB_INV_MATRIX" ref="aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0" args="" -->AB_INV_MATRIX</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00061">61</a> of file <a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a>.</p>
<div class="fragment"><pre class="fragment">    {
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">F_MATRIX</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a01aacfc6d2b8119467903e4413350d70">F_MATRIX_SENSITIVITY</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">A_MATRIX</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ae8bc4b7f41e205e9e6fe14a31a551ef0">A_INVERSE_MATRIX</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9afc5da26c57bb9e45d36e0b65db2e061b">A_MATRIX_SENSITIVITY</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9abe6a1b3373498e2afa348361975f9ee9">B_MATRIX</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aa8e253c18366682e146778d7d9c6d09e">B_MATRIX_SENSITIVITY</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795">B_INVERSE_MATRIX</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">G_MATRIX</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ab3e00964c9ce893d80049b2b2daf4967">G_MATRIX_SENSITIVITY</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998">FACTOR_MATRIX</a>,
      <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0">AB_INV_MATRIX</a>
    };
</pre></div>
</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a0ddae630a11c7aabb1e893846ed2c14c"></a><!-- doxytag: member="RadiationCavityAnalysis::RadiationCavityAnalysis" ref="a0ddae630a11c7aabb1e893846ed2c14c" args="(FESystem::FESystemController &amp;fesys_controller, Discipline::ThermalAnalysis &amp;thermal_anal, RadiationCavity &amp;rad_cavity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_radiation_cavity_analysis.html#a0ddae630a11c7aabb1e893846ed2c14c">RadiationCavityAnalysis::RadiationCavityAnalysis</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_1_1_f_e_system_controller.html">FESystem::FESystemController</a> &amp;&#160;</td>
          <td class="paramname"><em>fesys_controller</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_discipline_1_1_thermal_analysis.html">Discipline::ThermalAnalysis</a> &amp;&#160;</td>
          <td class="paramname"><em>thermal_anal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_radiation_cavity.html">RadiationCavity</a> &amp;&#160;</td>
          <td class="paramname"><em>rad_cavity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>constructor </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00045">45</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_f_e_system_controller_8h_source.html#l00154">FESystem::FESystemController::design_database</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00233">fesystem_controller</a>, <a class="el" href="_radiation_cavity_8h_source.html#l00228">RadiationCavity::getFiniteElementMeshID()</a>, <a class="el" href="_design_parameter_8h_source.html#l00109">DesignData::DesignParameter::getID()</a>, <a class="el" href="_shape_parameter_8h_source.html#l00086">DesignData::ShapeParameter::getPerturbedMeshID()</a>, <a class="el" href="_f_e_system_controller_8h_source.html#l00136">FESystem::FESystemController::mesh_list</a>, <a class="el" href="_f_e_system_controller_8h_source.html#l00172">FESystem::FESystemController::performance_logging</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00248">performance_logging_header</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00239">radiation_cavity</a>, and <a class="el" href="_radiation_cavity_8h_source.html#l00289">RadiationCavity::setMeshData()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                             :
<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>(fesys_controller),
<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>(thermal_anal),
<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>(rad_cavity),
<a class="code" href="class_radiation_cavity_analysis.html#ae71b3b3c642d07649bbacc8073c68b14" title="number of times the ABInv matrix has been calculated">n_ABinv_calculations</a>(0),
<a class="code" href="class_radiation_cavity_analysis.html#aca8fb869507838123c3e8d1e226e38cb" title="pointer to the FE nodal temperature vector for the analysis">fe_nodal_temp_vector</a>(NULL),
<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>(<span class="stringliteral">&quot;RadiationCavityAnalysis&quot;</span>)
{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::RadiationCavityAnalysis()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <span class="comment">// set the mesh data for the radiation cavity and tell it to initialize its data </span>
  <span class="comment">// structures</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mesh_ID = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ad45cf72eecc60e080c8b9b98dbfd1955">getFiniteElementMeshID</a>();
  
  <a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html">MeshDS::FEMeshData</a>* mesh_data = 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a2d2bb90b45aa11cc32c79c27d2b9f6ab" title="data structure to store the mesh used for FE analysis">mesh_list</a>-&gt;getMeshDataFromID(mesh_ID);
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ac11874b9a7a8544a8ad3d2154f3eea33">setMeshData</a>(mesh_data);
  
  <span class="comment">// now, iterate over all the dsign variables, and set the mesh data for each</span>
  std::auto_ptr&lt;std::vector&lt;DesignData::DesignParameter*&gt; &gt; dv_vector =
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a3531570abaab0e6a4c4b04c05d0ffbf8" title="stores design data">design_database</a>-&gt;getParameters();
  
  std::vector&lt;DesignData::DesignParameter*&gt;::const_iterator dv_it, dv_end;
  dv_it = dv_vector-&gt;begin();
  dv_end = dv_vector-&gt;end();
  
  
  <span class="keywordflow">for</span> (; dv_it != dv_end; dv_it++)
    {
      <span class="keywordflow">if</span> ((*dv_it)-&gt;getParameterTypeEnumID() == DesignData::SHAPE_PARAMETER::num())
        {
          <a class="code" href="class_design_data_1_1_shape_parameter.html">DesignData::ShapeParameter</a>* shape_dv = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_design_data_1_1_shape_parameter.html">DesignData::ShapeParameter</a>*<span class="keyword">&gt;</span>(*dv_it);
          mesh_ID = shape_dv-&gt;<a class="code" href="class_design_data_1_1_shape_parameter.html#a473b21f5c0bd1de4d19a13cc534cf32c">getPerturbedMeshID</a>(Discipline::THERMAL_DISCIPLINE::num());
          mesh_data = 
          this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a2d2bb90b45aa11cc32c79c27d2b9f6ab" title="data structure to store the mesh used for FE analysis">mesh_list</a>-&gt;getMeshDataFromID(mesh_ID);
          
          this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ac11874b9a7a8544a8ad3d2154f3eea33">setMeshData</a>(mesh_data, shape_dv-&gt;<a class="code" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7">getID</a>());
        }
    }
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::RadiationCavityAnalysis()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a0ddae630a11c7aabb1e893846ed2c14c_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a0ddae630a11c7aabb1e893846ed2c14c_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a0ddae630a11c7aabb1e893846ed2c14c_cgraph" id="class_radiation_cavity_analysis_a0ddae630a11c7aabb1e893846ed2c14c_cgraph">
<area shape="rect" id="node3" href="class_radiation_cavity.html#ad45cf72eecc60e080c8b9b98dbfd1955" title="RadiationCavity::getFiniteElementMeshID" alt="" coords="399,5,667,33"/><area shape="rect" id="node5" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7" title="DesignData::DesignParameter::getID" alt="" coords="413,57,654,85"/><area shape="rect" id="node7" href="class_design_data_1_1_shape_parameter.html#a473b21f5c0bd1de4d19a13cc534cf32c" title="DesignData::ShapeParameter::getPerturbedMeshID" alt="" coords="369,109,698,137"/><area shape="rect" id="node9" href="class_radiation_cavity.html#ac11874b9a7a8544a8ad3d2154f3eea33" title="RadiationCavity::setMeshData" alt="" coords="433,161,634,189"/><area shape="rect" id="node11" href="class_radiation_cavity.html#a3e245d62e67baef51c4c81354789f143" title="RadiationCavity::createFENodeVectorAndRadiationElems" alt="" coords="747,161,1110,189"/><area shape="rect" id="node13" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330" title="MeshDS::FEMeshData::getElemFromForeignID" alt="" coords="1159,57,1462,85"/><area shape="rect" id="node15" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad50959fe4436d50b9ea69015d4b9690a" title="MeshDS::FEMeshData::getForeignIDFromNode" alt="" coords="1158,109,1463,137"/><area shape="rect" id="node17" href="class_radiation_cavity.html#a4c47512a0221ec3bd6cc5bf93d38d17d" title="RadiationCavity::getMeshData" alt="" coords="1210,161,1411,189"/><area shape="rect" id="node19" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ac79f230a1aeedc5ef7dfaf13468220ec" title="MeshDS::FEMeshData::getNodeFromForeignID" alt="" coords="1158,213,1463,241"/><area shape="rect" id="node21" href="class_radiation_element.html#a41ff2dd961e09e094fc7fd40f732b939" title="RadiationElement::setData" alt="" coords="1221,265,1401,293"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6d237076ba441b7182a6ba3390a648dd"></a><!-- doxytag: member="RadiationCavityAnalysis::~RadiationCavityAnalysis" ref="a6d237076ba441b7182a6ba3390a648dd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_radiation_cavity_analysis.html#a6d237076ba441b7182a6ba3390a648dd">RadiationCavityAnalysis::~RadiationCavityAnalysis</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>destructor </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00101">101</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a2225147650551e23cfff7ed0e9dcdc4c"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateA_InverseMatrix" ref="a2225147650551e23cfff7ed0e9dcdc4c" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; *matrix_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a2225147650551e23cfff7ed0e9dcdc4c">RadiationCavityAnalysis::calculateA_InverseMatrix</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix_ptr</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates inverse of A matrix </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix_ptr</td><td>pointer to matrix where the calculated matrix is stored </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00661">661</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00065">A_MATRIX</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00187">FESystemNumerics::PetscVectorBase&lt; T &gt;::el()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01103">FESystemNumerics::PetscMatrixBase&lt; T &gt;::finalAssemble()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01069">FESystemNumerics::PetscMatrixBase&lt; T &gt;::getMat()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00534">FESystemNumerics::PetscVectorBase&lt; T &gt;::getVec()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">FESystemNumerics::PetscMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">FESystemNumerics::PetscMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00114">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00425">FESystemNumerics::PetscMatrixBase&lt; T &gt;::set()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">FESystemNumerics::PetscMatrixBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">calculateQty()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateA_InverseMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <span class="comment">//  std::cout&lt;&lt; &quot;asked for A_inv&quot; &lt;&lt; std::endl;</span>
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>&amp; A_inverse_matrix = *matrix_ptr;
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  <span class="keywordflow">if</span> (A_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() != n_elems || A_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>() != n_elems)
    A_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions">resize</a>(n_elems, n_elems);
  A_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c">zero</a>();
  
  <span class="comment">// get the A_matrix </span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> A_matrix(n_elems, n_elems); 
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> tmp_vector(n_elems), sol_vector(n_elems);
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(A_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">RadiationCavityAnalysis::A_MATRIX</a>);
  A_matrix.finalAssemble();
  tmp_vector.zero();
  
  <span class="comment">// create a petsc mat and set its values to the B matrix.</span>
  Mat matrix = A_matrix.getMat();
  
  <span class="comment">// create a PC context and create the LU factorization</span>
  PC petsc_pc;
  
  PCCreate(PETSC_COMM_SELF, &amp;petsc_pc);
  PCSetType(petsc_pc , PCLU);
  PCFactorSetUseInPlace(petsc_pc);
  PCSetOperators(petsc_pc, matrix, matrix, SAME_NONZERO_PATTERN);
  PCSetUp(petsc_pc);
  
  Mat lu_mat;
        MatStructure str;
  PCGetOperators(petsc_pc, PETSC_NULL, &amp;lu_mat, &amp;str);
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_elems; i++)
    {
      tmp_vector.set(i,1.0);
      tmp_vector.assemble();
      sol_vector.zero();
      MatSolve(lu_mat, tmp_vector.getVec(), sol_vector.getVec());
      tmp_vector.set(i,0.0);
      
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_elems; j++)
        A_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38">set</a>(j,i,sol_vector.el(j));
    }
  
  PCDestroy(petsc_pc);
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateA_InverseMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a2225147650551e23cfff7ed0e9dcdc4c_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a2225147650551e23cfff7ed0e9dcdc4c_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a2225147650551e23cfff7ed0e9dcdc4c_cgraph" id="class_radiation_cavity_analysis_a2225147650551e23cfff7ed0e9dcdc4c_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e" title="FESystemNumerics::PetscVectorBase::el" alt="" coords="412,5,678,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix" alt="" coords="377,57,714,85"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="398,109,693,137"/><area shape="rect" id="node9" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="397,161,693,189"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="413,213,678,241"/><area shape="rect" id="node13" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="415,265,676,293"/><area shape="rect" id="node15" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions" alt="" coords="385,317,706,345"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38" title="FESystemNumerics::PetscMatrixBase::set" alt="" coords="409,369,681,397"/><area shape="rect" id="node19" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="405,421,686,449"/><area shape="rect" id="node21" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="405,473,685,501"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5a8bcd110b1fab5e384846642fc90020"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateA_Matrix" ref="a5a8bcd110b1fab5e384846642fc90020" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; *matrix_ptr, const bool sensitivity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a5a8bcd110b1fab5e384846642fc90020">RadiationCavityAnalysis::calculateA_Matrix</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>sensitivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates the A matrix </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix_ptr</td><td>pointer to matrix where the calculated matrix is stored </td></tr>
    <tr><td class="paramname">DV</td><td>pointer to the design variable for sensitivity. (should NULL if no sensitivity is needed) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">415</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_petsc_matrix_base_8h_source.html#l00897">FESystemNumerics::PetscMatrixBase&lt; T &gt;::add()</a>, <a class="el" href="_f_e_system_controller_8h_source.html#l00163">FESystem::FESystemController::analysis_case</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00063">F_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00064">F_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00233">fesystem_controller</a>, <a class="el" href="_analysis_discipline_base_8h_source.html#l00505">Discipline::AnalysisDisciplineBase::getAnalysisDriver()</a>, <a class="el" href="_analysis_driver_8h_source.html#l00647">Driver::AnalysisDriver::getCurrentDesignParameter()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00111">getMatrixQuantity()</a>, <a class="el" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">DesignData::DesignParameter::getParameterTypeEnumID()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">FESystemNumerics::PetscMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">FESystemNumerics::PetscMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="_radiation_cavity_8h_source.html#l00364">RadiationCavity::nRadiationElems()</a>, <a class="el" href="_f_e_system_controller_8h_source.html#l00172">FESystem::FESystemController::performance_logging</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00248">performance_logging_header</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00239">radiation_cavity</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00114">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01043">FESystemNumerics::PetscMatrixBase&lt; T &gt;::scale()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00399">FESystemNumerics::PetscMatrixBase&lt; T &gt;::shift()</a>, <a class="el" href="_arpack_eigen_solver_8h_source.html#l00408">sigma</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00236">thermal_discipline</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">FESystemNumerics::PetscMatrixBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">calculateQty()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateA_Matrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <span class="comment">// get a pointer to the matrices</span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>&amp; matrix = *matrix_ptr;
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  <span class="keywordflow">if</span> (matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() != n_elems || matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>() != n_elems)
    matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions">resize</a>(n_elems, n_elems);
  matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c">zero</a>();
  
  <span class="comment">// for shape design variable, the shape factor matrix will be calculated for </span>
  <span class="comment">// the perturbed mesh. The base shape factor matrix, is then retrived and the </span>
  <span class="comment">// sensitivity is then calculated</span>
  <span class="keywordflow">if</span> (sensitivity)
    {
      <span class="comment">// for a Property DV, the sensitivity of this quantity is zero</span>
      <span class="keyword">const</span> <a class="code" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters.">DesignData::DesignParameter</a>&amp; dparam = 
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>();
      <span class="keywordflow">if</span> (dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">getParameterTypeEnumID</a>() == DesignData::PROPERTY_PARAMETER::num())
        <span class="keywordflow">return</span>;
    }
  
  
  <span class="comment">// in case the DV is NULL, the F_matrix will contain the actual shape factor matrix, </span>
  <span class="comment">// otherwise, it will contain the sensitivity of the shape factor matrix</span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> F_matrix(n_elems, n_elems); 
  <span class="keywordflow">if</span> (sensitivity)
    this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(F_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a01aacfc6d2b8119467903e4413350d70">RadiationCavityAnalysis::F_MATRIX_SENSITIVITY</a>);
  <span class="keywordflow">else</span>
    this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(F_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">RadiationCavityAnalysis::F_MATRIX</a>);
  
  <span class="comment">// get the value of sigma</span>
  <span class="keywordtype">double</span> <a class="code" href="_arpack_eigen_solver_8h.html#ac687728cb5722b5730ca1b1197128920">sigma</a> = 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#ae2f9f30b83db8a3cb69787c283708210" title="stores analysis details">analysis_case</a>-&gt;getRealParameter(<span class="stringliteral">&quot;S_B_CONSTANT&quot;</span>);
  
  <span class="comment">// calculate [A] = sigma * ([I] - [F]) or its sensitivity</span>
  matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa">add</a>(-1.0, F_matrix, <span class="keyword">true</span>);
  
  <span class="keywordflow">if</span> (!sensitivity)
    matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a61d3ca9a3e1f750e2b28f1dd503990d7" title="adds val to all diagonal elements of the matrix">shift</a>(1.0);
  
  <span class="comment">// finally, scale the parameter with sigma</span>
  matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b">scale</a>(sigma);
  
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateA_Matrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a5a8bcd110b1fab5e384846642fc90020_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a5a8bcd110b1fab5e384846642fc90020_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a5a8bcd110b1fab5e384846642fc90020_cgraph" id="class_radiation_cavity_analysis_a5a8bcd110b1fab5e384846642fc90020_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa" title="FESystemNumerics::PetscMatrixBase::add" alt="" coords="1631,1253,1907,1281"/><area shape="rect" id="node9" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80" title="Discipline::AnalysisDisciplineBase::getAnalysisDriver" alt="" coords="1602,369,1936,397"/><area shape="rect" id="node11" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable" alt="" coords="1608,421,1931,449"/><area shape="rect" id="node13" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389" title="RadiationCavityAnalysis::getMatrixQuantity" alt="" coords="333,561,609,589"/><area shape="rect" id="node43" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="1637,1409,1902,1437"/><area shape="rect" id="node45" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="1639,1461,1900,1489"/><area shape="rect" id="node47" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions" alt="" coords="1609,1357,1930,1385"/><area shape="rect" id="node49" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="1629,941,1909,969"/><area shape="rect" id="node51" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702" title="DesignData::DesignParameter::getParameterTypeEnumID" alt="" coords="1586,889,1953,917"/><area shape="rect" id="node69" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b" title="FESystemNumerics::PetscMatrixBase::scale" alt="" coords="1627,1305,1912,1333"/><area shape="rect" id="node90" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity" alt="" coords="1658,785,1881,813"/><area shape="rect" id="node148" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a61d3ca9a3e1f750e2b28f1dd503990d7" title="adds val to all diagonal elements of the matrix" alt="" coords="331,1409,610,1437"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91" title="FESystemNumerics::MatrixBase::getMatrixPackage" alt="" coords="2008,1253,2336,1281"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="2025,1565,2319,1593"/><area shape="rect" id="node15" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95" title="RadiationCavityAnalysis::getDataInfoForQty" alt="" coords="1221,265,1502,293"/><area shape="rect" id="node35" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature" alt="" coords="659,483,1143,511"/><area shape="rect" id="node37" href="class_radiation_cavity_analysis.html#a6f756b8d67e57b6d605c102fb3209e97" title="RadiationCavityAnalysis::checkIfTemperatureDependent" alt="" coords="724,535,1078,563"/><area shape="rect" id="node39" href="class_radiation_cavity_analysis.html#a72530913e06cbae197063f3e3f8fa2ca" title="RadiationCavityAnalysis::calculateQty" alt="" coords="779,1075,1024,1103"/><area shape="rect" id="node17" href="class_radiation_cavity.html#aa7fc38a25e02d4d38d20c16720124ef4" title="returns the cavity ID" alt="" coords="1674,5,1865,33"/><area shape="rect" id="node21" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7" title="DesignData::DesignParameter::getID" alt="" coords="1649,837,1890,865"/><area shape="rect" id="node23" href="class_discipline_1_1_analysis_discipline_base.html#aaa6666781d3c78e003c9f8002aaeff16" title="Discipline::AnalysisDisciplineBase::getSolution" alt="" coords="1621,57,1918,85"/><area shape="rect" id="node25" href="class_solution_1_1_solution_base.html#a73528968dadb7365a70b0503032ef7c6" title="Solution::SolutionBase::getDisciplineTransientNatureEnumID" alt="" coords="1578,109,1960,137"/><area shape="rect" id="node27" href="class_driver_1_1_analysis_driver.html#ad9f4c9e39727b9b9ba9fcbe7353e9c7f" title="returns the current load case number" alt="" coords="1629,161,1910,189"/><area shape="rect" id="node29" href="class_driver_1_1_transient_analysis_driver.html#ab9622f4ee33604c4d864d63f8cc93ef6" title="Driver::TransientAnalysisDriver::getCurrentIterationNumber" alt="" coords="1584,213,1955,241"/><area shape="rect" id="node31" href="class_driver_1_1_transient_analysis_driver.html#aeb9ad9e6f71bacc09f168141428af9d5" title="Driver::TransientAnalysisDriver::getCurrentAnalysisTime" alt="" coords="1592,265,1946,293"/><area shape="rect" id="node33" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity" alt="" coords="1602,317,1937,345"/><area shape="rect" id="node41" href="class_radiation_cavity_analysis.html#a3a2849b2e8421de972e93744f335e757" title="RadiationCavityAnalysis::calculateShapeFactorMatrix" alt="" coords="1193,1101,1530,1129"/><area shape="rect" id="node72" href="class_radiation_cavity_analysis.html#a2225147650551e23cfff7ed0e9dcdc4c" title="RadiationCavityAnalysis::calculateA_InverseMatrix" alt="" coords="1201,1565,1522,1593"/><area shape="rect" id="node88" href="class_radiation_cavity_analysis.html#a8142f6d6d27312dc289796a6a7188a61" title="RadiationCavityAnalysis::calculateB_Matrix" alt="" coords="1223,793,1500,821"/><area shape="rect" id="node112" href="class_radiation_cavity_analysis.html#a03d86d48b9c5d0cd54a43f34a16326b6" title="RadiationCavityAnalysis::calculateB_InverseMatrix" alt="" coords="1201,1513,1522,1541"/><area shape="rect" id="node124" href="class_radiation_cavity_analysis.html#a1b96d789767e44f16f503128ed62a5c9" title="RadiationCavityAnalysis::calculateG_Matrix" alt="" coords="1222,1153,1501,1181"/><area shape="rect" id="node135" href="class_radiation_cavity_analysis.html#a2efa1a2121b55ef46dd5d57fca123d7c" title="RadiationCavityAnalysis::calculateFactorMatrix" alt="" coords="1212,1021,1511,1049"/><area shape="rect" id="node138" href="class_radiation_cavity_analysis.html#a9b773a18ce7531728bf76b2b6905723b" title="RadiationCavityAnalysis::calculateABInvFactorMatrix" alt="" coords="1194,741,1528,769"/><area shape="rect" id="node54" href="class_design_data_1_1_design_parameter.html#a0eb8202d84916cb7562fa2429e3bf7f8" title="DesignData::DesignParameter::getPerturbationStepSize" alt="" coords="1592,1201,1946,1229"/><area shape="rect" id="node56" href="class_radiation_element.html#a447d88c256c0428c9d7750f9d6a2efb2" title="ID of the elem." alt="" coords="1696,1097,1843,1125"/><area shape="rect" id="node58" href="class_radiation_element_pair.html#ac2c50e1d3bcc6f8086469389a56bb229" title="initializes the pair with two elements" alt="" coords="1676,993,1863,1021"/><area shape="rect" id="node62" href="class_radiation_element_pair.html#a82194ce5777e2ca4e4824bcf64a62496" title="RadiationElementPair::getShapeFactor" alt="" coords="1643,1149,1896,1177"/><area shape="rect" id="node64" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38" title="FESystemNumerics::PetscMatrixBase::set" alt="" coords="1633,1513,1905,1541"/><area shape="rect" id="node66" href="class_radiation_element_pair.html#ae297673eb5565ceba91e952b2db04dec" title="clears the initialization" alt="" coords="1676,1045,1863,1073"/><area shape="rect" id="node60" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to." alt="" coords="2066,733,2278,761"/><area shape="rect" id="node74" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e" title="FESystemNumerics::PetscVectorBase::el" alt="" coords="1636,1773,1902,1801"/><area shape="rect" id="node76" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix" alt="" coords="1601,1617,1938,1645"/><area shape="rect" id="node79" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="1621,1669,1917,1697"/><area shape="rect" id="node85" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="1629,1721,1910,1749"/><area shape="rect" id="node101" href="class_radiation_cavity.html#a4c47512a0221ec3bd6cc5bf93d38d17d" title="RadiationCavity::getMeshData" alt="" coords="1669,525,1870,553"/><area shape="rect" id="node103" href="class_radiation_cavity.html#aa2186ca4c287a20ae923e6b5a5619801" title="RadiationCavity::getElemFromID" alt="" coords="1662,577,1877,605"/><area shape="rect" id="node106" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330" title="MeshDS::FEMeshData::getElemFromForeignID" alt="" coords="1618,629,1921,657"/><area shape="rect" id="node108" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ae50bb83a080c0f9d30cb6a7b9458af54" title="MeshDS::FEMeshData::getElemPropertyID" alt="" coords="1630,681,1908,709"/><area shape="rect" id="node110" href="class_property_1_1_property_database.html#a4120ff84d49bd7d1b547507759f2d27f" title="returns the element property card for this ID" alt="" coords="1597,733,1942,761"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9b773a18ce7531728bf76b2b6905723b"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateABInvFactorMatrix" ref="a9b773a18ce7531728bf76b2b6905723b" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; *matrix_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a9b773a18ce7531728bf76b2b6905723b">RadiationCavityAnalysis::calculateABInvFactorMatrix</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix_ptr</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates the matrix product <img class="formulaInl" alt="$ [A][B]^{-1} $" src="form_0.png"/>, and approximates it based on the settings provided by the user about whether to approximate or to always recalculate the factor matrix </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00838">838</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00065">A_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00070">B_INVERSE_MATRIX</a>, <a class="el" href="_data_info_8_c_source.html#l00043">FESystemDatabase::GenericDataInfoBase::clear()</a>, <a class="el" href="_data_info_8_c_source.html#l00169">FESystemDatabase::GenericDataInfoBase::setDisciplineEnumID()</a>, <a class="el" href="_data_info_8_c_source.html#l00087">FESystemDatabase::GenericDataInfoBase::setLoadCase()</a>, <a class="el" href="_data_info_8_c_source.html#l00136">FESystemDatabase::GenericDataInfoBase::setName()</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">FESystemNumerics::PetscMatrixBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">calculateQty()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateABInvFactorMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <span class="comment">// this is now being limited only to cases with temperature &quot;dependent&quot; </span>
  <span class="comment">// material properties</span>
  Assert(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>(),
         ExcInternalError());
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>&amp; factor_matrix = *matrix_ptr;
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  factor_matrix.zero();
  
  <span class="keywordtype">bool</span> recalculate = <span class="keyword">true</span>;
  <span class="keywordtype">bool</span> store_base = <span class="keyword">false</span>;
  
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    {
      recalculate = <span class="keyword">true</span>;
      store_base = <span class="keyword">false</span>;
    }
  <span class="keywordflow">else</span>
    {
      <span class="keywordflow">if</span>(!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ac5080de08bcb7b1c43830650b87c061c" title="boolean about whether to approximate or recalculate ABInv factor">ifApproximateABInvFactor</a>())
        {
          recalculate = <span class="keyword">true</span>;
          store_base = <span class="keyword">false</span>;
        }
      <span class="keywordflow">else</span>
        {
          <span class="keywordflow">if</span> (fmod(1.0*this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#ae71b3b3c642d07649bbacc8073c68b14" title="number of times the ABInv matrix has been calculated">n_ABinv_calculations</a>, 
                   1.0*this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a7de239a0f968235b9cd5429b13a2cd52">getNItertionsToRecalculateABInv</a>()) == 0.0)
            {
              recalculate = <span class="keyword">true</span>;
              store_base = <span class="keyword">true</span>;
            }
          <span class="keywordflow">else</span> 
            {
              
              recalculate = <span class="keyword">false</span>;
              store_base = <span class="keyword">false</span>;
            }
        }
    }
  
  <span class="comment">//  std::cout &lt;&lt; &quot;if approx  &quot; &lt;&lt; this-&gt;radiation_cavity.ifApproximateABInvFactor() &lt;&lt; std::endl;</span>
  <span class="comment">//  std::cout &lt;&lt; &quot;n_AB_inv,n_iter_to_recalc = &quot; &lt;&lt; this-&gt;n_ABinv_calculations &lt;&lt; &quot; &quot; </span>
  <span class="comment">//    &lt;&lt; this-&gt;radiation_cavity.getNItertionsToRecalculateABInv() &lt;&lt; std::endl;</span>
  <span class="comment">//  std::cout &lt;&lt; &quot;fmod =&quot; &lt;&lt; fmod(1.0*this-&gt;n_ABinv_calculations, </span>
  <span class="comment">//                    1.0*this-&gt;radiation_cavity.getNItertionsToRecalculateABInv()) &lt;&lt; std::endl;</span>
  
  <span class="keywordflow">if</span> (recalculate)
    {
      <span class="comment">// simply calculate</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(factor_matrix, 
                              <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795">RadiationCavityAnalysis::B_INVERSE_MATRIX</a>);
      <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> matrix1(n_elems, n_elems);
      
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(matrix1, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">RadiationCavityAnalysis::A_MATRIX</a>);
      
      factor_matrix.leftMultiply(matrix1);
      
      std::cout&lt;&lt; <span class="stringliteral">&quot;recalculating AB_inv&quot;</span> &lt;&lt; std::endl;
      
      <span class="keywordflow">if</span> (store_base)
        {
          std::string name;
          std::ostringstream cavity_id;
          cavity_id &lt;&lt; this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#aa7fc38a25e02d4d38d20c16720124ef4" title="returns the cavity ID">getCavityID</a>();
          
          name.clear(); 
          name = <span class="stringliteral">&quot;BaseEpsilonVector&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += cavity_id.str();
          
          <span class="comment">// calculate the epsilon vector and store it</span>
          <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> vec1(n_elems);
          this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a4d8daf804dae432452faf1334b5ee457" title="calculates the vector of emissivities for the current temperature of the cavity">calculateEmissivityVector</a>(&amp;vec1);
          <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a> time_independent_data_info;
          time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID">setDisciplineEnumID</a>(Discipline::RADIATION_DISCIPLINE::num());
          time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent">setLoadCase</a>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().
                                                 getCurrentLoadCase());
          time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity">setName</a>(name);
          
          this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a61c6211b1a2e6518ac9e357e385fad2b" title="stores global matrices and vectors">global_data_storage</a>-&gt;storeVector(time_independent_data_info,
                                                                     vec1);
          
          <span class="comment">// create a name for storing the matrix</span>
          std::ostringstream num;
          name.clear();
          name = <span class="stringliteral">&quot;BaseABInvMatrix&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += cavity_id.str();
          
          time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#ab5cbefc863791bda1b4962a22598e9e0" title="clears the data structures of this object">clear</a>();
          time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID">setDisciplineEnumID</a>(Discipline::RADIATION_DISCIPLINE::num());
          time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent">setLoadCase</a>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().
                                                 getCurrentLoadCase());
          time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity">setName</a>(name);
          
          this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a61c6211b1a2e6518ac9e357e385fad2b" title="stores global matrices and vectors">global_data_storage</a>-&gt;storeMatrix(time_independent_data_info, 
                                                                     factor_matrix);
        }
    }
  <span class="keywordflow">else</span>
    {
      std::cout&lt;&lt; <span class="stringliteral">&quot;returning base AB_inv&quot;</span> &lt;&lt; std::endl;
      
      <span class="comment">// create a name for storing the matrix</span>
      std::string name;
      std::ostringstream cavity_id;
      cavity_id &lt;&lt; this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#aa7fc38a25e02d4d38d20c16720124ef4" title="returns the cavity ID">getCavityID</a>();
      std::ostringstream num;
      name.clear();
      name = <span class="stringliteral">&quot;BaseABInvMatrix&quot;</span>;
      name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
      name += cavity_id.str();
      
      <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a> time_independent_data_info;
      time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#ab5cbefc863791bda1b4962a22598e9e0" title="clears the data structures of this object">clear</a>();
      time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID">setDisciplineEnumID</a>(Discipline::RADIATION_DISCIPLINE::num());
      time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent">setLoadCase</a>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().
                                             getCurrentLoadCase());
      time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity">setName</a>(name);
      
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a61c6211b1a2e6518ac9e357e385fad2b" title="stores global matrices and vectors">global_data_storage</a>-&gt;fillMatrix(time_independent_data_info, 
                                                                factor_matrix);
    }

  <span class="comment">// now increment the counter</span>
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#ae71b3b3c642d07649bbacc8073c68b14" title="number of times the ABInv matrix has been calculated">n_ABinv_calculations</a>++;
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateABInvFactorMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a9b773a18ce7531728bf76b2b6905723b_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a9b773a18ce7531728bf76b2b6905723b_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a9b773a18ce7531728bf76b2b6905723b_cgraph" id="class_radiation_cavity_analysis_a9b773a18ce7531728bf76b2b6905723b_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_database_1_1_generic_data_info_base.html#ab5cbefc863791bda1b4962a22598e9e0" title="clears the data structures of this object" alt="" coords="436,5,748,33"/><area shape="rect" id="node5" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID" alt="" coords="389,57,795,85"/><area shape="rect" id="node7" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent" alt="" coords="412,109,772,137"/><area shape="rect" id="node9" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity" alt="" coords="424,161,760,189"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="452,213,732,241"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a03d86d48b9c5d0cd54a43f34a16326b6"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateB_InverseMatrix" ref="a03d86d48b9c5d0cd54a43f34a16326b6" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; *matrix_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a03d86d48b9c5d0cd54a43f34a16326b6">RadiationCavityAnalysis::calculateB_InverseMatrix</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix_ptr</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates inverse of B matrix </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix_ptr</td><td>pointer to matrix where the calculated matrix is stored </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00721">721</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00068">B_MATRIX</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00187">FESystemNumerics::PetscVectorBase&lt; T &gt;::el()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01103">FESystemNumerics::PetscMatrixBase&lt; T &gt;::finalAssemble()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01069">FESystemNumerics::PetscMatrixBase&lt; T &gt;::getMat()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00534">FESystemNumerics::PetscVectorBase&lt; T &gt;::getVec()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">FESystemNumerics::PetscMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">FESystemNumerics::PetscMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00114">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00425">FESystemNumerics::PetscMatrixBase&lt; T &gt;::set()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">FESystemNumerics::PetscMatrixBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">calculateQty()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateB_InverseMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <span class="comment">//  std::cout&lt;&lt; &quot;asked for B_inv&quot; &lt;&lt; std::endl;</span>
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>&amp; B_inverse_matrix = *matrix_ptr;
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  <span class="keywordflow">if</span> (B_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() != n_elems || B_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>() != n_elems)
    B_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions">resize</a>(n_elems, n_elems);
  B_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c">zero</a>();
  
  <span class="comment">// get the B_matrix and the B_inverse matrices.</span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> B_matrix(n_elems, n_elems); 
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> tmp_vector(n_elems), sol_vector(n_elems);
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(B_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9abe6a1b3373498e2afa348361975f9ee9">RadiationCavityAnalysis::B_MATRIX</a>);
  B_matrix.finalAssemble();
  tmp_vector.zero();
  
  <span class="comment">// create a petsc mat and set its values to the B matrix.</span>
  Mat matrix = B_matrix.getMat();
  
  <span class="comment">// create a PC context and create the LU factorization</span>
  PC petsc_pc;
  
  PCCreate(PETSC_COMM_SELF, &amp;petsc_pc);
  PCSetType(petsc_pc , PCLU);
  PCFactorSetUseInPlace(petsc_pc);
  PCSetOperators(petsc_pc, matrix, matrix, SAME_NONZERO_PATTERN);
  PCSetUp(petsc_pc);
  
  Mat lu_mat;
  MatStructure str;
  PCGetOperators(petsc_pc, PETSC_NULL, &amp;lu_mat, &amp;str);
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_elems; i++)
    {
      tmp_vector.set(i,1.0);
      tmp_vector.assemble();
      sol_vector.zero();
      MatSolve(lu_mat, tmp_vector.getVec(), sol_vector.getVec());
      tmp_vector.set(i,0.0);
      
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_elems; j++)
        B_inverse_matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38">set</a>(j,i,sol_vector.el(j));
    }
  
  PCDestroy(petsc_pc);
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateB_InverseMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a03d86d48b9c5d0cd54a43f34a16326b6_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a03d86d48b9c5d0cd54a43f34a16326b6_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a03d86d48b9c5d0cd54a43f34a16326b6_cgraph" id="class_radiation_cavity_analysis_a03d86d48b9c5d0cd54a43f34a16326b6_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e" title="FESystemNumerics::PetscVectorBase::el" alt="" coords="412,5,678,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix" alt="" coords="377,57,714,85"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="398,109,693,137"/><area shape="rect" id="node9" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="397,161,693,189"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="413,213,678,241"/><area shape="rect" id="node13" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="415,265,676,293"/><area shape="rect" id="node15" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions" alt="" coords="385,317,706,345"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38" title="FESystemNumerics::PetscMatrixBase::set" alt="" coords="409,369,681,397"/><area shape="rect" id="node19" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="405,421,686,449"/><area shape="rect" id="node21" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="405,473,685,501"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8142f6d6d27312dc289796a6a7188a61"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateB_Matrix" ref="a8142f6d6d27312dc289796a6a7188a61" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; *matrix_ptr, const bool sensitivity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a8142f6d6d27312dc289796a6a7188a61">RadiationCavityAnalysis::calculateB_Matrix</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>sensitivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates B matrix </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix_ptr</td><td>pointer to matrix where the calculated matrix is stored </td></tr>
    <tr><td class="paramname">DV</td><td>pointer to the design variable for sensitivity. (should NULL if no sensitivity is needed) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">472</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l02126">clearPropertyCardInitialization()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01000">FESystemNumerics::PetscMatrixBase&lt; T &gt;::diagonalAdd()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00063">F_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00064">F_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_element_8h_source.html#l00168">RadiationElement::FeElementID()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00233">fesystem_controller</a>, <a class="el" href="_analysis_discipline_base_8h_source.html#l00505">Discipline::AnalysisDisciplineBase::getAnalysisDriver()</a>, <a class="el" href="_analysis_driver_8h_source.html#l00647">Driver::AnalysisDriver::getCurrentDesignParameter()</a>, <a class="el" href="_property_database_8_c_source.html#l00128">Property::PropertyDatabase::getElemDataCardFromID()</a>, <a class="el" href="_f_e_mesh_data_8h_source.html#l00216">MeshDS::FEMeshData::getElemFromForeignID()</a>, <a class="el" href="_radiation_cavity_8h_source.html#l00242">RadiationCavity::getElemFromID()</a>, <a class="el" href="_f_e_mesh_data_8h_source.html#l00364">MeshDS::FEMeshData::getElemPropertyID()</a>, <a class="el" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359">ElemDataCard::getFactor()</a>, <a class="el" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">ElemDataCard::getFactorSensitivityForGlobalParameter()</a>, <a class="el" href="_design_parameter_8h_source.html#l00109">DesignData::DesignParameter::getID()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00111">getMatrixQuantity()</a>, <a class="el" href="_radiation_cavity_8h_source.html#l00311">RadiationCavity::getMeshData()</a>, <a class="el" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">DesignData::DesignParameter::getParameterTypeEnumID()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l02087">initializePropertyCardAtElementTemperature()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00585">FESystemNumerics::PetscMatrixBase&lt; T &gt;::leftDiagonalScale()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">FESystemNumerics::PetscMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">FESystemNumerics::PetscMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="_radiation_cavity_8h_source.html#l00364">RadiationCavity::nRadiationElems()</a>, <a class="el" href="_f_e_system_controller_8h_source.html#l00172">FESystem::FESystemController::performance_logging</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00248">performance_logging_header</a>, <a class="el" href="_f_e_system_controller_8h_source.html#l00151">FESystem::FESystemController::property_database</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00239">radiation_cavity</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00114">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00215">FESystemNumerics::PetscVectorBase&lt; T &gt;::set()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00236">thermal_discipline</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">FESystemNumerics::PetscMatrixBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">calculateQty()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateB_Matrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <span class="comment">// get a pointer to the matrices</span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>&amp; matrix = *matrix_ptr;
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  <span class="keywordflow">if</span> (matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() != n_elems || matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>() != n_elems)
    matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions">resize</a>(n_elems, n_elems);
  matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c">zero</a>();
  
  <span class="keyword">const</span> <a class="code" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters.">DesignData::DesignParameter</a>* dparam = NULL;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> DV_ID = 0;
  <span class="keywordflow">if</span> (sensitivity)
    {
      <span class="comment">// for a Property DV, the sensitivity of this quantity is zero</span>
      dparam = 
      &amp;(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>());
      DV_ID = dparam-&gt;<a class="code" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7">getID</a>();
      
      <span class="keywordflow">if</span> (dparam-&gt;<a class="code" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">getParameterTypeEnumID</a>() == DesignData::PROPERTY_PARAMETER::num())
        this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">RadiationCavityAnalysis::F_MATRIX</a>);
      <span class="keywordflow">else</span>
        this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a01aacfc6d2b8119467903e4413350d70">RadiationCavityAnalysis::F_MATRIX_SENSITIVITY</a>);
    }
  <span class="keywordflow">else</span> 
    this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">RadiationCavityAnalysis::F_MATRIX</a>);
  
  
  <a class="code" href="class_property_1_1_property_database.html">Property::PropertyDatabase</a>&amp; property_database = 
  *(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a698a7debaa46df85ed9cbeef30536254" title="stores property cards">property_database</a>.get());
  <a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html">MeshDS::FEMeshData</a>&amp; mesh_data = *(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a4c47512a0221ec3bd6cc5bf93d38d17d">getMeshData</a>());
  
  <span class="comment">// calculate [B] = [1/epsilon] - [(1 - epsilon)/epsilon] [F]</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_rad_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>(),
  fe_elem_ID = 0,  property_ID = 0;
  <span class="keywordtype">double</span>  factor1 = 0.0, factor2 = 0.0;
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> factor_1_vec(n_elems),
  factor_2_vec(n_elems);
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_rad_elems; i++)
    {
      <span class="comment">// get the ID of the finite elem, get the property card for this elem</span>
      fe_elem_ID = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#aa2186ca4c287a20ae923e6b5a5619801">getElemFromID</a>(i).<a class="code" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to.">FeElementID</a>();
      <span class="keyword">const</span> Elem* elem = mesh_data.<a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330">getElemFromForeignID</a>(fe_elem_ID);
      property_ID = mesh_data.<a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ae50bb83a080c0f9d30cb6a7b9458af54">getElemPropertyID</a>(elem);
      <a class="code" href="class_elem_data_card.html">ElemDataCard</a>&amp; elem_data_card = property_database.<a class="code" href="class_property_1_1_property_database.html#a4120ff84d49bd7d1b547507759f2d27f" title="returns the element property card for this ID">getElemDataCardFromID</a>(property_ID);
      
      <span class="comment">// if the property is temperature dependent, then initialize the property card </span>
      <span class="comment">// at the average temperature of the finite element to which this radiation </span>
      <span class="comment">// element belongs</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a3db1f2f4043524354d149fe910fd72df" title="initializes the property card at the specified temperature">initializePropertyCardAtElementTemperature</a>(elem_data_card, i);
      
      <span class="keywordflow">if</span> (sensitivity)
        {
          <span class="keywordflow">if</span> (dparam-&gt;<a class="code" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">getParameterTypeEnumID</a>() == DesignData::PROPERTY_PARAMETER::num())
            {
              <span class="comment">// sensitivity wrt global property parameter</span>
              elem_data_card.<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>(factor1, 
                                                                    RADIATION_EPSILON_FACTOR_1::num(),
                                                                    DV_ID);
              elem_data_card.<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>(factor2,
                                                                    RADIATION_EPSILON_FACTOR_2::num(),
                                                                    DV_ID);
            }
          <span class="keywordflow">else</span> 
            {
              <span class="comment">// shape sensitivity</span>
              elem_data_card.<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor1, RADIATION_EPSILON_FACTOR_1::num());
              elem_data_card.<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor2, RADIATION_EPSILON_FACTOR_2::num());
            }
        }
      <span class="keywordflow">else</span> 
        {
          elem_data_card.<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor1, RADIATION_EPSILON_FACTOR_1::num());
          elem_data_card.<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor2, RADIATION_EPSILON_FACTOR_2::num());
          <span class="keywordflow">if</span> (factor1 &lt;= 1.0)
            std::cout &lt;&lt; <span class="stringliteral">&quot;emissivity greater than 1, factor : &quot;</span> &lt;&lt; factor1 &lt;&lt; std::endl;
        }
      
      
      
      factor_2_vec.set(i, -factor2);
      factor_1_vec.set(i, factor1);
      
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af707b1f733c9f12a5d791d18c74efc47" title="clears the property card initialization">clearPropertyCardInitialization</a>(elem_data_card);
    }
  
  matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aa6a1ff5036f446d56c04ebc418ff2e2d">leftDiagonalScale</a>(factor_2_vec);
  
  <span class="keywordflow">if</span> (!(sensitivity &amp;&amp; 
        dparam-&gt;<a class="code" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">getParameterTypeEnumID</a>() == DesignData::SHAPE_PARAMETER::num()))
    matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a15f229e47968131c7df600ba3e6f2448">diagonalAdd</a>(1.0, factor_1_vec);
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateB_Matrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a8142f6d6d27312dc289796a6a7188a61_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a8142f6d6d27312dc289796a6a7188a61_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a8142f6d6d27312dc289796a6a7188a61_cgraph" id="class_radiation_cavity_analysis_a8142f6d6d27312dc289796a6a7188a61_cgraph">
<area shape="rect" id="node3" href="class_radiation_cavity_analysis.html#af707b1f733c9f12a5d791d18c74efc47" title="clears the property card initialization" alt="" coords="373,239,723,267"/><area shape="rect" id="node9" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a15f229e47968131c7df600ba3e6f2448" title="FESystemNumerics::PetscMatrixBase::diagonalAdd" alt="" coords="384,1065,712,1093"/><area shape="rect" id="node15" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to." alt="" coords="2163,962,2375,990"/><area shape="rect" id="node17" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80" title="Discipline::AnalysisDisciplineBase::getAnalysisDriver" alt="" coords="1757,369,2091,397"/><area shape="rect" id="node19" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable" alt="" coords="1762,421,2086,449"/><area shape="rect" id="node21" href="class_property_1_1_property_database.html#a4120ff84d49bd7d1b547507759f2d27f" title="returns the element property card for this ID" alt="" coords="376,447,720,475"/><area shape="rect" id="node23" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330" title="MeshDS::FEMeshData::getElemFromForeignID" alt="" coords="396,499,700,527"/><area shape="rect" id="node25" href="class_radiation_cavity.html#aa2186ca4c287a20ae923e6b5a5619801" title="RadiationCavity::getElemFromID" alt="" coords="440,551,656,579"/><area shape="rect" id="node27" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ae50bb83a080c0f9d30cb6a7b9458af54" title="MeshDS::FEMeshData::getElemPropertyID" alt="" coords="409,603,687,631"/><area shape="rect" id="node29" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor" alt="" coords="462,655,634,683"/><area shape="rect" id="node31" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c" title="ElemDataCard::getFactorSensitivityForGlobalParameter" alt="" coords="371,707,725,735"/><area shape="rect" id="node33" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7" title="DesignData::DesignParameter::getID" alt="" coords="1803,498,2045,526"/><area shape="rect" id="node35" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389" title="RadiationCavityAnalysis::getMatrixQuantity" alt="" coords="410,293,686,321"/><area shape="rect" id="node63" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="1791,861,2057,889"/><area shape="rect" id="node65" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="1793,913,2055,941"/><area shape="rect" id="node67" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions" alt="" coords="1763,965,2085,993"/><area shape="rect" id="node69" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="1784,809,2064,837"/><area shape="rect" id="node71" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702" title="DesignData::DesignParameter::getParameterTypeEnumID" alt="" coords="1740,757,2108,785"/><area shape="rect" id="node89" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity" alt="" coords="1813,1017,2035,1045"/><area shape="rect" id="node125" href="class_radiation_cavity.html#a4c47512a0221ec3bd6cc5bf93d38d17d" title="RadiationCavity::getMeshData" alt="" coords="447,1169,649,1197"/><area shape="rect" id="node128" href="class_radiation_cavity_analysis.html#a3db1f2f4043524354d149fe910fd72df" title="initializes the property card at the specified temperature" alt="" coords="331,1375,765,1403"/><area shape="rect" id="node132" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aa6a1ff5036f446d56c04ebc418ff2e2d" title="FESystemNumerics::PetscMatrixBase::leftDiagonalScale" alt="" coords="369,1117,727,1145"/><area shape="rect" id="node140" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a9fe9c425efb52cefc5b552cdf3295328" title="FESystemNumerics::PetscVectorBase::set" alt="" coords="411,1323,685,1351"/><area shape="rect" id="node5" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature" alt="" coords="814,239,1298,267"/><area shape="rect" id="node7" href="class_elem_data_card.html#ab50a2a6c9317349ae278ad3859c103b5" title="ElemDataCard::partialClearElemAndMaterialCardLocalParameterInitialization" alt="" coords="817,187,1295,215"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="891,1117,1221,1145"/><area shape="rect" id="node13" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6" title="FESystemNumerics::VectorBase::size" alt="" coords="933,1065,1179,1093"/><area shape="rect" id="node37" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95" title="RadiationCavityAnalysis::getDataInfoForQty" alt="" coords="1375,187,1657,215"/><area shape="rect" id="node57" href="class_radiation_cavity_analysis.html#a6f756b8d67e57b6d605c102fb3209e97" title="RadiationCavityAnalysis::checkIfTemperatureDependent" alt="" coords="879,343,1233,371"/><area shape="rect" id="node59" href="class_radiation_cavity_analysis.html#a72530913e06cbae197063f3e3f8fa2ca" title="RadiationCavityAnalysis::calculateQty" alt="" coords="933,757,1179,785"/><area shape="rect" id="node39" href="class_radiation_cavity.html#aa7fc38a25e02d4d38d20c16720124ef4" title="returns the cavity ID" alt="" coords="1828,265,2020,293"/><area shape="rect" id="node44" href="class_discipline_1_1_analysis_discipline_base.html#aaa6666781d3c78e003c9f8002aaeff16" title="Discipline::AnalysisDisciplineBase::getSolution" alt="" coords="1775,5,2073,33"/><area shape="rect" id="node46" href="class_solution_1_1_solution_base.html#a73528968dadb7365a70b0503032ef7c6" title="Solution::SolutionBase::getDisciplineTransientNatureEnumID" alt="" coords="1733,57,2115,85"/><area shape="rect" id="node48" href="class_driver_1_1_analysis_driver.html#ad9f4c9e39727b9b9ba9fcbe7353e9c7f" title="returns the current load case number" alt="" coords="1784,109,2064,137"/><area shape="rect" id="node50" href="class_driver_1_1_transient_analysis_driver.html#ab9622f4ee33604c4d864d63f8cc93ef6" title="Driver::TransientAnalysisDriver::getCurrentIterationNumber" alt="" coords="1739,161,2109,189"/><area shape="rect" id="node52" href="class_driver_1_1_transient_analysis_driver.html#aeb9ad9e6f71bacc09f168141428af9d5" title="Driver::TransientAnalysisDriver::getCurrentAnalysisTime" alt="" coords="1747,213,2101,241"/><area shape="rect" id="node54" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity" alt="" coords="1756,317,2092,345"/><area shape="rect" id="node61" href="class_radiation_cavity_analysis.html#a3a2849b2e8421de972e93744f335e757" title="RadiationCavityAnalysis::calculateShapeFactorMatrix" alt="" coords="1347,653,1685,681"/><area shape="rect" id="node81" href="class_radiation_cavity_analysis.html#a5a8bcd110b1fab5e384846642fc90020" title="RadiationCavityAnalysis::calculateA_Matrix" alt="" coords="1378,809,1654,837"/><area shape="rect" id="node93" href="class_radiation_cavity_analysis.html#a2225147650551e23cfff7ed0e9dcdc4c" title="RadiationCavityAnalysis::calculateA_InverseMatrix" alt="" coords="1356,963,1676,991"/><area shape="rect" id="node102" href="class_radiation_cavity_analysis.html#a03d86d48b9c5d0cd54a43f34a16326b6" title="RadiationCavityAnalysis::calculateB_InverseMatrix" alt="" coords="1356,1015,1676,1043"/><area shape="rect" id="node109" href="class_radiation_cavity_analysis.html#a1b96d789767e44f16f503128ed62a5c9" title="RadiationCavityAnalysis::calculateG_Matrix" alt="" coords="1377,757,1655,785"/><area shape="rect" id="node118" href="class_radiation_cavity_analysis.html#a2efa1a2121b55ef46dd5d57fca123d7c" title="RadiationCavityAnalysis::calculateFactorMatrix" alt="" coords="1367,705,1665,733"/><area shape="rect" id="node121" href="class_radiation_cavity_analysis.html#a9b773a18ce7531728bf76b2b6905723b" title="RadiationCavityAnalysis::calculateABInvFactorMatrix" alt="" coords="1349,601,1683,629"/><area shape="rect" id="node74" href="class_design_data_1_1_design_parameter.html#a0eb8202d84916cb7562fa2429e3bf7f8" title="DesignData::DesignParameter::getPerturbationStepSize" alt="" coords="1747,705,2101,733"/><area shape="rect" id="node76" href="class_radiation_element.html#a447d88c256c0428c9d7750f9d6a2efb2" title="ID of the elem." alt="" coords="1850,601,1998,629"/><area shape="rect" id="node78" href="class_radiation_element_pair.html#ac2c50e1d3bcc6f8086469389a56bb229" title="initializes the pair with two elements" alt="" coords="1831,653,2017,681"/><area shape="rect" id="node95" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="1776,1069,2072,1097"/><area shape="rect" id="node130" href="class_elem_data_card.html#a7c638e4644afb12563e60ca3235c1eba" title="initializes the card and the material card for the given local parameters" alt="" coords="858,1375,1254,1403"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6d92ac9dce49cfcd2627adc86e09f58c"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateB_TemperatureDependentJacobianContribution" ref="a6d92ac9dce49cfcd2627adc86e09f58c" args="(FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;vector, const FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;rad_temp_vector, FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; &amp;A_inv_mat, FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; &amp;AB_inv_mat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a6d92ac9dce49cfcd2627adc86e09f58c">RadiationCavityAnalysis::calculateB_TemperatureDependentJacobianContribution</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rad_temp_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>A_inv_mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>AB_inv_mat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculate the matrix <img class="formulaInl" alt="$ \frac{\partial B_{ij}}{\partial T_{rad_k}} \lambda_j $" src="form_1.png"/> </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01661">1661</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00063">F_MATRIX</a>, <a class="el" href="_property_database_8_c_source.html#l00128">Property::PropertyDatabase::getElemDataCardFromID()</a>, <a class="el" href="_f_e_mesh_data_8h_source.html#l00216">MeshDS::FEMeshData::getElemFromForeignID()</a>, <a class="el" href="_f_e_mesh_data_8h_source.html#l00364">MeshDS::FEMeshData::getElemPropertyID()</a>, <a class="el" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55">ElemDataCard::getFactorSensitivityForLocalParameter()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00313">FESystemNumerics::PetscMatrixBase&lt; T &gt;::getRow()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">FESystemNumerics::PetscMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">FESystemNumerics::PetscMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="_petsc_seq_vector_8h_source.html#l00093">FESystemNumerics::PetscSeqVector&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00786">FESystemNumerics::PetscMatrixBase&lt; T &gt;::rightMultiplyVector()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00215">FESystemNumerics::PetscVectorBase&lt; T &gt;::set()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00408">FESystemNumerics::PetscVectorBase&lt; T &gt;::size()</a>, and <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  
  <span class="comment">// create some temporary set of values for the procedure below</span>
  <span class="keywordflow">if</span> (vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac">size</a>() != n_elems)
    vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions">resize</a>(n_elems);
  Assert(A_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() == n_elems &amp;&amp; 
         A_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>() == n_elems, ExcInternalError());
  Assert(AB_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() == n_elems &amp;&amp; 
         AB_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>() == n_elems, ExcInternalError());
  
  vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> vector1(n_elems), vector2(n_elems), vector3(n_elems);
  vector1.zero(); vector2.zero(); vector3.zero();
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> F_matrix(n_elems, n_elems);
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(F_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">RadiationCavityAnalysis::F_MATRIX</a>);
  
  <span class="comment">// first, get a vector for [B]^(-1) * {(T_rad + T_a)^4}</span>
  AB_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a89fe3f3f5841376aa58fe144278c707c">rightMultiplyVector</a>(rad_temp_vector, vector2);
  
  <span class="comment">// if the cavity AB_inv matrix is being approximated, then calculated </span>
  <span class="comment">// vector needs to be corrected</span>
  <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ac5080de08bcb7b1c43830650b87c061c" title="boolean about whether to approximate or recalculate ABInv factor">ifApproximateABInvFactor</a>())
    {
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a92c0ccdda2e26fb12ef85ee8013cc314">getTemperatureDependentFluxCorrectionVector</a>(vector1, AB_inv_mat);
      vector1.pointwiseMultiply(vector2);
      AB_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a89fe3f3f5841376aa58fe144278c707c">rightMultiplyVector</a>(vector1, vector3);
      vector2.add(1.0, vector3);
    }
  
  A_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a89fe3f3f5841376aa58fe144278c707c">rightMultiplyVector</a>(vector2, vector1);
  
  
  <a class="code" href="class_property_1_1_property_database.html">Property::PropertyDatabase</a>&amp; property_database = 
  *(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a698a7debaa46df85ed9cbeef30536254" title="stores property cards">property_database</a>.get());
  <a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html">MeshDS::FEMeshData</a>&amp; mesh_data = *(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a4c47512a0221ec3bd6cc5bf93d38d17d">getMeshData</a>());
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fe_elem_ID, property_ID;
  <span class="keywordtype">double</span> factor;
  
  <span class="comment">// iterate over each radiation element, and calculate the contribution</span>
  <span class="comment">// this loop calculates the term [\frac{\partial B_{ij}}{\partial T_{R_k}}\psi_j]_diag</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_elems; i++)
    {
      <span class="comment">// get the ID of the finite elem, get the property card for this elem</span>
      fe_elem_ID = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#aa2186ca4c287a20ae923e6b5a5619801">getElemFromID</a>(i).<a class="code" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to.">FeElementID</a>();
      <span class="keyword">const</span> Elem* elem = mesh_data.<a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330">getElemFromForeignID</a>(fe_elem_ID);
      property_ID = mesh_data.<a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ae50bb83a080c0f9d30cb6a7b9458af54">getElemPropertyID</a>(elem);
      <a class="code" href="class_elem_data_card.html">ElemDataCard</a>&amp; elem_data_card = property_database.<a class="code" href="class_property_1_1_property_database.html#a4120ff84d49bd7d1b547507759f2d27f" title="returns the element property card for this ID">getElemDataCardFromID</a>(property_ID);
      
      <span class="comment">// if the property is temperature dependent, then initialize the property card </span>
      <span class="comment">// at the average temperature of the finite element to which this radiation </span>
      <span class="comment">// element belongs</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a3db1f2f4043524354d149fe910fd72df" title="initializes the property card at the specified temperature">initializePropertyCardAtElementTemperature</a>(elem_data_card, i);
      
      <span class="comment">// this is the term (\frac{-1}{epsilon^2_{R_i}} </span>
      <span class="comment">//  \frac{\partial \epsilon_{R_i}(T_{R_i})}{\partial T_{R_k}} \delta_{ij} \delta_{ik})</span>
      <span class="comment">// sensitivities for both factor1 and factor2 are the same, hence, only one is</span>
      <span class="comment">// obtained</span>
      elem_data_card.<a class="code" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55">getFactorSensitivityForLocalParameter</a>(factor, 
                                                           RADIATION_EPSILON_FACTOR_1::num(),
                                                           Property::TEMPERATURE::num());      
      
      F_matrix.getRow(i, vector2);
      vector2.scale(-factor);
      vector2.add(i, factor);
      vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a9fe9c425efb52cefc5b552cdf3295328">set</a>(i, vector1.dot(vector2));
      
      
      <span class="comment">// once this card has been used, clear the initialization</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af707b1f733c9f12a5d791d18c74efc47" title="clears the property card initialization">clearPropertyCardInitialization</a>(elem_data_card);
    }
  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a6d92ac9dce49cfcd2627adc86e09f58c_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a6d92ac9dce49cfcd2627adc86e09f58c_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a6d92ac9dce49cfcd2627adc86e09f58c_cgraph" id="class_radiation_cavity_analysis_a6d92ac9dce49cfcd2627adc86e09f58c_cgraph">
<area shape="rect" id="node3" href="class_property_1_1_property_database.html#a4120ff84d49bd7d1b547507759f2d27f" title="returns the element property card for this ID" alt="" coords="569,5,914,33"/><area shape="rect" id="node5" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330" title="MeshDS::FEMeshData::getElemFromForeignID" alt="" coords="590,57,893,85"/><area shape="rect" id="node7" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ae50bb83a080c0f9d30cb6a7b9458af54" title="MeshDS::FEMeshData::getElemPropertyID" alt="" coords="602,109,880,137"/><area shape="rect" id="node9" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55" title="ElemDataCard::getFactorSensitivityForLocalParameter" alt="" coords="568,161,915,189"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a440da4d6191d314453b25d39aa879cbe" title="returns the i th row of the matrix in the given vector" alt="" coords="592,213,891,241"/><area shape="rect" id="node19" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="609,265,874,293"/><area shape="rect" id="node21" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="611,317,872,345"/><area shape="rect" id="node23" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions" alt="" coords="599,369,884,397"/><area shape="rect" id="node25" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a89fe3f3f5841376aa58fe144278c707c" title="FESystemNumerics::PetscMatrixBase::rightMultiplyVector" alt="" coords="560,421,923,449"/><area shape="rect" id="node28" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="995,473,1277,501"/><area shape="rect" id="node32" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a9fe9c425efb52cefc5b552cdf3295328" title="FESystemNumerics::PetscVectorBase::set" alt="" coords="605,525,878,553"/><area shape="rect" id="node34" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac" title="FESystemNumerics::PetscVectorBase::size" alt="" coords="602,577,881,605"/><area shape="rect" id="node13" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="971,317,1301,345"/><area shape="rect" id="node15" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6" title="FESystemNumerics::VectorBase::size" alt="" coords="1013,187,1259,215"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_vector_base.html#a0169b6538792acd62a1724ea15dfbe94" title="FESystemNumerics::VectorBase::zero" alt="" coords="1012,239,1260,267"/><area shape="rect" id="node30" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="988,421,1284,449"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4d8daf804dae432452faf1334b5ee457"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateEmissivityVector" ref="a4d8daf804dae432452faf1334b5ee457" args="(FESystemNumerics::PetscSeqVector&lt; double &gt; *vector_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a4d8daf804dae432452faf1334b5ee457">RadiationCavityAnalysis::calculateEmissivityVector</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vector_ptr</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates the vector of emissivities for the current temperature of the cavity </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00783">783</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_property_database_8_c_source.html#l00128">Property::PropertyDatabase::getElemDataCardFromID()</a>, <a class="el" href="_f_e_mesh_data_8h_source.html#l00216">MeshDS::FEMeshData::getElemFromForeignID()</a>, <a class="el" href="_f_e_mesh_data_8h_source.html#l00364">MeshDS::FEMeshData::getElemPropertyID()</a>, <a class="el" href="class_elem_data_card.html#a6668a99eca477724cd612fa8c4bd7409">ElemDataCard::getPropertyValueFromMaterialCard()</a>, <a class="el" href="_material_property_name_enums_8h_source.html#l00353">EMISSIVITY::num()</a>, <a class="el" href="_petsc_seq_vector_8h_source.html#l00093">FESystemNumerics::PetscSeqVector&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00215">FESystemNumerics::PetscVectorBase&lt; T &gt;::set()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00408">FESystemNumerics::PetscVectorBase&lt; T &gt;::size()</a>, and <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateEmissivityVector()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a>&amp; eps_vec = *vector_ptr;
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  <span class="keywordflow">if</span> (eps_vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac">size</a>() != n_elems)
    eps_vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions">resize</a>(n_elems);
  eps_vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
  
  
  <a class="code" href="class_property_1_1_property_database.html">Property::PropertyDatabase</a>&amp; property_database = 
  *(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a698a7debaa46df85ed9cbeef30536254" title="stores property cards">property_database</a>.get());
  <a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html">MeshDS::FEMeshData</a>&amp; mesh_data = *(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a4c47512a0221ec3bd6cc5bf93d38d17d">getMeshData</a>());
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fe_elem_ID = 0,  property_ID = 0;
  <span class="keywordtype">double</span>  factor1 = 0.0;
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_elems; i++)
    {
      <span class="comment">// get the ID of the finite elem, get the property card for this elem</span>
      fe_elem_ID = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#aa2186ca4c287a20ae923e6b5a5619801">getElemFromID</a>(i).<a class="code" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to.">FeElementID</a>();
      <span class="keyword">const</span> Elem* elem = mesh_data.<a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330">getElemFromForeignID</a>(fe_elem_ID);
      property_ID = mesh_data.<a class="code" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ae50bb83a080c0f9d30cb6a7b9458af54">getElemPropertyID</a>(elem);
      <a class="code" href="class_elem_data_card.html">ElemDataCard</a>&amp; elem_data_card = property_database.<a class="code" href="class_property_1_1_property_database.html#a4120ff84d49bd7d1b547507759f2d27f" title="returns the element property card for this ID">getElemDataCardFromID</a>(property_ID);
      
      <span class="comment">// if the property is temperature dependent, then initialize the property card </span>
      <span class="comment">// at the average temperature of the finite element to which this radiation </span>
      <span class="comment">// element belongs</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a3db1f2f4043524354d149fe910fd72df" title="initializes the property card at the specified temperature">initializePropertyCardAtElementTemperature</a>(elem_data_card, i);
      
      elem_data_card.<a class="code" href="class_elem_data_card.html#a6668a99eca477724cd612fa8c4bd7409" title="returns value from material card">getPropertyValueFromMaterialCard</a>(<a class="code" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6">EMISSIVITY::num</a>(), factor1);
      <span class="keywordflow">if</span> (factor1 &gt; 1.0)
        std::cout &lt;&lt; <span class="stringliteral">&quot;emissivity greater than 1, value : &quot;</span> &lt;&lt; factor1 &lt;&lt; std::endl;
      
      
      eps_vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a9fe9c425efb52cefc5b552cdf3295328">set</a>(i, factor1);
      
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af707b1f733c9f12a5d791d18c74efc47" title="clears the property card initialization">clearPropertyCardInitialization</a>(elem_data_card);
    }
  
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateEmissivityVector()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a4d8daf804dae432452faf1334b5ee457_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a4d8daf804dae432452faf1334b5ee457_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a4d8daf804dae432452faf1334b5ee457_cgraph" id="class_radiation_cavity_analysis_a4d8daf804dae432452faf1334b5ee457_cgraph">
<area shape="rect" id="node3" href="class_property_1_1_property_database.html#a4120ff84d49bd7d1b547507759f2d27f" title="returns the element property card for this ID" alt="" coords="376,5,720,33"/><area shape="rect" id="node5" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330" title="MeshDS::FEMeshData::getElemFromForeignID" alt="" coords="396,57,700,85"/><area shape="rect" id="node7" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ae50bb83a080c0f9d30cb6a7b9458af54" title="MeshDS::FEMeshData::getElemPropertyID" alt="" coords="409,109,687,137"/><area shape="rect" id="node9" href="class_elem_data_card.html#a6668a99eca477724cd612fa8c4bd7409" title="returns value from material card" alt="" coords="385,161,711,189"/><area shape="rect" id="node11" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6" title="EMISSIVITY::num" alt="" coords="484,213,612,241"/><area shape="rect" id="node13" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions" alt="" coords="406,265,690,293"/><area shape="rect" id="node15" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a9fe9c425efb52cefc5b552cdf3295328" title="FESystemNumerics::PetscVectorBase::set" alt="" coords="411,317,685,345"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac" title="FESystemNumerics::PetscVectorBase::size" alt="" coords="408,369,688,397"/><area shape="rect" id="node19" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="407,421,689,449"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2efa1a2121b55ef46dd5d57fca123d7c"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateFactorMatrix" ref="a2efa1a2121b55ef46dd5d57fca123d7c" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; *matrix_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a2efa1a2121b55ef46dd5d57fca123d7c">RadiationCavityAnalysis::calculateFactorMatrix</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix_ptr</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculate factor matrix </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix_ptr</td><td>pointer to matrix where the calculated matrix is stored </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01005">1005</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00065">A_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00070">B_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00071">G_MATRIX</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">FESystemNumerics::PetscMatrixBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">calculateQty()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateFactorMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <span class="comment">// this is now being limited only to cases with temperature &quot;independent&quot; </span>
  <span class="comment">// material properties</span>
  Assert(!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>(),
         ExcInternalError());
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>&amp; factor_matrix = *matrix_ptr;
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  factor_matrix.zero();
  
  <span class="comment">// get references to the A and G matrices</span>
  <span class="comment">// the factor matrix will be calculated using the expression </span>
  <span class="comment">// factor = [G]^T  [A] [B]^(-1)</span>
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(factor_matrix, 
                          <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795">RadiationCavityAnalysis::B_INVERSE_MATRIX</a>);
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> matrix1(n_elems, n_elems);
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(matrix1, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">RadiationCavityAnalysis::A_MATRIX</a>);
  
  factor_matrix.leftMultiply(matrix1);
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(matrix1, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">RadiationCavityAnalysis::G_MATRIX</a>);
  
  factor_matrix.leftMultiplyTranspose(matrix1);
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateFactorMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a2efa1a2121b55ef46dd5d57fca123d7c_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a2efa1a2121b55ef46dd5d57fca123d7c_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a2efa1a2121b55ef46dd5d57fca123d7c_cgraph" id="class_radiation_cavity_analysis_a2efa1a2121b55ef46dd5d57fca123d7c_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="352,5,632,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1b96d789767e44f16f503128ed62a5c9"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateG_Matrix" ref="a1b96d789767e44f16f503128ed62a5c9" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; *matrix_ptr, const bool sensitivity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a1b96d789767e44f16f503128ed62a5c9">RadiationCavityAnalysis::calculateG_Matrix</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>sensitivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculated G matrix </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix_ptr</td><td>pointer to matrix where the calculated matrix is stored </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00579">579</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_petsc_matrix_base_8h_source.html#l00897">FESystemNumerics::PetscMatrixBase&lt; T &gt;::add()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00071">G_MATRIX</a>, <a class="el" href="_design_parameter_8h_source.html#l00109">DesignData::DesignParameter::getID()</a>, <a class="el" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">DesignData::DesignParameter::getParameterTypeEnumID()</a>, <a class="el" href="_design_parameter_8h_source.html#l00146">DesignData::DesignParameter::getPerturbationStepSize()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">FESystemNumerics::PetscMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">FESystemNumerics::PetscMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="_petsc_seq_vector_8h_source.html#l00093">FESystemNumerics::PetscSeqVector&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00114">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01043">FESystemNumerics::PetscMatrixBase&lt; T &gt;::scale()</a>, <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae18d819dc1f95b6b8f157055b2d9c27c">FESystemNumerics::PetscMatrixBase&lt; T &gt;::setRow()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00408">FESystemNumerics::PetscVectorBase&lt; T &gt;::size()</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">FESystemNumerics::PetscMatrixBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">calculateQty()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateG_Matrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <span class="comment">// get a pointer to the matrices</span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>&amp; matrix = *matrix_ptr;
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a8018aadd0171d514477ada7314cbbc1b">getFENodes</a>().size();
  <span class="keywordflow">if</span> (matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() != n_elems || matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>() != n_nodes)
    matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions">resize</a>(n_elems, n_nodes);
  matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c">zero</a>();
  
  <span class="comment">// for shape design variable, the shape factor matrix will be calculated for </span>
  <span class="comment">// the perturbed mesh. The base shape factor matrix, is then retrived and the </span>
  <span class="comment">// sensitivity is then calculated</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> DV_ID = 0;
  <span class="keywordtype">double</span> perturbation = 0.0;
  <span class="keywordflow">if</span> (sensitivity)
    {
      <span class="comment">// for a Property DV, the sensitivity of this quantity is zero</span>
      <span class="keyword">const</span> <a class="code" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters.">DesignData::DesignParameter</a>&amp; dparam = 
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>();
      <span class="keywordflow">if</span> (dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">getParameterTypeEnumID</a>() == DesignData::PROPERTY_PARAMETER::num())
        <span class="keywordflow">return</span>;
      <span class="keywordflow">else</span> 
        {
          DV_ID = dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7">getID</a>();
          perturbation = dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#a0eb8202d84916cb7562fa2429e3bf7f8">getPerturbationStepSize</a>();
        }
    }
  
  
  <span class="comment">// iterate over all the radiation elements, get G matrix from each, </span>
  <span class="comment">// and add them to the global G matrix. The rows where the G matrix rows </span>
  <span class="comment">// will be added will be the dof of the radiation element</span>
  <span class="comment">// and the column will be the node number for the FE to which this</span>
  <span class="comment">// radiation element belongs</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_dof = 0, n_elem_nodes = 0;
  std::vector&lt;unsigned int&gt; fe_node_ID_vec;
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> elem_G_vec;
  
  <span class="comment">// if sensitivity is requested, then the DV_ID will be nonzero, due to which</span>
  <span class="comment">// the elem iterators will point to the perturbed geom elements</span>
  <a class="code" href="_radiation_cavity_8h.html#a95a54ed90e810eea01d0a99c2d9fdfe4">RadiationElemConstIterator</a> elem_it, elem_end;
  elem_it = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ad15a5dc4fe14dd62ba4f938a708a5aa6">getElemBeginIterator</a>(DV_ID);
  elem_end = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a7d3dc9abc5b0e6c43d35fc186276f1ab">getElemEndIterator</a>(DV_ID);
  
  <span class="keywordflow">for</span> (; elem_it != elem_end; elem_it++)
    {
      elem_dof = (*elem_it)-&gt;ID();
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ae94eed3036f1184da73c8b95d4a034ba">getInternalNodeIDForRadElem</a>
      (elem_dof, fe_node_ID_vec);
      
      n_elem_nodes = fe_node_ID_vec.size();
      
      elem_G_vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions">resize</a>(n_elem_nodes);
      
      (*elem_it)-&gt;getRadElemG_Vector(elem_G_vec);
      
      matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae18d819dc1f95b6b8f157055b2d9c27c">setRow</a>(elem_dof, fe_node_ID_vec, elem_G_vec);
    }
  
  <span class="keywordflow">if</span> (sensitivity) <span class="comment">// implies shape sensitivity is being sought</span>
    {
      <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> matrix_base(n_elems, n_nodes); 
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(matrix_base, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">RadiationCavityAnalysis::G_MATRIX</a>);
      matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa">add</a>(-1.0, matrix_base, <span class="keyword">true</span>);
      matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b">scale</a>(1.0/perturbation);
    }
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateG_Matrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a1b96d789767e44f16f503128ed62a5c9_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a1b96d789767e44f16f503128ed62a5c9_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a1b96d789767e44f16f503128ed62a5c9_cgraph" id="class_radiation_cavity_analysis_a1b96d789767e44f16f503128ed62a5c9_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa" title="FESystemNumerics::PetscMatrixBase::add" alt="" coords="379,30,655,58"/><area shape="rect" id="node9" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7" title="DesignData::DesignParameter::getID" alt="" coords="397,82,638,110"/><area shape="rect" id="node11" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702" title="DesignData::DesignParameter::getParameterTypeEnumID" alt="" coords="334,134,701,162"/><area shape="rect" id="node13" href="class_design_data_1_1_design_parameter.html#a0eb8202d84916cb7562fa2429e3bf7f8" title="DesignData::DesignParameter::getPerturbationStepSize" alt="" coords="340,186,694,214"/><area shape="rect" id="node15" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="385,238,650,266"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="387,290,648,318"/><area shape="rect" id="node19" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions" alt="" coords="375,342,660,370"/><area shape="rect" id="node21" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions" alt="" coords="357,394,678,422"/><area shape="rect" id="node23" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b" title="FESystemNumerics::PetscMatrixBase::scale" alt="" coords="375,446,660,474"/><area shape="rect" id="node25" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae18d819dc1f95b6b8f157055b2d9c27c" title="FESystemNumerics::PetscMatrixBase::setRow" alt="" coords="368,498,667,526"/><area shape="rect" id="node27" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac" title="FESystemNumerics::PetscVectorBase::size" alt="" coords="378,550,657,578"/><area shape="rect" id="node29" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="377,602,657,630"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91" title="FESystemNumerics::MatrixBase::getMatrixPackage" alt="" coords="750,5,1077,33"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="766,57,1061,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a72530913e06cbae197063f3e3f8fa2ca"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateQty" ref="a72530913e06cbae197063f3e3f8fa2ca" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; *matrix, const RadiationQty qty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a72530913e06cbae197063f3e3f8fa2ca">RadiationCavityAnalysis::calculateQty</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationQty</a>&#160;</td>
          <td class="paramname"><em>qty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates and returns the quantity in the matrix that is passed as the arguement. This method is merely an interface that calls the respective method based on the quantity that is being seeked </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix</td><td>pointer to matrix where the quantity will be stored </td></tr>
    <tr><td class="paramname">qty</td><td>name of the quantity that is to be calculated </td></tr>
    <tr><td class="paramname">DV</td><td>pointer to a design variable for which sensitivity is being seeked. If no sensitivity is required, DV should be NULL </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">254</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00066">A_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00065">A_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00067">A_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00074">AB_INV_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00070">B_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00068">B_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00069">B_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00661">calculateA_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00838">calculateABInvFactorMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00721">calculateB_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">calculateB_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01005">calculateFactorMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00579">calculateG_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">calculateShapeFactorMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00063">F_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00064">F_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00073">FACTOR_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00071">G_MATRIX</a>, and <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00072">G_MATRIX_SENSITIVITY</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00111">getMatrixQuantity()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">switch</span> (qty)
  {
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">RadiationCavityAnalysis::F_MATRIX</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a3a2849b2e8421de972e93744f335e757">calculateShapeFactorMatrix</a>(matrix, <span class="keyword">false</span>);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a01aacfc6d2b8119467903e4413350d70">RadiationCavityAnalysis::F_MATRIX_SENSITIVITY</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a3a2849b2e8421de972e93744f335e757">calculateShapeFactorMatrix</a>(matrix, <span class="keyword">true</span>);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">RadiationCavityAnalysis::A_MATRIX</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a5a8bcd110b1fab5e384846642fc90020">calculateA_Matrix</a>(matrix, <span class="keyword">false</span>);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ae8bc4b7f41e205e9e6fe14a31a551ef0">RadiationCavityAnalysis::A_INVERSE_MATRIX</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a2225147650551e23cfff7ed0e9dcdc4c">calculateA_InverseMatrix</a>(matrix);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9afc5da26c57bb9e45d36e0b65db2e061b">RadiationCavityAnalysis::A_MATRIX_SENSITIVITY</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a5a8bcd110b1fab5e384846642fc90020">calculateA_Matrix</a>(matrix, <span class="keyword">true</span>);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9abe6a1b3373498e2afa348361975f9ee9">RadiationCavityAnalysis::B_MATRIX</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a8142f6d6d27312dc289796a6a7188a61">calculateB_Matrix</a>(matrix, <span class="keyword">false</span>);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aa8e253c18366682e146778d7d9c6d09e">RadiationCavityAnalysis::B_MATRIX_SENSITIVITY</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a8142f6d6d27312dc289796a6a7188a61">calculateB_Matrix</a>(matrix, <span class="keyword">true</span>);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795">RadiationCavityAnalysis::B_INVERSE_MATRIX</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a03d86d48b9c5d0cd54a43f34a16326b6">calculateB_InverseMatrix</a>(matrix);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">RadiationCavityAnalysis::G_MATRIX</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1b96d789767e44f16f503128ed62a5c9">calculateG_Matrix</a>(matrix, <span class="keyword">false</span>);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ab3e00964c9ce893d80049b2b2daf4967">RadiationCavityAnalysis::G_MATRIX_SENSITIVITY</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1b96d789767e44f16f503128ed62a5c9">calculateG_Matrix</a>(matrix, <span class="keyword">true</span>);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998">RadiationCavityAnalysis::FACTOR_MATRIX</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a2efa1a2121b55ef46dd5d57fca123d7c">calculateFactorMatrix</a>(matrix);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0">RadiationCavityAnalysis::AB_INV_MATRIX</a>:
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9b773a18ce7531728bf76b2b6905723b">calculateABInvFactorMatrix</a>(matrix);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      abort();
      <span class="keywordflow">break</span>;
  }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a72530913e06cbae197063f3e3f8fa2ca_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a72530913e06cbae197063f3e3f8fa2ca_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a72530913e06cbae197063f3e3f8fa2ca_cgraph" id="class_radiation_cavity_analysis_a72530913e06cbae197063f3e3f8fa2ca_cgraph">
<area shape="rect" id="node3" href="class_radiation_cavity_analysis.html#a2225147650551e23cfff7ed0e9dcdc4c" title="RadiationCavityAnalysis::calculateA_InverseMatrix" alt="" coords="308,350,628,378"/><area shape="rect" id="node25" href="class_radiation_cavity_analysis.html#a5a8bcd110b1fab5e384846642fc90020" title="RadiationCavityAnalysis::calculateA_Matrix" alt="" coords="330,1155,606,1183"/><area shape="rect" id="node49" href="class_radiation_cavity_analysis.html#a9b773a18ce7531728bf76b2b6905723b" title="RadiationCavityAnalysis::calculateABInvFactorMatrix" alt="" coords="301,558,635,586"/><area shape="rect" id="node60" href="class_radiation_cavity_analysis.html#a03d86d48b9c5d0cd54a43f34a16326b6" title="RadiationCavityAnalysis::calculateB_InverseMatrix" alt="" coords="308,402,628,430"/><area shape="rect" id="node72" href="class_radiation_cavity_analysis.html#a8142f6d6d27312dc289796a6a7188a61" title="RadiationCavityAnalysis::calculateB_Matrix" alt="" coords="330,1597,606,1625"/><area shape="rect" id="node112" href="class_radiation_cavity_analysis.html#a2efa1a2121b55ef46dd5d57fca123d7c" title="RadiationCavityAnalysis::calculateFactorMatrix" alt="" coords="319,713,617,741"/><area shape="rect" id="node115" href="class_radiation_cavity_analysis.html#a1b96d789767e44f16f503128ed62a5c9" title="RadiationCavityAnalysis::calculateG_Matrix" alt="" coords="329,947,607,975"/><area shape="rect" id="node133" href="class_radiation_cavity_analysis.html#a3a2849b2e8421de972e93744f335e757" title="RadiationCavityAnalysis::calculateShapeFactorMatrix" alt="" coords="299,843,637,871"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e" title="FESystemNumerics::PetscVectorBase::el" alt="" coords="770,117,1036,145"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix" alt="" coords="734,169,1071,197"/><area shape="rect" id="node9" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="1169,273,1463,301"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="1168,325,1464,353"/><area shape="rect" id="node13" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="770,895,1035,923"/><area shape="rect" id="node15" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="772,791,1033,819"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions" alt="" coords="742,739,1063,767"/><area shape="rect" id="node19" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38" title="FESystemNumerics::PetscMatrixBase::set" alt="" coords="767,375,1039,403"/><area shape="rect" id="node21" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="762,221,1043,249"/><area shape="rect" id="node23" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="763,635,1043,663"/><area shape="rect" id="node27" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa" title="FESystemNumerics::PetscMatrixBase::add" alt="" coords="765,999,1041,1027"/><area shape="rect" id="node30" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80" title="Discipline::AnalysisDisciplineBase::getAnalysisDriver" alt="" coords="736,1415,1070,1443"/><area shape="rect" id="node32" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable" alt="" coords="741,1467,1064,1495"/><area shape="rect" id="node34" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389" title="RadiationCavityAnalysis::getMatrixQuantity" alt="" coords="765,1519,1041,1547"/><area shape="rect" id="node37" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702" title="DesignData::DesignParameter::getParameterTypeEnumID" alt="" coords="719,1259,1086,1287"/><area shape="rect" id="node41" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity" alt="" coords="791,1363,1014,1391"/><area shape="rect" id="node44" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b" title="FESystemNumerics::PetscMatrixBase::scale" alt="" coords="760,1155,1045,1183"/><area shape="rect" id="node46" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a61d3ca9a3e1f750e2b28f1dd503990d7" title="adds val to all diagonal elements of the matrix" alt="" coords="763,1311,1042,1339"/><area shape="rect" id="node51" href="class_f_e_system_database_1_1_generic_data_info_base.html#ab5cbefc863791bda1b4962a22598e9e0" title="clears the data structures of this object" alt="" coords="747,427,1058,455"/><area shape="rect" id="node53" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID" alt="" coords="700,479,1105,507"/><area shape="rect" id="node55" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent" alt="" coords="722,531,1083,559"/><area shape="rect" id="node57" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity" alt="" coords="735,583,1070,611"/><area shape="rect" id="node74" href="class_radiation_cavity_analysis.html#af707b1f733c9f12a5d791d18c74efc47" title="clears the property card initialization" alt="" coords="728,2195,1077,2223"/><area shape="rect" id="node76" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a15f229e47968131c7df600ba3e6f2448" title="FESystemNumerics::PetscMatrixBase::diagonalAdd" alt="" coords="739,1623,1067,1651"/><area shape="rect" id="node78" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to." alt="" coords="797,1675,1009,1703"/><area shape="rect" id="node82" href="class_property_1_1_property_database.html#a4120ff84d49bd7d1b547507759f2d27f" title="returns the element property card for this ID" alt="" coords="730,1727,1075,1755"/><area shape="rect" id="node84" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330" title="MeshDS::FEMeshData::getElemFromForeignID" alt="" coords="751,1779,1054,1807"/><area shape="rect" id="node86" href="class_radiation_cavity.html#aa2186ca4c287a20ae923e6b5a5619801" title="RadiationCavity::getElemFromID" alt="" coords="795,1831,1010,1859"/><area shape="rect" id="node88" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ae50bb83a080c0f9d30cb6a7b9458af54" title="MeshDS::FEMeshData::getElemPropertyID" alt="" coords="764,1883,1042,1911"/><area shape="rect" id="node90" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor" alt="" coords="816,1935,989,1963"/><area shape="rect" id="node92" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c" title="ElemDataCard::getFactorSensitivityForGlobalParameter" alt="" coords="726,1987,1079,2015"/><area shape="rect" id="node94" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7" title="DesignData::DesignParameter::getID" alt="" coords="782,1207,1023,1235"/><area shape="rect" id="node97" href="class_radiation_cavity.html#a4c47512a0221ec3bd6cc5bf93d38d17d" title="RadiationCavity::getMeshData" alt="" coords="802,2039,1003,2067"/><area shape="rect" id="node100" href="class_radiation_cavity_analysis.html#a3db1f2f4043524354d149fe910fd72df" title="initializes the property card at the specified temperature" alt="" coords="685,2091,1120,2119"/><area shape="rect" id="node102" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aa6a1ff5036f446d56c04ebc418ff2e2d" title="FESystemNumerics::PetscMatrixBase::leftDiagonalScale" alt="" coords="724,1571,1082,1599"/><area shape="rect" id="node109" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a9fe9c425efb52cefc5b552cdf3295328" title="FESystemNumerics::PetscVectorBase::set" alt="" coords="766,2143,1039,2171"/><area shape="rect" id="node120" href="class_design_data_1_1_design_parameter.html#a0eb8202d84916cb7562fa2429e3bf7f8" title="DesignData::DesignParameter::getPerturbationStepSize" alt="" coords="726,843,1080,871"/><area shape="rect" id="node124" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions" alt="" coords="760,1103,1045,1131"/><area shape="rect" id="node128" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae18d819dc1f95b6b8f157055b2d9c27c" title="FESystemNumerics::PetscMatrixBase::setRow" alt="" coords="753,947,1052,975"/><area shape="rect" id="node130" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac" title="FESystemNumerics::PetscVectorBase::size" alt="" coords="763,1051,1042,1079"/><area shape="rect" id="node142" href="class_radiation_element.html#a447d88c256c0428c9d7750f9d6a2efb2" title="ID of the elem." alt="" coords="829,687,976,715"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aef377bb5ffe6811cf1c27448ddfc0365"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateRadElemTempVector" ref="aef377bb5ffe6811cf1c27448ddfc0365" args="(FESystemNumerics::PetscSeqVector&lt; double &gt; *rad_temp_vector_ptr, FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;nodal_temp_vector, const bool reduce_power_by_four, const bool sensitivity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#aef377bb5ffe6811cf1c27448ddfc0365">RadiationCavityAnalysis::calculateRadElemTempVector</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>rad_temp_vector_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodal_temp_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>reduce_power_by_four</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>sensitivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates the radiation temperature vector from the FE nodal load vector </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rad_temp_vector_ptr</td><td>radiation vector </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01069">1069</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_petsc_vector_base_8h_source.html#l00422">FESystemNumerics::PetscVectorBase&lt; T &gt;::add()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00187">FESystemNumerics::PetscVectorBase&lt; T &gt;::el()</a>, <a class="el" href="_design_parameter_8h_source.html#l00109">DesignData::DesignParameter::getID()</a>, <a class="el" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">DesignData::DesignParameter::getParameterTypeEnumID()</a>, <a class="el" href="_design_parameter_8h_source.html#l00146">DesignData::DesignParameter::getPerturbationStepSize()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00267">FESystemNumerics::PetscVectorBase&lt; T &gt;::power()</a>, <a class="el" href="_petsc_seq_vector_8h_source.html#l00093">FESystemNumerics::PetscSeqVector&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00511">FESystemNumerics::PetscVectorBase&lt; T &gt;::scale()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00215">FESystemNumerics::PetscVectorBase&lt; T &gt;::set()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00408">FESystemNumerics::PetscVectorBase&lt; T &gt;::size()</a>, and <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a>&amp; rad_temp_vector = *rad_temp_vector_ptr;
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  <span class="keywordflow">if</span> (rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac">size</a>() != n_elems)
    rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions">resize</a>(n_elems);
  rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
  
  <span class="comment">// get the value of absolute temperature </span>
  <span class="keyword">const</span> <span class="keywordtype">double</span> temp_abs = 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#ae2f9f30b83db8a3cb69787c283708210" title="stores analysis details">analysis_case</a>-&gt;getRealParameter(<span class="stringliteral">&quot;ABSOLUTE_TEMP&quot;</span>);
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> DV_ID = 0;
  <span class="keywordtype">double</span> perturbation = 0.0;
  <span class="keywordflow">if</span> (sensitivity)
    {
      <span class="comment">// for a Property DV, the sensitivity of this quantity is zero</span>
      <span class="keyword">const</span> <a class="code" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters.">DesignData::DesignParameter</a>&amp; dparam = 
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>();
      <span class="keywordflow">if</span> (dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">getParameterTypeEnumID</a>() == DesignData::PROPERTY_PARAMETER::num())
        <span class="keywordflow">return</span>;
      <span class="keywordflow">else</span> 
        {
          DV_ID = dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7">getID</a>();
          perturbation = dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#a0eb8202d84916cb7562fa2429e3bf7f8">getPerturbationStepSize</a>();
        }
    }
  
  <span class="comment">// first calculate the temperatures for the radiation elements</span>
  <span class="comment">// this is done using the expression</span>
  <span class="comment">// T_rad^4 = 1/A * int_A (N^T Temp)^4 dA</span>
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_dof = 0;
  
  std::vector&lt;Point&gt; points;
  <span class="keywordtype">double</span> qp_value = 0.0, value = 0.0;
  std::vector&lt;unsigned int&gt; fe_node_ID_vec;
  
  std::auto_ptr&lt;QBase&gt; quadrature(<span class="keyword">new</span> QGauss(2,FIFTH));
  std::auto_ptr&lt;FEBase&gt; fe_rad(<span class="keyword">new</span> FE&lt;2, LAGRANGE&gt;(FEType()));
  std::auto_ptr&lt;FEBase&gt; global_fe(<span class="keyword">new</span> FE&lt;2,LAGRANGE&gt;(FEType()));
  
  fe_rad-&gt;attach_quadrature_rule(quadrature.get());
  
  <a class="code" href="_radiation_cavity_8h.html#a95a54ed90e810eea01d0a99c2d9fdfe4">RadiationElemConstIterator</a> elem_it, elem_end;
  elem_it = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ad15a5dc4fe14dd62ba4f938a708a5aa6">getElemBeginIterator</a>(DV_ID);
  elem_end = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a7d3dc9abc5b0e6c43d35fc186276f1ab">getElemEndIterator</a>(DV_ID);
  
  
  <span class="keywordflow">for</span> (; elem_it != elem_end; elem_it++)
    {
      elem_dof = (*elem_it)-&gt;ID();
      
      fe_node_ID_vec.clear();
      
      <span class="comment">// get the vector of internal node IDs</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ae94eed3036f1184da73c8b95d4a034ba">getInternalNodeIDForRadElem</a>
      (elem_dof, fe_node_ID_vec);
      
      <span class="comment">// get the local elem and the nodes in the local coordinates</span>
      Elem* local_rad_elem = 
      (*elem_it)-&gt;getLocalRadiationGeometricElem();
      <span class="keyword">const</span> std::vector&lt;Node*&gt; local_nodes = 
      (*elem_it)-&gt;getLocalCoordinateNodes();
      
      fe_rad-&gt;reinit(local_rad_elem);
      
      <span class="comment">// now obtain the value of the shape function for </span>
      <span class="comment">// the associated FE</span>
      <span class="keyword">const</span> std::vector&lt;std::vector&lt;Real&gt; &gt;&amp; phi_rad = fe_rad-&gt;get_phi();
      <span class="keyword">const</span> std::vector&lt;Real&gt;&amp; JxW_rad = fe_rad-&gt;get_JxW();
      
      points.clear();
      
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp = 0; qp &lt; phi_rad[0].size(); qp++)
        {
          Point pt;
          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; phi_rad.size(); i++)
            {
              Node&amp; node = *(local_nodes[i]);
              pt(0) += phi_rad[i][qp] * node(0);
              pt(1) += phi_rad[i][qp] * node(1);
            }
          points.push_back(pt);
        }
      
      <span class="comment">// next, get the values of the shape function for the global </span>
      <span class="comment">// FE at the quad points for the local rad elem</span>
      global_fe-&gt;reinit(local_rad_elem, &amp;points);
      <span class="keyword">const</span> std::vector&lt;std::vector&lt;Real&gt; &gt;&amp; phi_global = global_fe-&gt;get_phi();
      
      <span class="comment">// now, calculate the G_vector</span>
      value = 0.0;
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp=0; qp &lt; JxW_rad.size(); qp++)
        {
          qp_value = 0.0;
          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; phi_global.size(); i++)
            qp_value += phi_global[i][qp] * 
            (nodal_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e">el</a>(fe_node_ID_vec[i]) + temp_abs);
          
          value += pow(qp_value,4) * JxW_rad[qp];
        }
      
      rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a9fe9c425efb52cefc5b552cdf3295328">set</a>(elem_dof, value / (*elem_it)-&gt;getArea());
    }
  
  <span class="keywordflow">if</span> (reduce_power_by_four)
    rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a78a2fdc3d899fdde5c43a8d6133ccd83" title="raises each element of the vector by the given power">power</a>(0.25);
  
  <span class="keywordflow">if</span> (sensitivity) <span class="comment">// shape sensitivity is calculated using finite differences</span>
    {
      <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> rad_temp_vector_base(n_elems);
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aef377bb5ffe6811cf1c27448ddfc0365">calculateRadElemTempVector</a>(&amp;rad_temp_vector_base, 
                                       nodal_temp_vector,
                                       reduce_power_by_four,
                                       <span class="keyword">false</span>);
      rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a8d29fa33d3f981456e6bfa26a1fac17f">add</a>(-1.0, rad_temp_vector_base);
      rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a67cddf9b9ceb614362da1519af23b3d3">scale</a>(1.0/perturbation);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_aef377bb5ffe6811cf1c27448ddfc0365_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_aef377bb5ffe6811cf1c27448ddfc0365_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_aef377bb5ffe6811cf1c27448ddfc0365_cgraph" id="class_radiation_cavity_analysis_aef377bb5ffe6811cf1c27448ddfc0365_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a8d29fa33d3f981456e6bfa26a1fac17f" title="FESystemNumerics::PetscVectorBase::add" alt="" coords="448,30,726,58"/><area shape="rect" id="node9" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e" title="FESystemNumerics::PetscVectorBase::el" alt="" coords="454,82,720,110"/><area shape="rect" id="node11" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7" title="DesignData::DesignParameter::getID" alt="" coords="466,134,707,162"/><area shape="rect" id="node13" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702" title="DesignData::DesignParameter::getParameterTypeEnumID" alt="" coords="403,186,770,214"/><area shape="rect" id="node15" href="class_design_data_1_1_design_parameter.html#a0eb8202d84916cb7562fa2429e3bf7f8" title="DesignData::DesignParameter::getPerturbationStepSize" alt="" coords="410,238,764,266"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a78a2fdc3d899fdde5c43a8d6133ccd83" title="raises each element of the vector by the given power" alt="" coords="441,290,733,318"/><area shape="rect" id="node19" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions" alt="" coords="444,342,729,370"/><area shape="rect" id="node21" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a67cddf9b9ceb614362da1519af23b3d3" title="FESystemNumerics::PetscVectorBase::scale" alt="" coords="443,394,730,422"/><area shape="rect" id="node23" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a9fe9c425efb52cefc5b552cdf3295328" title="FESystemNumerics::PetscVectorBase::set" alt="" coords="450,446,723,474"/><area shape="rect" id="node25" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac" title="FESystemNumerics::PetscVectorBase::size" alt="" coords="447,498,726,526"/><area shape="rect" id="node27" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="446,550,727,578"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="819,5,1149,33"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="836,57,1132,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3a2849b2e8421de972e93744f335e757"></a><!-- doxytag: member="RadiationCavityAnalysis::calculateShapeFactorMatrix" ref="a3a2849b2e8421de972e93744f335e757" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; *matrix_ptr, const bool sensitivity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a3a2849b2e8421de972e93744f335e757">RadiationCavityAnalysis::calculateShapeFactorMatrix</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>sensitivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates the shape factor matrix </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">matrix_ptr</td><td>pointer to matrix where the calculated matrix is stored </td></tr>
    <tr><td class="paramname">DV</td><td>pointer to the design variable for sensitivity. (should NULL if no sensitivity is needed) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">316</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_petsc_matrix_base_8h_source.html#l00897">FESystemNumerics::PetscMatrixBase&lt; T &gt;::add()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00156">RadiationElementPair::clear()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00063">F_MATRIX</a>, <a class="el" href="_design_parameter_8h_source.html#l00109">DesignData::DesignParameter::getID()</a>, <a class="el" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">DesignData::DesignParameter::getParameterTypeEnumID()</a>, <a class="el" href="_design_parameter_8h_source.html#l00146">DesignData::DesignParameter::getPerturbationStepSize()</a>, <a class="el" href="_radiation_element_pair_8_c_source.html#l00107">RadiationElementPair::getShapeFactor()</a>, <a class="el" href="_radiation_element_8h_source.html#l00161">RadiationElement::ID()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">FESystemNumerics::PetscMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00037">RadiationElementPair::MITALAS_CONTOUR_INT</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">FESystemNumerics::PetscMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="_radiation_element_pair_8h_source.html#l00104">RadiationElementPair::reinit()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00114">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01043">FESystemNumerics::PetscMatrixBase&lt; T &gt;::scale()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00425">FESystemNumerics::PetscMatrixBase&lt; T &gt;::set()</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">FESystemNumerics::PetscMatrixBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">calculateQty()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateShapeFactorMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>&amp; matrix = *(matrix_ptr);
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  <span class="keywordflow">if</span> (matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() != n_elems || matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>() != n_elems)
    matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions">resize</a>(n_elems, n_elems);
  matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c">zero</a>();
  
  <span class="comment">// for shape design variable, the shape factor matrix will be calculated for </span>
  <span class="comment">// the perturbed mesh. The base shape factor matrix, is then retrived and the </span>
  <span class="comment">// sensitivity is then calculated</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> DV_ID = 0;
  <span class="keywordtype">double</span> perturbation = 0.0;
  <span class="keywordflow">if</span> (sensitivity)
    {
      <span class="comment">// for a Property DV, the sensitivity of this quantity is zero</span>
      <span class="keyword">const</span> <a class="code" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters.">DesignData::DesignParameter</a>&amp; dparam = 
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>();
      <span class="keywordflow">if</span> (dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">getParameterTypeEnumID</a>() == DesignData::PROPERTY_PARAMETER::num())
        <span class="keywordflow">return</span>;
      <span class="keywordflow">else</span> 
        {
          DV_ID = dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7">getID</a>();
          perturbation = dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#a0eb8202d84916cb7562fa2429e3bf7f8">getPerturbationStepSize</a>();
        }
    }
  
  <span class="comment">// get the iterators to the elements of the radiation mesh</span>
  <a class="code" href="_radiation_cavity_8h.html#a95a54ed90e810eea01d0a99c2d9fdfe4">RadiationElemConstIterator</a> elem_it, elem_end, nested_elem_it;
  elem_it = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ad15a5dc4fe14dd62ba4f938a708a5aa6">getElemBeginIterator</a>(DV_ID);
  elem_end = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a7d3dc9abc5b0e6c43d35fc186276f1ab">getElemEndIterator</a>(DV_ID);
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dof_elem1 =0, dof_elem2 = 0;
  <a class="code" href="class_radiation_element.html">RadiationElement</a> *rad_elem1 = NULL, *rad_elem2 = NULL;
  <a class="code" href="class_radiation_element_pair.html">RadiationElementPair</a> elem_pair;
  
  <span class="comment">// do a nested iteration on the elements</span>
  <span class="keywordflow">for</span> ( ; elem_it != elem_end; elem_it++)
    {
      rad_elem1 = *elem_it;
      
      dof_elem1 = rad_elem1-&gt;<a class="code" href="class_radiation_element.html#a447d88c256c0428c9d7750f9d6a2efb2" title="ID of the elem.">ID</a>();
      
      <span class="comment">// inside the loop, create a pair of the two elements for which shape</span>
      <span class="comment">// factor calculations will have to be performed</span>
      nested_elem_it = elem_it;
      nested_elem_it++;
      
      <span class="keywordflow">for</span> (; nested_elem_it != elem_end; nested_elem_it++)
        {
          <span class="comment">// create an element pair for the two elements, and calculate the shape factor</span>
          rad_elem2 = *nested_elem_it;
          
          dof_elem2 = rad_elem2-&gt;ID();
          
          elem_pair.<a class="code" href="class_radiation_element_pair.html#ac2c50e1d3bcc6f8086469389a56bb229" title="initializes the pair with two elements">reinit</a>(rad_elem1, rad_elem2);
<span class="preprocessor">#ifdef WITH_MATHEMATICA</span>
<span class="preprocessor"></span>          elem_pair.setMathLink(FESystem::mathlink_link);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>          
          <span class="comment">// get the shape factors from this element pair, and set the appropriate </span>
          <span class="comment">// matrix elements in the shape factor matrix. note that both f12 and f21 </span>
          <span class="comment">// need to be obtained.</span>
          std::pair&lt;double, double&gt; shape_factors = 
          elem_pair.<a class="code" href="class_radiation_element_pair.html#a82194ce5777e2ca4e4824bcf64a62496">getShapeFactor</a>(<a class="code" href="class_radiation_element_pair.html#ad8dffe6ca48b084fb7f88fff36dc532da62bd790cf2af06cb857619412c85d39e">RadiationElementPair::MITALAS_CONTOUR_INT</a>);
          
          <span class="comment">// next, insert the two shape factors into the shape factor matrix</span>
          matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38">set</a>(dof_elem1, dof_elem2, shape_factors.first);
          matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38">set</a>(dof_elem2, dof_elem1, shape_factors.second);
          
          <span class="comment">// clear the radiation element pair initialization</span>
          elem_pair.<a class="code" href="class_radiation_element_pair.html#ae297673eb5565ceba91e952b2db04dec" title="clears the initialization">clear</a>();
        }
    }
  
  <span class="keywordflow">if</span> (sensitivity) <span class="comment">// implies shape sensitivity is being sought</span>
    {
      <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> matrix_base(n_elems, n_elems);
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(matrix_base,
                              <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">RadiationCavityAnalysis::F_MATRIX</a>);
      matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa">add</a>(-1.0, matrix_base, <span class="keyword">true</span>);
      matrix.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b">scale</a>(1.0/perturbation);
    }
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::calculateShapeFactorMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a3a2849b2e8421de972e93744f335e757_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a3a2849b2e8421de972e93744f335e757_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a3a2849b2e8421de972e93744f335e757_cgraph" id="class_radiation_cavity_analysis_a3a2849b2e8421de972e93744f335e757_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa" title="FESystemNumerics::PetscMatrixBase::add" alt="" coords="438,30,714,58"/><area shape="rect" id="node9" href="class_radiation_element_pair.html#ae297673eb5565ceba91e952b2db04dec" title="clears the initialization" alt="" coords="483,82,669,110"/><area shape="rect" id="node11" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7" title="DesignData::DesignParameter::getID" alt="" coords="455,134,697,162"/><area shape="rect" id="node13" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702" title="DesignData::DesignParameter::getParameterTypeEnumID" alt="" coords="392,186,760,214"/><area shape="rect" id="node15" href="class_design_data_1_1_design_parameter.html#a0eb8202d84916cb7562fa2429e3bf7f8" title="DesignData::DesignParameter::getPerturbationStepSize" alt="" coords="399,238,753,266"/><area shape="rect" id="node17" href="class_radiation_element_pair.html#a82194ce5777e2ca4e4824bcf64a62496" title="RadiationElementPair::getShapeFactor" alt="" coords="450,290,702,318"/><area shape="rect" id="node64" href="class_radiation_element.html#a447d88c256c0428c9d7750f9d6a2efb2" title="ID of the elem." alt="" coords="502,394,650,422"/><area shape="rect" id="node66" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="443,446,709,474"/><area shape="rect" id="node68" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="445,498,707,526"/><area shape="rect" id="node70" href="class_radiation_element_pair.html#ac2c50e1d3bcc6f8086469389a56bb229" title="initializes the pair with two elements" alt="" coords="884,394,1071,422"/><area shape="rect" id="node76" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions" alt="" coords="415,550,737,578"/><area shape="rect" id="node78" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b" title="FESystemNumerics::PetscMatrixBase::scale" alt="" coords="433,602,719,630"/><area shape="rect" id="node80" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38" title="FESystemNumerics::PetscMatrixBase::set" alt="" coords="440,654,712,682"/><area shape="rect" id="node82" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="436,706,716,734"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91" title="FESystemNumerics::MatrixBase::getMatrixPackage" alt="" coords="814,5,1141,33"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="830,57,1125,85"/><area shape="rect" id="node19" href="class_radiation_element_pair.html#afdcdeea5237500b0f052d7f110d1a668" title="calculates and returns the double area integration shape factor" alt="" coords="819,290,1136,318"/><area shape="rect" id="node36" href="class_radiation_element_pair.html#aeda975a49693c4717d650ebbcfc455c0" title="calculates and returns the analytic shape factor" alt="" coords="838,238,1117,266"/><area shape="rect" id="node43" href="class_radiation_element_pair.html#a4e95598570357c97da61af3748c63724" title="calculates and returns the contour integration shape factor" alt="" coords="831,342,1124,370"/><area shape="rect" id="node56" href="class_radiation_element_pair.html#a7364ef6efb17a95f4a5e42192edc8d9d" title="calculates and returns the shape factors using mitalas&#39; method of intgration" alt="" coords="808,186,1147,214"/><area shape="rect" id="node21" href="class_radiation_element.html#ab314e67b810b03dca3a27ecc83788f9d" title="this function gets the geom elem for the radiation elem" alt="" coords="1211,367,1512,395"/><area shape="rect" id="node27" href="class_radiation_element.html#ab40d8a0c29577f96165f5adf8113a15e" title="returns the surface normal for this element" alt="" coords="1241,263,1482,291"/><area shape="rect" id="node30" href="class_radiation_element.html#a7e94cd8e52f1c0744a35a8d0c99ad637" title="returns the local radiation element" alt="" coords="1195,315,1528,343"/><area shape="rect" id="node33" href="class_radiation_element.html#a0bf19bc55f941930fc88dc744ae6e7dd" title="returns the area for this element" alt="" coords="1271,211,1452,239"/><area shape="rect" id="node23" href="class_radiation_element.html#a6d2ab9caa8a639051ddcff42e2a8967f" title="init this object" alt="" coords="1576,290,1728,318"/><area shape="rect" id="node25" href="class_radiation_element.html#af283e728f86eea3d9dcdc15e4a513999" title="method to init the local radiation element in its own coordinates" alt="" coords="1776,290,2064,318"/><area shape="rect" id="node39" href="class_radiation_element.html#ada5a7265983fb39e0ce10eebeeea8aca" title="face ID for the finite element" alt="" coords="1241,159,1482,187"/><area shape="rect" id="node47" href="_contour_integration_8h.html#a30908586f46b5340e5287573d1ad50d4" title="EdgeFactor" alt="" coords="1316,419,1406,447"/><area shape="rect" id="node49" href="_contour_integration_8h.html#ad84e65074db2b5ea6d44efce76c3a679" title="F1" alt="" coords="1633,419,1671,447"/><area shape="rect" id="node51" href="_contour_integration_8h.html#acbcd2ccad2ab5d4231a258dcb2a81f2a" title="F2" alt="" coords="1633,471,1671,499"/><area shape="rect" id="node53" href="_contour_integration_8h.html#ae6f7aa8b9240a7cc1092283a5cf61f75" title="F3" alt="" coords="1633,367,1671,395"/><area shape="rect" id="node60" href="_mitalas_integration_8h.html#a9ef658341de25246820d0aaf0771337e" title="MitalasEdgeFactor" alt="" coords="1295,107,1428,135"/><area shape="rect" id="node74" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to." alt="" coords="1255,471,1467,499"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6f756b8d67e57b6d605c102fb3209e97"></a><!-- doxytag: member="RadiationCavityAnalysis::checkIfTemperatureDependent" ref="a6f756b8d67e57b6d605c102fb3209e97" args="(RadiationQty quantity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_radiation_cavity_analysis.html#a6f756b8d67e57b6d605c102fb3209e97">RadiationCavityAnalysis::checkIfTemperatureDependent</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationQty</a>&#160;</td>
          <td class="paramname"><em>quantity</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>true if the quantity is temperature dependent in case of temperature dependent properties. </dd></dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01746">1746</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00066">A_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00065">A_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00067">A_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00074">AB_INV_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00070">B_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00068">B_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00069">B_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00063">F_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00064">F_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00073">FACTOR_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00071">G_MATRIX</a>, and <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00072">G_MATRIX_SENSITIVITY</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00111">getMatrixQuantity()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">switch</span> (quantity)
  {
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">RadiationCavityAnalysis::F_MATRIX</a>:
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a01aacfc6d2b8119467903e4413350d70">RadiationCavityAnalysis::F_MATRIX_SENSITIVITY</a>:
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">RadiationCavityAnalysis::A_MATRIX</a>:
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9afc5da26c57bb9e45d36e0b65db2e061b">RadiationCavityAnalysis::A_MATRIX_SENSITIVITY</a>:
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ae8bc4b7f41e205e9e6fe14a31a551ef0">RadiationCavityAnalysis::A_INVERSE_MATRIX</a>:
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">RadiationCavityAnalysis::G_MATRIX</a>:
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ab3e00964c9ce893d80049b2b2daf4967">RadiationCavityAnalysis::G_MATRIX_SENSITIVITY</a>:
      <span class="keywordflow">return</span> <span class="keyword">false</span>;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9abe6a1b3373498e2afa348361975f9ee9">RadiationCavityAnalysis::B_MATRIX</a>:
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aa8e253c18366682e146778d7d9c6d09e">RadiationCavityAnalysis::B_MATRIX_SENSITIVITY</a>:
      <span class="keywordflow">return</span> <span class="keyword">true</span>;
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795">RadiationCavityAnalysis::B_INVERSE_MATRIX</a>:
      <span class="keywordflow">return</span> <span class="keyword">true</span>;
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998">RadiationCavityAnalysis::FACTOR_MATRIX</a>:
      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// false, since it is now defined only for temperature independent cases</span>
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0">RadiationCavityAnalysis::AB_INV_MATRIX</a>:
      <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// this is defined only for temperature dependent cases</span>
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      abort();
      <span class="keywordflow">break</span>;
  }
  
  <span class="comment">// should never get here.</span>
  Assert(<span class="keyword">false</span>, ExcInternalError());
  <span class="keywordflow">return</span> <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af707b1f733c9f12a5d791d18c74efc47"></a><!-- doxytag: member="RadiationCavityAnalysis::clearPropertyCardInitialization" ref="af707b1f733c9f12a5d791d18c74efc47" args="(ElemDataCard &amp;elem_data_card)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#af707b1f733c9f12a5d791d18c74efc47">RadiationCavityAnalysis::clearPropertyCardInitialization</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_elem_data_card.html">ElemDataCard</a> &amp;&#160;</td>
          <td class="paramname"><em>elem_data_card</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>clears the property card initialization </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l02126">2126</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_analysis_discipline_base_8h_source.html#l00666">Discipline::AnalysisDisciplineBase::checkPropertyDependenceOnTemperature()</a>, <a class="el" href="class_elem_data_card.html#ab50a2a6c9317349ae278ad3859c103b5">ElemDataCard::partialClearElemAndMaterialCardLocalParameterInitialization()</a>, and <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00236">thermal_discipline</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">calculateB_Matrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> std::vector&lt;unsigned int&gt; param_vec;
  <span class="keyword">static</span> std::vector&lt;unsigned int&gt; no_param_vec;
  
  <span class="keywordflow">if</span> (param_vec.size() == 0)
    param_vec.push_back(Property::TEMPERATURE::num());
  
  <span class="comment">// if the properties are temperature dependent, then initialize the</span>
  <span class="comment">// element property cards at the element average temperature</span>
  <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    elem_data_card.<a class="code" href="class_elem_data_card.html#ab50a2a6c9317349ae278ad3859c103b5">partialClearElemAndMaterialCardLocalParameterInitialization</a>
    (param_vec);
  <span class="keywordflow">else</span>
    elem_data_card.<a class="code" href="class_elem_data_card.html#ab50a2a6c9317349ae278ad3859c103b5">partialClearElemAndMaterialCardLocalParameterInitialization</a>
    (no_param_vec);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_af707b1f733c9f12a5d791d18c74efc47_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_af707b1f733c9f12a5d791d18c74efc47_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_af707b1f733c9f12a5d791d18c74efc47_cgraph" id="class_radiation_cavity_analysis_af707b1f733c9f12a5d791d18c74efc47_cgraph">
<area shape="rect" id="node3" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature" alt="" coords="403,5,887,33"/><area shape="rect" id="node5" href="class_elem_data_card.html#ab50a2a6c9317349ae278ad3859c103b5" title="ElemDataCard::partialClearElemAndMaterialCardLocalParameterInitialization" alt="" coords="406,57,885,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a84a9916a1b0228f22ffe72f5b035396b"></a><!-- doxytag: member="RadiationCavityAnalysis::getBaseEpsilonVector" ref="a84a9916a1b0228f22ffe72f5b035396b" args="(FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;vec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a84a9916a1b0228f22ffe72f5b035396b">RadiationCavityAnalysis::getBaseEpsilonVector</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>only retrieves the base epsilon vector stored in the database. This method does not make sure that the calculated quantity is current. Hence, it should be ensured in the appropriate context </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00981">981</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_data_info_8_c_source.html#l00169">FESystemDatabase::GenericDataInfoBase::setDisciplineEnumID()</a>, <a class="el" href="_data_info_8_c_source.html#l00087">FESystemDatabase::GenericDataInfoBase::setLoadCase()</a>, and <a class="el" href="_data_info_8_c_source.html#l00136">FESystemDatabase::GenericDataInfoBase::setName()</a>.</p>
<div class="fragment"><pre class="fragment">{
  std::string name;
  std::ostringstream cavity_id;
  cavity_id &lt;&lt; this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#aa7fc38a25e02d4d38d20c16720124ef4" title="returns the cavity ID">getCavityID</a>();
  
  name.clear(); 
  name = <span class="stringliteral">&quot;BaseEpsilonVector&quot;</span>;
  name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
  name += cavity_id.str();
  
  <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a> time_independent_data_info;
  time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID">setDisciplineEnumID</a>(Discipline::RADIATION_DISCIPLINE::num());
  time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent">setLoadCase</a>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().
                                         getCurrentLoadCase());
  time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity">setName</a>(name);
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a61c6211b1a2e6518ac9e357e385fad2b" title="stores global matrices and vectors">global_data_storage</a>-&gt;fillVector(time_independent_data_info,
                                                            vec);  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a84a9916a1b0228f22ffe72f5b035396b_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a84a9916a1b0228f22ffe72f5b035396b_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a84a9916a1b0228f22ffe72f5b035396b_cgraph" id="class_radiation_cavity_analysis_a84a9916a1b0228f22ffe72f5b035396b_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID" alt="" coords="357,5,763,33"/><area shape="rect" id="node5" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent" alt="" coords="380,57,740,85"/><area shape="rect" id="node7" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity" alt="" coords="392,109,728,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a15c6ef55ace32a38f7b37339187abc95"></a><!-- doxytag: member="RadiationCavityAnalysis::getDataInfoForQty" ref="a15c6ef55ace32a38f7b37339187abc95" args="(RadiationQty qty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::auto_ptr&lt; <a class="el" href="class_f_e_system_database_1_1_data_info_base.html">FESystemDatabase::DataInfoBase</a> &gt; <a class="el" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95">RadiationCavityAnalysis::getDataInfoForQty</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationQty</a>&#160;</td>
          <td class="paramname"><em>qty</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>a DataInfoBase object for the given quantity, for the current analysis in progress. The object will point to the current time iteration for a transient analysis, and the current DV for a sensitivity quantity </dd></dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01799">1799</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00066">A_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00065">A_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00067">A_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00074">AB_INV_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00070">B_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00068">B_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00069">B_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00063">F_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00064">F_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00073">FACTOR_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00071">G_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00072">G_MATRIX_SENSITIVITY</a>, <a class="el" href="_analysis_discipline_base_8h_source.html#l00505">Discipline::AnalysisDisciplineBase::getAnalysisDriver()</a>, <a class="el" href="_radiation_cavity_8h_source.html#l00204">RadiationCavity::getCavityID()</a>, <a class="el" href="_transient_analysis_driver_8_c_source.html#l00066">Driver::TransientAnalysisDriver::getCurrentAnalysisTime()</a>, <a class="el" href="_analysis_driver_8h_source.html#l00647">Driver::AnalysisDriver::getCurrentDesignParameter()</a>, <a class="el" href="_transient_analysis_driver_8_c_source.html#l00081">Driver::TransientAnalysisDriver::getCurrentIterationNumber()</a>, <a class="el" href="_analysis_driver_8h_source.html#l00637">Driver::AnalysisDriver::getCurrentLoadCase()</a>, <a class="el" href="class_solution_1_1_solution_base.html#a73528968dadb7365a70b0503032ef7c6">Solution::SolutionBase::getDisciplineTransientNatureEnumID()</a>, <a class="el" href="_design_parameter_8h_source.html#l00109">DesignData::DesignParameter::getID()</a>, <a class="el" href="_analysis_discipline_base_8_c_source.html#l00164">Discipline::AnalysisDisciplineBase::getSolution()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00239">radiation_cavity</a>, <a class="el" href="_data_info_8_c_source.html#l00136">FESystemDatabase::GenericDataInfoBase::setName()</a>, <a class="el" href="_analysis_discipline_base_8h_source.html#l00111">STEADY_STATE_SOLUTION_ENUM_ID</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00236">thermal_discipline</a>, and <a class="el" href="_analysis_discipline_base_8h_source.html#l00124">TRANSIENT_SOLUTION_ENUM_ID</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00111">getMatrixQuantity()</a>.</p>
<div class="fragment"><pre class="fragment">{
  std::auto_ptr&lt;FESystemDatabase::DataInfoBase&gt; data_info(NULL);
  std::ostringstream rad_num;
  rad_num &lt;&lt; this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#aa7fc38a25e02d4d38d20c16720124ef4" title="returns the cavity ID">getCavityID</a>();
  std::string name;
  
  <span class="keywordflow">switch</span> (quantity)
  {
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">RadiationCavityAnalysis::F_MATRIX</a>:
    {
      name = <span class="stringliteral">&quot;F_matrix&quot;</span>;
      name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
      name += rad_num.str();
      name += <span class="stringliteral">&quot;_&quot;</span>;
      data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a>);
      data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
      data_info-&gt;setName(name);
    }
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a01aacfc6d2b8119467903e4413350d70">RadiationCavityAnalysis::F_MATRIX_SENSITIVITY</a>:
    {
      data_info.reset(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95">getDataInfoForQty</a>(<a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a710db01b9ba0d3806327e466cf5b6607">RadiationCavityAnalysis::F_MATRIX</a>).release());
      data_info-&gt;setDVID(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>().<a class="code" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7">getID</a>());
    }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">RadiationCavityAnalysis::A_MATRIX</a>:
    {
      name = <span class="stringliteral">&quot;A_matrix&quot;</span>;
      name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
      name += rad_num.str();
      name += <span class="stringliteral">&quot;_&quot;</span>;
      data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a>);
      data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
      data_info-&gt;setName(name);
    }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ae8bc4b7f41e205e9e6fe14a31a551ef0">RadiationCavityAnalysis::A_INVERSE_MATRIX</a>:
    {
      name = <span class="stringliteral">&quot;A_Inverse_matrix&quot;</span>;
      name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
      name += rad_num.str();
      name += <span class="stringliteral">&quot;_&quot;</span>;
      data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a>);
      data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
      data_info-&gt;setName(name);
    }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9afc5da26c57bb9e45d36e0b65db2e061b">RadiationCavityAnalysis::A_MATRIX_SENSITIVITY</a>:
    {
      data_info.reset(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95">getDataInfoForQty</a>(<a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">RadiationCavityAnalysis::A_MATRIX</a>).release());
      data_info-&gt;setDVID(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>().<a class="code" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7">getID</a>());
    }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">RadiationCavityAnalysis::G_MATRIX</a>:
    {
      name = <span class="stringliteral">&quot;G_matrix&quot;</span>;
      name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
      name += rad_num.str();
      name += <span class="stringliteral">&quot;_&quot;</span>;
      data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a>);
      data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
      data_info-&gt;setName(name);
    }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ab3e00964c9ce893d80049b2b2daf4967">RadiationCavityAnalysis::G_MATRIX_SENSITIVITY</a>:
    {
      data_info.reset(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95">getDataInfoForQty</a>(<a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">RadiationCavityAnalysis::G_MATRIX</a>).release());
      data_info-&gt;setDVID(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>().<a class="code" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7">getID</a>());
    }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9abe6a1b3373498e2afa348361975f9ee9">RadiationCavityAnalysis::B_MATRIX</a>:
    {
      <span class="keywordflow">switch</span>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#aaa6666781d3c78e003c9f8002aaeff16">getSolution</a>().<a class="code" href="class_solution_1_1_solution_base.html#a73528968dadb7365a70b0503032ef7c6">getDisciplineTransientNatureEnumID</a>
             (Discipline::THERMAL_DISCIPLINE::num()))
      {
        <span class="keywordflow">case</span> <a class="code" href="_analysis_discipline_base_8h.html#ace90dda1960bb960e206bd0dbcc0c977">STEADY_STATE_SOLUTION_ENUM_ID</a>:
        {
          name = <span class="stringliteral">&quot;B_matrix&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += rad_num.str();
          name += <span class="stringliteral">&quot;_&quot;</span>;
          data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a>);
          data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
          data_info-&gt;setLoadCase(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().
                                 getCurrentLoadCase());
          data_info-&gt;setName(name);
        }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">case</span> <a class="code" href="_analysis_discipline_base_8h.html#a742dfba20e2381d7d5389fc91a94c740">TRANSIENT_SOLUTION_ENUM_ID</a>:
        {
          name = <span class="stringliteral">&quot;B_matrix&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += rad_num.str();
          name += <span class="stringliteral">&quot;_&quot;</span>;
          <a class="code" href="class_driver_1_1_transient_analysis_driver.html" title="this forms the basis of all transient analysis drivers.">Driver::TransientAnalysisDriver</a>&amp; transient_driver = 
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_driver_1_1_transient_analysis_driver.html" title="this forms the basis of all transient analysis drivers.">Driver::TransientAnalysisDriver</a>&amp;<span class="keyword">&gt;</span>
          (this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>());
          
          data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>);
          data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
          data_info-&gt;setLoadCase(transient_driver.<a class="code" href="class_driver_1_1_analysis_driver.html#ad9f4c9e39727b9b9ba9fcbe7353e9c7f" title="returns the current load case number">getCurrentLoadCase</a>());
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>*<span class="keyword">&gt;</span>
          (data_info.get())-&gt;setTransientIterationInfo(transient_driver.<a class="code" href="class_driver_1_1_transient_analysis_driver.html#ab9622f4ee33604c4d864d63f8cc93ef6">getCurrentIterationNumber</a>(),
                                                       transient_driver.<a class="code" href="class_driver_1_1_transient_analysis_driver.html#aeb9ad9e6f71bacc09f168141428af9d5">getCurrentAnalysisTime</a>());
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>*<span class="keyword">&gt;</span>(data_info.get())-&gt;setOrder(0);
          data_info-&gt;<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity">setName</a>(name);
        }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">default</span>:
          Assert(<span class="keyword">false</span>, ExcInternalError());
          <span class="keywordflow">break</span>;
      }
    }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aa8e253c18366682e146778d7d9c6d09e">RadiationCavityAnalysis::B_MATRIX_SENSITIVITY</a>:
    {
      data_info.reset(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95">getDataInfoForQty</a>(<a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9abe6a1b3373498e2afa348361975f9ee9">RadiationCavityAnalysis::B_MATRIX</a>).release());
      data_info-&gt;setDVID(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>().<a class="code" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7">getID</a>());
    }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795">RadiationCavityAnalysis::B_INVERSE_MATRIX</a>:
    {
      <span class="keywordflow">switch</span>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#aaa6666781d3c78e003c9f8002aaeff16">getSolution</a>().<a class="code" href="class_solution_1_1_solution_base.html#a73528968dadb7365a70b0503032ef7c6">getDisciplineTransientNatureEnumID</a>
             (Discipline::THERMAL_DISCIPLINE::num()))
      {
        <span class="keywordflow">case</span> <a class="code" href="_analysis_discipline_base_8h.html#ace90dda1960bb960e206bd0dbcc0c977">STEADY_STATE_SOLUTION_ENUM_ID</a>:
        {
          name = <span class="stringliteral">&quot;B_Inverse_Matrix&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += rad_num.str();
          name += <span class="stringliteral">&quot;_&quot;</span>;
          data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a>);
          data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
          data_info-&gt;setLoadCase(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().
                                 getCurrentLoadCase());
          data_info-&gt;setName(name);
        }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">case</span> <a class="code" href="_analysis_discipline_base_8h.html#a742dfba20e2381d7d5389fc91a94c740">TRANSIENT_SOLUTION_ENUM_ID</a>:
        {
          name = <span class="stringliteral">&quot;B_Inverse_Matrix&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += rad_num.str();
          name += <span class="stringliteral">&quot;_&quot;</span>;
          <a class="code" href="class_driver_1_1_transient_analysis_driver.html" title="this forms the basis of all transient analysis drivers.">Driver::TransientAnalysisDriver</a>&amp; transient_driver = 
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_driver_1_1_transient_analysis_driver.html" title="this forms the basis of all transient analysis drivers.">Driver::TransientAnalysisDriver</a>&amp;<span class="keyword">&gt;</span>
          (this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>());
          
          data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>);
          data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
          data_info-&gt;setLoadCase(transient_driver.<a class="code" href="class_driver_1_1_analysis_driver.html#ad9f4c9e39727b9b9ba9fcbe7353e9c7f" title="returns the current load case number">getCurrentLoadCase</a>());
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>*<span class="keyword">&gt;</span>
          (data_info.get())-&gt;setTransientIterationInfo(transient_driver.<a class="code" href="class_driver_1_1_transient_analysis_driver.html#ab9622f4ee33604c4d864d63f8cc93ef6">getCurrentIterationNumber</a>(),
                                                       transient_driver.<a class="code" href="class_driver_1_1_transient_analysis_driver.html#aeb9ad9e6f71bacc09f168141428af9d5">getCurrentAnalysisTime</a>());
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>*<span class="keyword">&gt;</span>(data_info.get())-&gt;setOrder(0);
          data_info-&gt;<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity">setName</a>(name);
        }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">default</span>:
          Assert(<span class="keyword">false</span>, ExcInternalError());
          <span class="keywordflow">break</span>;
      }
    }
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998">RadiationCavityAnalysis::FACTOR_MATRIX</a>:
    {
      <span class="keywordflow">switch</span>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#aaa6666781d3c78e003c9f8002aaeff16">getSolution</a>().<a class="code" href="class_solution_1_1_solution_base.html#a73528968dadb7365a70b0503032ef7c6">getDisciplineTransientNatureEnumID</a>
             (Discipline::THERMAL_DISCIPLINE::num()))
      {
        <span class="keywordflow">case</span> <a class="code" href="_analysis_discipline_base_8h.html#ace90dda1960bb960e206bd0dbcc0c977">STEADY_STATE_SOLUTION_ENUM_ID</a>:
        {
          name = <span class="stringliteral">&quot;Factor_matrix&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += rad_num.str();
          name += <span class="stringliteral">&quot;_&quot;</span>;
          data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a>);
          data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
          data_info-&gt;setLoadCase(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().
                                 getCurrentLoadCase());
          data_info-&gt;setName(name);
        }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">case</span> <a class="code" href="_analysis_discipline_base_8h.html#a742dfba20e2381d7d5389fc91a94c740">TRANSIENT_SOLUTION_ENUM_ID</a>:
        {
          <a class="code" href="class_driver_1_1_transient_analysis_driver.html" title="this forms the basis of all transient analysis drivers.">Driver::TransientAnalysisDriver</a>&amp; transient_driver = 
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_driver_1_1_transient_analysis_driver.html" title="this forms the basis of all transient analysis drivers.">Driver::TransientAnalysisDriver</a>&amp;<span class="keyword">&gt;</span>
          (this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>());
          
          name = <span class="stringliteral">&quot;Factor_matrix&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += rad_num.str();
          name += <span class="stringliteral">&quot;_&quot;</span>;
          data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>);
          data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
          data_info-&gt;setLoadCase(transient_driver.<a class="code" href="class_driver_1_1_analysis_driver.html#ad9f4c9e39727b9b9ba9fcbe7353e9c7f" title="returns the current load case number">getCurrentLoadCase</a>());
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>*<span class="keyword">&gt;</span>
          (data_info.get())-&gt;setTransientIterationInfo(transient_driver.<a class="code" href="class_driver_1_1_transient_analysis_driver.html#ab9622f4ee33604c4d864d63f8cc93ef6">getCurrentIterationNumber</a>(),
                                                       transient_driver.<a class="code" href="class_driver_1_1_transient_analysis_driver.html#aeb9ad9e6f71bacc09f168141428af9d5">getCurrentAnalysisTime</a>());
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>*<span class="keyword">&gt;</span>(data_info.get())-&gt;setOrder(0);
          data_info-&gt;<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity">setName</a>(name);
        }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">default</span>:
          Assert(<span class="keyword">false</span>, ExcInternalError());
          <span class="keywordflow">break</span>;
      }
    }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span>  <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0">RadiationCavityAnalysis::AB_INV_MATRIX</a>:
    {
      <span class="keywordflow">switch</span>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#aaa6666781d3c78e003c9f8002aaeff16">getSolution</a>().<a class="code" href="class_solution_1_1_solution_base.html#a73528968dadb7365a70b0503032ef7c6">getDisciplineTransientNatureEnumID</a>
             (Discipline::THERMAL_DISCIPLINE::num()))
      {
        <span class="keywordflow">case</span> <a class="code" href="_analysis_discipline_base_8h.html#ace90dda1960bb960e206bd0dbcc0c977">STEADY_STATE_SOLUTION_ENUM_ID</a>:
        {
          name = <span class="stringliteral">&quot;AB_Inv_matrix&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += rad_num.str();
          name += <span class="stringliteral">&quot;_&quot;</span>;
          data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a>);
          data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
          data_info-&gt;setLoadCase(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().
                                 getCurrentLoadCase());
          data_info-&gt;setName(name);
        }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">case</span> <a class="code" href="_analysis_discipline_base_8h.html#a742dfba20e2381d7d5389fc91a94c740">TRANSIENT_SOLUTION_ENUM_ID</a>:
        {
          <a class="code" href="class_driver_1_1_transient_analysis_driver.html" title="this forms the basis of all transient analysis drivers.">Driver::TransientAnalysisDriver</a>&amp; transient_driver = 
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_driver_1_1_transient_analysis_driver.html" title="this forms the basis of all transient analysis drivers.">Driver::TransientAnalysisDriver</a>&amp;<span class="keyword">&gt;</span>
          (this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>());
          
          name = <span class="stringliteral">&quot;AB_Inv_matrix&quot;</span>;
          name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
          name += rad_num.str();
          name += <span class="stringliteral">&quot;_&quot;</span>;
          data_info.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>);
          data_info-&gt;setDisciplineEnumID(Discipline::RADIATION_DISCIPLINE::num());
          data_info-&gt;setLoadCase(transient_driver.<a class="code" href="class_driver_1_1_analysis_driver.html#ad9f4c9e39727b9b9ba9fcbe7353e9c7f" title="returns the current load case number">getCurrentLoadCase</a>());
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>*<span class="keyword">&gt;</span>
          (data_info.get())-&gt;setTransientIterationInfo(transient_driver.<a class="code" href="class_driver_1_1_transient_analysis_driver.html#ab9622f4ee33604c4d864d63f8cc93ef6">getCurrentIterationNumber</a>(),
                                                       transient_driver.<a class="code" href="class_driver_1_1_transient_analysis_driver.html#aeb9ad9e6f71bacc09f168141428af9d5">getCurrentAnalysisTime</a>());
          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_database_1_1_time_dependent_data_info.html" title="this defines a time dependent quantity">FESystemDatabase::TimeDependentDataInfo</a>*<span class="keyword">&gt;</span>(data_info.get())-&gt;setOrder(0);
          data_info-&gt;<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity">setName</a>(name);
        }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">default</span>:
          Assert(<span class="keyword">false</span>, ExcInternalError());
          <span class="keywordflow">break</span>;
      }
    }
      <span class="keywordflow">break</span>;
      
      
    <span class="keywordflow">default</span>:
      Assert(<span class="keyword">false</span>, ExcInternalError());
      <span class="keywordflow">break</span>;
  }
  
  <span class="keywordflow">return</span> data_info;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a15c6ef55ace32a38f7b37339187abc95_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a15c6ef55ace32a38f7b37339187abc95_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a15c6ef55ace32a38f7b37339187abc95_cgraph" id="class_radiation_cavity_analysis_a15c6ef55ace32a38f7b37339187abc95_cgraph">
<area shape="rect" id="node3" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80" title="Discipline::AnalysisDisciplineBase::getAnalysisDriver" alt="" coords="360,5,694,33"/><area shape="rect" id="node5" href="class_radiation_cavity.html#aa7fc38a25e02d4d38d20c16720124ef4" title="returns the cavity ID" alt="" coords="431,57,622,85"/><area shape="rect" id="node7" href="class_driver_1_1_transient_analysis_driver.html#aeb9ad9e6f71bacc09f168141428af9d5" title="Driver::TransientAnalysisDriver::getCurrentAnalysisTime" alt="" coords="350,109,704,137"/><area shape="rect" id="node9" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable" alt="" coords="365,161,688,189"/><area shape="rect" id="node11" href="class_driver_1_1_transient_analysis_driver.html#ab9622f4ee33604c4d864d63f8cc93ef6" title="Driver::TransientAnalysisDriver::getCurrentIterationNumber" alt="" coords="341,213,712,241"/><area shape="rect" id="node13" href="class_driver_1_1_analysis_driver.html#ad9f4c9e39727b9b9ba9fcbe7353e9c7f" title="returns the current load case number" alt="" coords="386,265,667,293"/><area shape="rect" id="node15" href="class_solution_1_1_solution_base.html#a73528968dadb7365a70b0503032ef7c6" title="Solution::SolutionBase::getDisciplineTransientNatureEnumID" alt="" coords="336,317,718,345"/><area shape="rect" id="node17" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7" title="DesignData::DesignParameter::getID" alt="" coords="406,369,647,397"/><area shape="rect" id="node19" href="class_discipline_1_1_analysis_discipline_base.html#aaa6666781d3c78e003c9f8002aaeff16" title="Discipline::AnalysisDisciplineBase::getSolution" alt="" coords="378,421,675,449"/><area shape="rect" id="node21" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity" alt="" coords="359,473,694,501"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae155657b1fa03cee3b09bc02eea7c140"></a><!-- doxytag: member="RadiationCavityAnalysis::getFEJacobianMatrix" ref="ae155657b1fa03cee3b09bc02eea7c140" args="(FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;nodal_temp_val, FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; &amp;jacobian)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#ae155657b1fa03cee3b09bc02eea7c140">RadiationCavityAnalysis::getFEJacobianMatrix</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodal_temp_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>jacobian</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>method returns the FE jacobian matrix </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nodal_temp_val</td><td>value of the nodal temperature arranged in the same way as the dof vector obtrained from the method <a class="el" href="class_radiation_cavity_analysis.html#a38932efef014877857e9cd643b69bf73">getFENodalDofIDs()</a> </td></tr>
    <tr><td class="paramname">jacobian</td><td>the jacobian is returned in this </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01395">1395</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00066">A_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00074">AB_INV_MATRIX</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00422">FESystemNumerics::PetscVectorBase&lt; T &gt;::add()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00141">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::copy()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00187">FESystemNumerics::PetscVectorBase&lt; T &gt;::el()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00073">FACTOR_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00071">G_MATRIX</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00299">FESystemNumerics::PetscVectorBase&lt; T &gt;::invertValues()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00585">FESystemNumerics::PetscMatrixBase&lt; T &gt;::leftDiagonalScale()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00169">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::leftMultiply()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00213">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::leftMultiplyTranspose()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">FESystemNumerics::PetscMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">FESystemNumerics::PetscMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00379">FESystemNumerics::PetscVectorBase&lt; T &gt;::pointwiseMultiply()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00267">FESystemNumerics::PetscVectorBase&lt; T &gt;::power()</a>, <a class="el" href="_petsc_seq_vector_8h_source.html#l00093">FESystemNumerics::PetscSeqVector&lt; T &gt;::resize()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00511">FESystemNumerics::PetscVectorBase&lt; T &gt;::scale()</a>, <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae18d819dc1f95b6b8f157055b2d9c27c">FESystemNumerics::PetscMatrixBase&lt; T &gt;::setRow()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00408">FESystemNumerics::PetscVectorBase&lt; T &gt;::size()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">FESystemNumerics::PetscMatrixBase&lt; T &gt;::zero()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::getFEJacobianMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  <span class="comment">// first set the pointer to the nodal load vector</span>
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aca8fb869507838123c3e8d1e226e38cb" title="pointer to the FE nodal temperature vector for the analysis">fe_nodal_temp_vector</a> = &amp;(nodal_temp_val);
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> elem_dof = 0,
  n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>(),
  n_nodes = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a8018aadd0171d514477ada7314cbbc1b">getFENodes</a>().size();
  
  <span class="comment">// get the factor_matrix, multiply it with the nodal load vector and return </span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> factor_matrix(n_nodes, n_elems);
  
  assert (jacobian.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() == jacobian.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>());
  assert (jacobian.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() == factor_matrix.m());
  assert (jacobian.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() == nodal_temp_val.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac">size</a>());
  jacobian.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c">zero</a>();
  
  
  <span class="comment">// get the value of absolute temperature </span>
  <span class="keyword">const</span> <span class="keywordtype">double</span> temp_abs = 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#ae2f9f30b83db8a3cb69787c283708210" title="stores analysis details">analysis_case</a>-&gt;getRealParameter(<span class="stringliteral">&quot;ABSOLUTE_TEMP&quot;</span>);
  
  <span class="comment">// create some temporary set of values for the procedure below</span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> elem_temp_matrix(n_elems, n_nodes);
  elem_temp_matrix.zero();
  
  std::vector&lt;Point&gt; points;
  <span class="keywordtype">double</span> qp_value = 0.0;
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> value;
  std::vector&lt;unsigned int&gt; fe_node_ID_vec;
  
  std::auto_ptr&lt;QBase&gt; quadrature(<span class="keyword">new</span> QGauss(2,FIFTH));
  std::auto_ptr&lt;FEBase&gt; fe_rad(<span class="keyword">new</span> FE&lt;2, LAGRANGE&gt;(FEType()));
  std::auto_ptr&lt;FEBase&gt; global_fe(<span class="keyword">new</span> FE&lt;2,LAGRANGE&gt;(FEType()));
  
  fe_rad-&gt;attach_quadrature_rule(quadrature.get());
  
  <a class="code" href="_radiation_cavity_8h.html#a95a54ed90e810eea01d0a99c2d9fdfe4">RadiationElemConstIterator</a> elem_it, elem_end;
  elem_it = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ad15a5dc4fe14dd62ba4f938a708a5aa6">getElemBeginIterator</a>();
  elem_end = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a7d3dc9abc5b0e6c43d35fc186276f1ab">getElemEndIterator</a>();
  
  
  <span class="comment">// this for loop calculates and stores in elem_temp_matrix the following quantity </span>
  <span class="comment">// [d T_R^4 / d T_FE] = [int_Omega 4 ({N}^T {T_FE}+T_abs)^3 {N}^T d Omega]</span>
  <span class="keywordflow">for</span> (; elem_it != elem_end; elem_it++)
    {
      elem_dof = (*elem_it)-&gt;ID();
      
      fe_node_ID_vec.clear();
      
      <span class="comment">// get the vector of internal node IDs</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ae94eed3036f1184da73c8b95d4a034ba">getInternalNodeIDForRadElem</a>
      (elem_dof, fe_node_ID_vec);
      
      <span class="comment">// get the local elem and the nodes in the local coordinates</span>
      Elem* local_rad_elem = 
      (*elem_it)-&gt;getLocalRadiationGeometricElem();
      <span class="keyword">const</span> std::vector&lt;Node*&gt; local_nodes = 
      (*elem_it)-&gt;getLocalCoordinateNodes();
      
      fe_rad-&gt;reinit(local_rad_elem);
      
      <span class="comment">// now obtain the value of the shape function for </span>
      <span class="comment">// the associated FE</span>
      <span class="keyword">const</span> std::vector&lt;std::vector&lt;Real&gt; &gt;&amp; phi_rad = fe_rad-&gt;get_phi();
      <span class="keyword">const</span> std::vector&lt;Real&gt;&amp; JxW_rad = fe_rad-&gt;get_JxW();
      
      points.clear();
      
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp = 0; qp &lt; phi_rad[0].size(); qp++)
        {
          Point pt;
          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; phi_rad.size(); i++)
            {
              Node&amp; node = *(local_nodes[i]);
              pt(0) += phi_rad[i][qp] * node(0);
              pt(1) += phi_rad[i][qp] * node(1);
            }
          points.push_back(pt);
        }
      
      <span class="comment">// next, get the values of the shape function for the global </span>
      <span class="comment">// FE at the quad points for the local rad elem</span>
      global_fe-&gt;reinit(local_rad_elem, &amp;points);
      <span class="keyword">const</span> std::vector&lt;std::vector&lt;Real&gt; &gt;&amp; phi_global = global_fe-&gt;get_phi();
      
      <span class="keywordflow">if</span> (value.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac">size</a>() != phi_global.size())
        value.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions">resize</a>(phi_global.size());
      
      <span class="comment">// now, calculate the G_vector</span>
      value.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp=0; qp &lt; JxW_rad.size(); qp++)
        {
          <span class="comment">// calculate the temperaure at the quadrature point first</span>
          qp_value = 0.0;
          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; phi_global.size(); i++)
            qp_value += phi_global[i][qp] * 
            (nodal_temp_val.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e">el</a>(fe_node_ID_vec[i]) + temp_abs);
          
          qp_value = pow(qp_value, 3);
          <span class="comment">// next, add this to the vector </span>
          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; phi_global.size(); i++)
            value.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a8d29fa33d3f981456e6bfa26a1fac17f">add</a>(i, 4 * phi_global[i][qp] * qp_value * JxW_rad[qp]);
        }
      
      value.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a67cddf9b9ceb614362da1519af23b3d3">scale</a>(1.0 / (*elem_it)-&gt;getArea());
      <span class="comment">// now insert the value in the elem matrix</span>
      elem_temp_matrix.setRow(elem_dof, fe_node_ID_vec, value);
    }
  
  
  
  <span class="comment">// now multiply the factor matrix and the elem_temp_matrix</span>
  <span class="comment">// together to get the jacobian</span>
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    {
      <span class="comment">// for temp independent case, we have [d T_R^4 / d T_FE] in the elem temp matrix</span>
      <span class="comment">// this only needs to be multiplied with the factor matrix G^T A B^{-1} on the left</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(factor_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998">RadiationCavityAnalysis::FACTOR_MATRIX</a>);
      elem_temp_matrix.leftMultiply(factor_matrix);
      jacobian.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#abda25b62b46fd71c1e1870a3c95f4d17">copy</a>(elem_temp_matrix);
    }
  <span class="keywordflow">else</span>  
    {
      <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>
      A_inv(n_elems, n_elems), AB_inv(n_elems, n_elems), G_mat(n_elems, n_nodes);
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(G_mat, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">RadiationCavityAnalysis::G_MATRIX</a>);
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(A_inv, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ae8bc4b7f41e205e9e6fe14a31a551ef0">RadiationCavityAnalysis::A_INVERSE_MATRIX</a>);
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(AB_inv, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0">RadiationCavityAnalysis::AB_INV_MATRIX</a>);
      factor_matrix.copy(AB_inv);
      factor_matrix.leftMultiplyTranspose(G_mat);
      
      <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> temp_dep_vector(n_elems), rad_temp_vector;
      temp_dep_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
      rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aef377bb5ffe6811cf1c27448ddfc0365">calculateRadElemTempVector</a>(&amp;rad_temp_vector, nodal_temp_val,
                                       <span class="keyword">false</span>, <span class="comment">// false for reduce power by 4 </span>
                                       <span class="keyword">false</span>); <span class="comment">// false for sensitivity </span>
      
      <span class="comment">// get the contribution matrix due to temperature dependent properties</span>
      <span class="comment">// this willl return the term [\frac{\partial B_{ij}}{\partial T_{R_k}}\psi_j]_diag</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a6d92ac9dce49cfcd2627adc86e09f58c" title="calculate the matrix ">calculateB_TemperatureDependentJacobianContribution</a>(temp_dep_vector, rad_temp_vector,
                                                                A_inv, AB_inv);
      
      <span class="comment">// multiply it with the sensitivity of the radiation temperatures, with respect to the</span>
      <span class="comment">// FE temperatures</span>
      <span class="comment">// [d {T_rad} / d {T_fe}] = (1/4) * diag([(T_rad + T_a)^3])^(-1) * [elem_temp_matrix]</span>
      
      <span class="comment">// to perform this calculation, first obtain the temperature vector raised to 3rd power</span>
      rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a78a2fdc3d899fdde5c43a8d6133ccd83" title="raises each element of the vector by the given power">power</a>(0.75);
      rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a67cddf9b9ceb614362da1519af23b3d3">scale</a>(-4.0); <span class="comment">// -4.0 to take care of the -1.0 of this term</span>
      rad_temp_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab1d853d64dbf0700c202da505f914946" title="sets each element of the vector to its reciprocal">invertValues</a>();
      
      <span class="comment">// this pointwise multiplication operation gives the vector </span>
      <span class="comment">// -1.0 * [\frac{\partial B_{ij}}{\partial T_{R_k}}\psi_j]_diag * [(1/4) * (T_rad + T_a)^-3]_diag </span>
      temp_dep_vector.pointwiseMultiply(rad_temp_vector);
      <span class="comment">// this shift operation takes care of the [d((T_{rad}+T_{abs})^4)/d T_{rad}]</span>
      temp_dep_vector.shift(1.0);
      
      <span class="comment">// now use this to calculate the following term using the approximation</span>
      <span class="comment">// [G]^T [A] [B]^{-1} [lambda] [dT_R^4/dT_{FE}]</span>
      <span class="keywordflow">if</span>(!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ac5080de08bcb7b1c43830650b87c061c" title="boolean about whether to approximate or recalculate ABInv factor">ifApproximateABInvFactor</a>())
        {
          elem_temp_matrix.leftDiagonalScale(temp_dep_vector);
          elem_temp_matrix.leftMultiply(factor_matrix);
        }
      <span class="keywordflow">else</span>
        {
          <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> vector1(n_elems), vector2(n_elems);
          this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a92c0ccdda2e26fb12ef85ee8013cc314">getTemperatureDependentFluxCorrectionVector</a>(vector2, AB_inv);
          AB_inv.getDiagonal(vector1);
          vector2.pointwiseMultiply(vector1);
          vector2.pointwiseMultiply(temp_dep_vector);
          vector2.add(1.0, temp_dep_vector);
          AB_inv.rightDiagonalScale(temp_dep_vector);
          
          AB_inv.leftMultiplyTranspose(G_mat);
          elem_temp_matrix.leftMultiply(AB_inv);
        }
      
      jacobian.<a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#abda25b62b46fd71c1e1870a3c95f4d17">copy</a>(elem_temp_matrix);
    }
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::getFEJacobianMatrix()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_ae155657b1fa03cee3b09bc02eea7c140_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_ae155657b1fa03cee3b09bc02eea7c140_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_ae155657b1fa03cee3b09bc02eea7c140_cgraph" id="class_radiation_cavity_analysis_ae155657b1fa03cee3b09bc02eea7c140_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a8d29fa33d3f981456e6bfa26a1fac17f" title="FESystemNumerics::PetscVectorBase::add" alt="" coords="420,5,698,33"/><area shape="rect" id="node9" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#abda25b62b46fd71c1e1870a3c95f4d17" title="FESystemNumerics::PetscSeqDenseMatrix::copy" alt="" coords="402,161,716,189"/><area shape="rect" id="node13" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e" title="FESystemNumerics::PetscVectorBase::el" alt="" coords="426,317,692,345"/><area shape="rect" id="node15" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab1d853d64dbf0700c202da505f914946" title="sets each element of the vector to its reciprocal" alt="" coords="395,369,723,397"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aa6a1ff5036f446d56c04ebc418ff2e2d" title="FESystemNumerics::PetscMatrixBase::leftDiagonalScale" alt="" coords="380,57,738,85"/><area shape="rect" id="node21" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a63f0f418eefb914bea8c3cf8ed47bc9f" title="FESystemNumerics::PetscSeqDenseMatrix::leftMultiply" alt="" coords="384,265,733,293"/><area shape="rect" id="node26" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a4e686c59ee1ffbc455c0a330613d63b7" title="FESystemNumerics::PetscSeqDenseMatrix::leftMultiplyTranspose" alt="" coords="353,213,764,241"/><area shape="rect" id="node30" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="426,421,691,449"/><area shape="rect" id="node32" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="428,473,689,501"/><area shape="rect" id="node34" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a1f96ef209ad5edcaf49aaf150ad789b6" title="sets (*this)[i] = (*this)[i] * vec[i]" alt="" coords="381,109,737,137"/><area shape="rect" id="node38" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a78a2fdc3d899fdde5c43a8d6133ccd83" title="raises each element of the vector by the given power" alt="" coords="413,525,705,553"/><area shape="rect" id="node40" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html#a734ca8b60d564df1539ae11e9fd5f867" title="resize the matrix to the given dimensions" alt="" coords="416,577,701,605"/><area shape="rect" id="node42" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a67cddf9b9ceb614362da1519af23b3d3" title="FESystemNumerics::PetscVectorBase::scale" alt="" coords="415,629,702,657"/><area shape="rect" id="node44" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae18d819dc1f95b6b8f157055b2d9c27c" title="FESystemNumerics::PetscMatrixBase::setRow" alt="" coords="409,681,708,709"/><area shape="rect" id="node46" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac" title="FESystemNumerics::PetscVectorBase::size" alt="" coords="419,733,698,761"/><area shape="rect" id="node48" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="418,785,699,813"/><area shape="rect" id="node50" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="419,837,699,865"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="813,31,1144,59"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="831,83,1127,111"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91" title="FESystemNumerics::MatrixBase::getMatrixPackage" alt="" coords="815,213,1142,241"/><area shape="rect" id="node24" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="831,265,1126,293"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a38932efef014877857e9cd643b69bf73"></a><!-- doxytag: member="RadiationCavityAnalysis::getFENodalDofIDs" ref="a38932efef014877857e9cd643b69bf73" args="(std::vector&lt; unsigned int &gt; &amp;vector)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a38932efef014877857e9cd643b69bf73">RadiationCavityAnalysis::getFENodalDofIDs</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>vector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>method returns the FE nodal dof IDs for the nodes of the FE that are participating in radiation. Values in the nodal load vector will be arranged in the same way as the dofs in this vector </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">vector</td><td>the IDs will be returned in this vector </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01045">1045</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_8h_source.html#l00375">RadiationCavity::getFENodes()</a>, and <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00239">radiation_cavity</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// get the vector of FE nodes from the cavity</span>
  <span class="keyword">const</span> std::vector&lt;Node*&gt;&amp; node_vector = 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a8018aadd0171d514477ada7314cbbc1b">getFENodes</a>();
  
  std::vector&lt;Node*&gt;::const_iterator it, end;
  it = node_vector.begin();
  end = node_vector.end();
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dof_ID = 0;
  
  <span class="comment">// clear the vector, and then insert the nodes in it</span>
  vector.clear();
  <span class="keywordflow">for</span> (; it != end; it++)
    {
      dof_ID = (*it)-&gt;dof_number(0,0,0);
      vector.push_back(dof_ID);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a38932efef014877857e9cd643b69bf73_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a38932efef014877857e9cd643b69bf73_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a38932efef014877857e9cd643b69bf73_cgraph" id="class_radiation_cavity_analysis_a38932efef014877857e9cd643b69bf73_cgraph">
<area shape="rect" id="node3" href="class_radiation_cavity.html#a8018aadd0171d514477ada7314cbbc1b" title="RadiationCavity::getFENodes" alt="" coords="337,5,533,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a13405f2f110d5d759287f93310a92efd"></a><!-- doxytag: member="RadiationCavityAnalysis::getFENodalLoadVector" ref="a13405f2f110d5d759287f93310a92efd" args="(FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;nodal_temp_val, FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;nodal_load_vector)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a13405f2f110d5d759287f93310a92efd">RadiationCavityAnalysis::getFENodalLoadVector</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodal_temp_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodal_load_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>method returns the FE nodal heat load vector </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nodal_temp_val</td><td>value of the nodal temperature arranged in the same way as the dof vector obtrained from the method <a class="el" href="class_radiation_cavity_analysis.html#a38932efef014877857e9cd643b69bf73">getFENodalDofIDs()</a> </td></tr>
    <tr><td class="paramname">nodal_load_vector</td><td>the nodal heat load vector is returned in this </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01199">1199</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00074">AB_INV_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00073">FACTOR_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00071">G_MATRIX</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00828">FESystemNumerics::PetscMatrixBase&lt; T &gt;::leftMultiplyVector()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00786">FESystemNumerics::PetscMatrixBase&lt; T &gt;::rightMultiplyVector()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00408">FESystemNumerics::PetscVectorBase&lt; T &gt;::size()</a>, and <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::getFENodalLoadVector()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
 
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a8018aadd0171d514477ada7314cbbc1b">getFENodes</a>().size();
  
  Assert(nodal_temp_vector.size() == n_nodes, ExcInternalError());
  Assert(nodal_load_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac">size</a>() == n_nodes, ExcInternalError());
  
  <span class="comment">// first set the pointer to the nodal load vector</span>
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aca8fb869507838123c3e8d1e226e38cb" title="pointer to the FE nodal temperature vector for the analysis">fe_nodal_temp_vector</a> = &amp;(nodal_temp_vector);
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> rad_temp_vector(n_elems);
  rad_temp_vector.zero();
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aef377bb5ffe6811cf1c27448ddfc0365">calculateRadElemTempVector</a>(&amp;rad_temp_vector, nodal_temp_vector,
                                   <span class="keyword">false</span>, <span class="keyword">false</span>);
  
  <span class="comment">// get the factor_matrix, multiply to get the nodal load vector and return </span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> factor_matrix(n_elems, n_nodes); 
  nodal_load_vector.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
  
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    {
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(factor_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998">RadiationCavityAnalysis::FACTOR_MATRIX</a>);
      factor_matrix.rightMultiplyVector(rad_temp_vector,
                                        nodal_load_vector);
    }
  <span class="keywordflow">else</span>
    {
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(factor_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">RadiationCavityAnalysis::G_MATRIX</a>);
      <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> mat1(rad_temp_vector.size(),
                                                         rad_temp_vector.size());
      
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(mat1, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0">RadiationCavityAnalysis::AB_INV_MATRIX</a>);
      <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> 
      vector1(n_elems), vector2(n_elems), vector3(n_elems);
      mat1.rightMultiplyVector(rad_temp_vector, vector1);
      
      <span class="keywordflow">if</span>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ac5080de08bcb7b1c43830650b87c061c" title="boolean about whether to approximate or recalculate ABInv factor">ifApproximateABInvFactor</a>())
        {
          this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a92c0ccdda2e26fb12ef85ee8013cc314">getTemperatureDependentFluxCorrectionVector</a>(vector2, mat1);
          vector2.pointwiseMultiply(vector1);
          mat1.rightMultiplyVector(vector2, vector3);
          vector1.add(1.0, vector3);
        }

      factor_matrix.leftMultiplyVector(vector1, nodal_load_vector);
    }
  
  
  <span class="comment">// now clear the pointer</span>
  this-&gt;fe_nodal_temp_vector = NULL;
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::getFENodalLoadVector()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a13405f2f110d5d759287f93310a92efd_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a13405f2f110d5d759287f93310a92efd_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a13405f2f110d5d759287f93310a92efd_cgraph" id="class_radiation_cavity_analysis_a13405f2f110d5d759287f93310a92efd_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adee2257f7d4a1e65682a6ad595036d02" title="FESystemNumerics::PetscMatrixBase::leftMultiplyVector" alt="" coords="367,5,721,33"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="798,109,1079,137"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a89fe3f3f5841376aa58fe144278c707c" title="FESystemNumerics::PetscMatrixBase::rightMultiplyVector" alt="" coords="363,57,725,85"/><area shape="rect" id="node16" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac" title="FESystemNumerics::PetscVectorBase::size" alt="" coords="404,161,684,189"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="773,57,1104,85"/><area shape="rect" id="node9" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="791,5,1087,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a61471a6ba45557144aabdef1ddc94562"></a><!-- doxytag: member="RadiationCavityAnalysis::getFENodalLoadVectorSensitivity" ref="a61471a6ba45557144aabdef1ddc94562" args="(FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;nodal_temp_val, FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;nodal_load_vector)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a61471a6ba45557144aabdef1ddc94562">RadiationCavityAnalysis::getFENodalLoadVectorSensitivity</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodal_temp_val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodal_load_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>method returns the FE nodal heat load vector </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">nodal_temp_val</td><td>value of the nodal temperature arranged in the same way as the dof vector obtrained from the method <a class="el" href="class_radiation_cavity_analysis.html#a38932efef014877857e9cd643b69bf73">getFENodalDofIDs()</a> </td></tr>
    <tr><td class="paramname">nodal_load_vector</td><td>the nodal heat load vector is returned in this </td></tr>
    <tr><td class="paramname">DV</td><td>pointer to design variable for which sensitivity is sought </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01265">1265</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00066">A_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00065">A_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00067">A_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00074">AB_INV_MATRIX</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00422">FESystemNumerics::PetscVectorBase&lt; T &gt;::add()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00070">B_INVERSE_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00069">B_MATRIX_SENSITIVITY</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00073">FACTOR_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00071">G_MATRIX</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00072">G_MATRIX_SENSITIVITY</a>, <a class="el" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">DesignData::DesignParameter::getParameterTypeEnumID()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00828">FESystemNumerics::PetscMatrixBase&lt; T &gt;::leftMultiplyVector()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00786">FESystemNumerics::PetscMatrixBase&lt; T &gt;::rightMultiplyVector()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00408">FESystemNumerics::PetscVectorBase&lt; T &gt;::size()</a>, and <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::getFENodalLoadVectorSensitivity()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
  
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a8018aadd0171d514477ada7314cbbc1b">getFENodes</a>().size();
  
  Assert(nodal_temp_vector.size() == n_nodes, ExcInternalError());
  Assert(nodal_load_vector_sens.size() == n_nodes, ExcInternalError());
  
  <span class="comment">// first set the pointer to the nodal load vector</span>
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aca8fb869507838123c3e8d1e226e38cb" title="pointer to the FE nodal temperature vector for the analysis">fe_nodal_temp_vector</a> = &amp;(nodal_temp_vector);
  nodal_load_vector_sens.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
  
  <span class="comment">// calculate T_rad and d(T_rad)/d(Alpha)</span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> rad_temp_vector(n_elems);
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> rad_temp_vector_sens(n_elems);
  
  rad_temp_vector.zero();
  rad_temp_vector_sens.zero();
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aef377bb5ffe6811cf1c27448ddfc0365">calculateRadElemTempVector</a>(&amp;rad_temp_vector,
                                   nodal_temp_vector,
                                   <span class="keyword">false</span>,
                                   <span class="keyword">false</span>);
  
  <span class="keyword">const</span> <a class="code" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters.">DesignData::DesignParameter</a>&amp; dparam = 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().<a class="code" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable">getCurrentDesignParameter</a>();
  <span class="keywordflow">if</span> (dparam.<a class="code" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702">getParameterTypeEnumID</a>() == DesignData::SHAPE_PARAMETER::num())
    this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aef377bb5ffe6811cf1c27448ddfc0365">calculateRadElemTempVector</a>(&amp;rad_temp_vector_sens,
                                     nodal_temp_vector,
                                     <span class="keyword">false</span>,
                                     <span class="keyword">true</span>);
  
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> G_matrix(n_elems, n_nodes);
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(G_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaddba04b27f5a8c99ae4edac90bdf939">RadiationCavityAnalysis::G_MATRIX</a>);
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> G_matrix_sens(n_elems, n_nodes);
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(G_matrix_sens, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ab3e00964c9ce893d80049b2b2daf4967">RadiationCavityAnalysis::G_MATRIX_SENSITIVITY</a>);
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> A_matrix(n_elems, n_elems); 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(A_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aaebaf5b8a62e34552ead17659e9d0415">RadiationCavityAnalysis::A_MATRIX</a>);
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> A_matrix_sens(n_elems, n_elems);
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(A_matrix_sens, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9afc5da26c57bb9e45d36e0b65db2e061b">RadiationCavityAnalysis::A_MATRIX_SENSITIVITY</a>);
  
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> B_matrix_sens(n_elems, n_elems);
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(B_matrix_sens, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9aa8e253c18366682e146778d7d9c6d09e">RadiationCavityAnalysis::B_MATRIX_SENSITIVITY</a>);
  
  <span class="comment">// out of these vectors, vector4 has size n_nodes, hence, result of any vector multiplied by </span>
  <span class="comment">// G matrix will go into this vector </span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> vector1(n_elems), vector2(n_elems), vector3(n_elems),
  vector4(n_nodes);
  vector1.zero(); vector2.zero(); vector3.zero(); vector4.zero();
  
  std::auto_ptr&lt;FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt; &gt; AB_inv, A_inv, factor_matrix;
  
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    {
      factor_matrix.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>(n_nodes, n_elems)); 
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(*factor_matrix, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a706dd25ad60743b308702c7c244fc998">RadiationCavityAnalysis::FACTOR_MATRIX</a>);
      <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a> B_inverse_matrix(n_elems, n_elems);
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(B_inverse_matrix,
                              <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9a82a5786d2a5fc2125c69c3b0c4b25795">RadiationCavityAnalysis::B_INVERSE_MATRIX</a>);
      B_inverse_matrix.rightMultiplyVector(rad_temp_vector,
                                           vector1);
    }
  <span class="keywordflow">else</span>
    {
      AB_inv.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>(n_elems, n_elems)); 
      A_inv.reset(<span class="keyword">new</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;</a>(n_elems, n_elems)); 
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(*AB_inv, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ada425f7476e4534bd9684e2d4fab9ce0">RadiationCavityAnalysis::AB_INV_MATRIX</a>);
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">getMatrixQuantity</a>(*A_inv, <a class="code" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9ae8bc4b7f41e205e9e6fe14a31a551ef0">RadiationCavityAnalysis::A_INVERSE_MATRIX</a>);
      
      AB_inv-&gt;rightMultiplyVector(rad_temp_vector, vector1);
      A_inv-&gt;rightMultiplyVector(vector1, vector2);
    }
  
  <span class="comment">// calculate the first term</span>
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    {
      vector3.zero();
      A_matrix.rightMultiplyVector(vector1, vector3);
      G_matrix_sens.leftMultiplyVector(vector3, nodal_load_vector_sens);
    }
  <span class="keywordflow">else</span>
    G_matrix_sens.leftMultiplyVector(vector1, nodal_load_vector_sens);
  
  <span class="comment">// second term</span>
  vector3.zero();
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    A_matrix_sens.rightMultiplyVector(vector1, vector3);
  <span class="keywordflow">else</span>
    A_matrix_sens.rightMultiplyVector(vector2, vector3);
  G_matrix.leftMultiplyVector(vector3, vector4);
  nodal_load_vector_sens.add(1.0, vector4);
  
  <span class="comment">// third term</span>
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    {
      B_matrix_sens.rightMultiplyVector(vector1, vector3);
      rad_temp_vector_sens.add(-1.0, vector3);
      factor_matrix-&gt;rightMultiplyVector(rad_temp_vector_sens, vector4);
    }
  <span class="keywordflow">else</span>
    {
      B_matrix_sens.rightMultiplyVector(vector2, vector3);
      rad_temp_vector_sens.add(-1.0, vector3);
      AB_inv-&gt;rightMultiplyVector(rad_temp_vector_sens, vector3);
      G_matrix.leftMultiplyVector(vector3, vector4);
    }
  
  nodal_load_vector_sens.add(1.0, vector4);
  
  <span class="comment">// clear the nodal load vector pointer</span>
  this-&gt;fe_nodal_temp_vector = NULL;
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;RadiationCavityAnalysis::getFENodalLoadVectorSensitivity()&quot;</span>,
   this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2" title="performance logging header">performance_logging_header</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a61471a6ba45557144aabdef1ddc94562_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a61471a6ba45557144aabdef1ddc94562_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a61471a6ba45557144aabdef1ddc94562_cgraph" id="class_radiation_cavity_analysis_a61471a6ba45557144aabdef1ddc94562_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a8d29fa33d3f981456e6bfa26a1fac17f" title="FESystemNumerics::PetscVectorBase::add" alt="" coords="469,5,747,33"/><area shape="rect" id="node9" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702" title="DesignData::DesignParameter::getParameterTypeEnumID" alt="" coords="424,213,792,241"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adee2257f7d4a1e65682a6ad595036d02" title="FESystemNumerics::PetscMatrixBase::leftMultiplyVector" alt="" coords="431,57,785,85"/><area shape="rect" id="node14" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="865,109,1146,137"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a89fe3f3f5841376aa58fe144278c707c" title="FESystemNumerics::PetscMatrixBase::rightMultiplyVector" alt="" coords="427,109,789,137"/><area shape="rect" id="node22" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac" title="FESystemNumerics::PetscVectorBase::size" alt="" coords="468,265,748,293"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="840,57,1171,85"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="857,5,1153,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9f4b19a51682c6e3aceaa1c7f507b389"></a><!-- doxytag: member="RadiationCavityAnalysis::getMatrixQuantity" ref="a9f4b19a51682c6e3aceaa1c7f507b389" args="(FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; &amp;matrix, const RadiationQty qty_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a9f4b19a51682c6e3aceaa1c7f507b389">RadiationCavityAnalysis::getMatrixQuantity</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_radiation_cavity_analysis.html#aa6d260d026c174d590d65b920d0cd6e9">RadiationQty</a>&#160;</td>
          <td class="paramname"><em>qty_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>method returns a reference to the quantity for this cavity analysis </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">qty_name</td><td>name of the quantity that is to be returned </td></tr>
    <tr><td class="paramname">DV</td><td>pointer to the design variable if sensitivity is seeked. Should NULL if no sensitivity is required </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00111">111</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00254">calculateQty()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01746">checkIfTemperatureDependent()</a>, <a class="el" href="_analysis_discipline_base_8h_source.html#l00666">Discipline::AnalysisDisciplineBase::checkPropertyDependenceOnTemperature()</a>, <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00233">fesystem_controller</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01799">getDataInfoForQty()</a>, <a class="el" href="_f_e_system_controller_8h_source.html#l00145">FESystem::FESystemController::global_data_storage</a>, and <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00236">thermal_discipline</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">calculateA_Matrix()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">calculateB_Matrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// check if the matrix exists. If not, then calculate it, store it and </span>
  <span class="comment">// return it.</span>
  
  <span class="comment">// create a data info object based on the kind of analysis </span>
  std::auto_ptr&lt;FESystemDatabase::DataInfoBase&gt; data_info(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95">getDataInfoForQty</a>(qty_name).release());  
  
  <span class="comment">// this bool will check if this quantity needs to be recalculated and resaved</span>
  <span class="keywordtype">bool</span> recalculate_and_store = <span class="keyword">false</span>;
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>() &amp;&amp; 
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a6f756b8d67e57b6d605c102fb3209e97">checkIfTemperatureDependent</a>(qty_name))
    recalculate_and_store = <span class="keyword">true</span>;
  
  
  <span class="keywordtype">bool</span> qty_exists = 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a61c6211b1a2e6518ac9e357e385fad2b" title="stores global matrices and vectors">global_data_storage</a>-&gt;checkIfQtyExists(*data_info);
  
  
  <span class="comment">// if the quantity is not present or if the qty is dependent on temperature</span>
  <span class="comment">// and </span>
  <span class="keywordflow">if</span> ( !qty_exists || recalculate_and_store)
    {
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a72530913e06cbae197063f3e3f8fa2ca">calculateQty</a>(&amp;matrix, qty_name);
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a61c6211b1a2e6518ac9e357e385fad2b" title="stores global matrices and vectors">global_data_storage</a>-&gt;storeMatrix(*data_info, matrix);
      
      <span class="comment">//**************** this is only temporary *********************</span>
      <span class="comment">/*      if (qty_name == RadiationCavityAnalysis::F_MATRIX)</span>
<span class="comment">       {</span>
<span class="comment">       FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;&amp; matrix = *(insert_return_pair.first-&gt;second);</span>
<span class="comment">       </span>
<span class="comment">       Mat petsc_matrix;</span>
<span class="comment">       MatCreateSeqAIJ(PETSC_COMM_SELF,</span>
<span class="comment">       matrix.m(),</span>
<span class="comment">       matrix.n(),</span>
<span class="comment">       0,</span>
<span class="comment">       PETSC_NULL,</span>
<span class="comment">       &amp;petsc_matrix);</span>
<span class="comment">       </span>
<span class="comment">       for (unsigned int i=0; i &lt; matrix.m(); i++)</span>
<span class="comment">       for (unsigned int j=0; j &lt; matrix.n(); j++)</span>
<span class="comment">       MatSetValue(petsc_matrix, i,j, matrix(i,j), INSERT_VALUES);</span>
<span class="comment">       </span>
<span class="comment">       MatAssemblyBegin(petsc_matrix, MAT_FINAL_ASSEMBLY);</span>
<span class="comment">       MatAssemblyEnd(petsc_matrix, MAT_FINAL_ASSEMBLY);</span>
<span class="comment">       </span>
<span class="comment">       PetscViewer binary_viewer;</span>
<span class="comment">       </span>
<span class="comment">       std::string file_name = name;</span>
<span class="comment">       std::ostringstream osstream;</span>
<span class="comment">       osstream &lt;&lt; this-&gt;radiation_cavity.getCavityID();</span>
<span class="comment">       file_name += osstream.str();</span>
<span class="comment">       </span>
<span class="comment">       PetscViewerBinaryOpen( FESystem::COMM_WORLD,</span>
<span class="comment">       file_name.c_str(),</span>
<span class="comment">       PETSC_FILE_CREATE,</span>
<span class="comment">       &amp;binary_viewer);</span>
<span class="comment">       </span>
<span class="comment">       </span>
<span class="comment">       MatView(petsc_matrix, binary_viewer);</span>
<span class="comment">       </span>
<span class="comment">       PetscViewerDestroy(binary_viewer);</span>
<span class="comment">       </span>
<span class="comment">       MatDestroy(petsc_matrix);</span>
<span class="comment">       }*/</span>
      <span class="comment">//**************** this is only temporary *********************</span>
      <span class="comment">//**************** this is only temporary *********************</span>
      <span class="comment">/*          if (qty_name == RadiationCavityAnalysis::F_MATRIX )</span>
<span class="comment">       {</span>
<span class="comment">       FESystemNumerics::PetscSeqDenseMatrix&lt;double&gt;&amp; matrix = *(insert_return_pair.first-&gt;second);</span>
<span class="comment">       </span>
<span class="comment">       Mat Fmatrix, dFmatrix;</span>
<span class="comment">       </span>
<span class="comment">       PetscViewer binary_viewer;</span>
<span class="comment">       </span>
<span class="comment">       std::string base_name, sens_name;</span>
<span class="comment">       base_name = this-&gt;getStringNameForQty(qty_name);</span>
<span class="comment">       sens_name = this-&gt;getStringNameForQtySensitivity(qty_name, 1);</span>
<span class="comment">       </span>
<span class="comment">       std::ostringstream osstream;</span>
<span class="comment">       osstream &lt;&lt; this-&gt;radiation_cavity.getCavityID();</span>
<span class="comment">       </span>
<span class="comment">       base_name += osstream.str();</span>
<span class="comment">       sens_name += osstream.str();</span>
<span class="comment">       </span>
<span class="comment">       // Read in F</span>
<span class="comment">       PetscViewerBinaryOpen( FESystem::COMM_WORLD,</span>
<span class="comment">       base_name.c_str(),</span>
<span class="comment">       PETSC_FILE_RDONLY,</span>
<span class="comment">       &amp;binary_viewer);</span>
<span class="comment">       MatLoad(binary_viewer, MATSEQAIJ, &amp;Fmatrix);</span>
<span class="comment">       PetscViewerDestroy(binary_viewer);</span>
<span class="comment">       MatAssemblyBegin(Fmatrix, MAT_FINAL_ASSEMBLY);</span>
<span class="comment">       MatAssemblyEnd(Fmatrix, MAT_FINAL_ASSEMBLY);</span>
<span class="comment">       </span>
<span class="comment">       // now read in dF/dalpha</span>
<span class="comment">       PetscViewerBinaryOpen( FESystem::COMM_WORLD,</span>
<span class="comment">       sens_name.c_str(),</span>
<span class="comment">       PETSC_FILE_RDONLY,</span>
<span class="comment">       &amp;binary_viewer);</span>
<span class="comment">       MatLoad(binary_viewer, MATSEQAIJ, &amp;dFmatrix);</span>
<span class="comment">       PetscViewerDestroy(binary_viewer);</span>
<span class="comment">       MatAssemblyBegin(dFmatrix, MAT_FINAL_ASSEMBLY);</span>
<span class="comment">       MatAssemblyEnd(dFmatrix, MAT_FINAL_ASSEMBLY);</span>
<span class="comment">       </span>
<span class="comment">       </span>
<span class="comment">       double ddv = this-&gt;fesystem_controller.analysis_case-&gt;getRealParameter(&quot;DDV&quot;);</span>
<span class="comment">       </span>
<span class="comment">       MatAXPY(Fmatrix , ddv, dFmatrix, SAME_NONZERO_PATTERN);</span>
<span class="comment">       MatAssemblyBegin(Fmatrix, MAT_FINAL_ASSEMBLY);</span>
<span class="comment">       MatAssemblyEnd(Fmatrix, MAT_FINAL_ASSEMBLY);</span>
<span class="comment">       </span>
<span class="comment">       </span>
<span class="comment">       double value;</span>
<span class="comment">       for (unsigned int i=0; i &lt; matrix.m(); i++)</span>
<span class="comment">       for (unsigned int j=0; j &lt; matrix.n(); j++)</span>
<span class="comment">       {</span>
<span class="comment">       const int  ii  = i;</span>
<span class="comment">       const int jj = j;</span>
<span class="comment">       if (DV == NULL)</span>
<span class="comment">       MatGetValues(Fmatrix, 1, &amp;ii, 1, &amp;jj, &amp;value);</span>
<span class="comment">       else </span>
<span class="comment">       MatGetValues(dFmatrix, 1, &amp;ii, 1, &amp;jj, &amp;value);</span>
<span class="comment">       </span>
<span class="comment">       matrix(i,j) = value;</span>
<span class="comment">       }</span>
<span class="comment">       </span>
<span class="comment">       MatDestroy(Fmatrix);</span>
<span class="comment">       MatDestroy(dFmatrix);</span>
<span class="comment">       </span>
<span class="comment">       }*/</span>
      <span class="comment">//**************** this is only temporary *********************</span>
      
    }
  <span class="keywordflow">else</span>
    this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a61c6211b1a2e6518ac9e357e385fad2b" title="stores global matrices and vectors">global_data_storage</a>-&gt;fillMatrix(*data_info, matrix);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a9f4b19a51682c6e3aceaa1c7f507b389_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a9f4b19a51682c6e3aceaa1c7f507b389_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a9f4b19a51682c6e3aceaa1c7f507b389_cgraph" id="class_radiation_cavity_analysis_a9f4b19a51682c6e3aceaa1c7f507b389_cgraph">
<area shape="rect" id="node3" href="class_radiation_cavity_analysis.html#a72530913e06cbae197063f3e3f8fa2ca" title="RadiationCavityAnalysis::calculateQty" alt="" coords="385,589,631,617"/><area shape="rect" id="node76" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature" alt="" coords="1574,1447,2058,1475"/><area shape="rect" id="node129" href="class_radiation_cavity_analysis.html#a6f756b8d67e57b6d605c102fb3209e97" title="RadiationCavityAnalysis::checkIfTemperatureDependent" alt="" coords="331,1683,685,1711"/><area shape="rect" id="node132" href="class_radiation_cavity_analysis.html#a15c6ef55ace32a38f7b37339187abc95" title="RadiationCavityAnalysis::getDataInfoForQty" alt="" coords="762,1785,1043,1813"/><area shape="rect" id="node5" href="class_radiation_cavity_analysis.html#a2225147650551e23cfff7ed0e9dcdc4c" title="RadiationCavityAnalysis::calculateA_InverseMatrix" alt="" coords="742,277,1063,305"/><area shape="rect" id="node27" href="class_radiation_cavity_analysis.html#a5a8bcd110b1fab5e384846642fc90020" title="RadiationCavityAnalysis::calculateA_Matrix" alt="" coords="764,641,1041,669"/><area shape="rect" id="node49" href="class_radiation_cavity_analysis.html#a9b773a18ce7531728bf76b2b6905723b" title="RadiationCavityAnalysis::calculateABInvFactorMatrix" alt="" coords="736,876,1070,904"/><area shape="rect" id="node60" href="class_radiation_cavity_analysis.html#a03d86d48b9c5d0cd54a43f34a16326b6" title="RadiationCavityAnalysis::calculateB_InverseMatrix" alt="" coords="742,329,1063,357"/><area shape="rect" id="node72" href="class_radiation_cavity_analysis.html#a8142f6d6d27312dc289796a6a7188a61" title="RadiationCavityAnalysis::calculateB_Matrix" alt="" coords="764,1161,1041,1189"/><area shape="rect" id="node105" href="class_radiation_cavity_analysis.html#a2efa1a2121b55ef46dd5d57fca123d7c" title="RadiationCavityAnalysis::calculateFactorMatrix" alt="" coords="753,485,1052,513"/><area shape="rect" id="node108" href="class_radiation_cavity_analysis.html#a1b96d789767e44f16f503128ed62a5c9" title="RadiationCavityAnalysis::calculateG_Matrix" alt="" coords="763,589,1042,617"/><area shape="rect" id="node118" href="class_radiation_cavity_analysis.html#a3a2849b2e8421de972e93744f335e757" title="RadiationCavityAnalysis::calculateShapeFactorMatrix" alt="" coords="734,537,1071,565"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e" title="FESystemNumerics::PetscVectorBase::el" alt="" coords="1190,69,1456,97"/><area shape="rect" id="node9" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix" alt="" coords="1154,121,1491,149"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="1669,329,1963,357"/><area shape="rect" id="node13" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="1175,173,1471,201"/><area shape="rect" id="node15" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="1190,381,1455,409"/><area shape="rect" id="node17" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="1192,433,1453,461"/><area shape="rect" id="node19" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca" title="resize the matrix to the given dimensions" alt="" coords="1162,485,1483,513"/><area shape="rect" id="node21" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38" title="FESystemNumerics::PetscMatrixBase::set" alt="" coords="1187,277,1459,305"/><area shape="rect" id="node23" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="1182,225,1463,253"/><area shape="rect" id="node25" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c" title="FESystemNumerics::PetscMatrixBase::zero" alt="" coords="1183,537,1463,565"/><area shape="rect" id="node29" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa" title="FESystemNumerics::PetscMatrixBase::add" alt="" coords="1185,589,1461,617"/><area shape="rect" id="node32" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80" title="Discipline::AnalysisDisciplineBase::getAnalysisDriver" alt="" coords="1156,1057,1490,1085"/><area shape="rect" id="node34" href="class_driver_1_1_analysis_driver.html#ac258e74334cc629c3961bde90f9e5fd9" title="returns the current design variable" alt="" coords="1161,1109,1484,1137"/><area shape="rect" id="node37" href="class_design_data_1_1_design_parameter.html#ada780fbd596a879cb3d57cb44376a702" title="DesignData::DesignParameter::getParameterTypeEnumID" alt="" coords="1139,693,1506,721"/><area shape="rect" id="node41" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity" alt="" coords="1211,797,1434,825"/><area shape="rect" id="node44" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b" title="FESystemNumerics::PetscMatrixBase::scale" alt="" coords="1180,641,1465,669"/><area shape="rect" id="node46" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a61d3ca9a3e1f750e2b28f1dd503990d7" title="adds val to all diagonal elements of the matrix" alt="" coords="1183,745,1462,773"/><area shape="rect" id="node51" href="class_f_e_system_database_1_1_generic_data_info_base.html#ab5cbefc863791bda1b4962a22598e9e0" title="clears the data structures of this object" alt="" coords="1167,849,1478,877"/><area shape="rect" id="node53" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID" alt="" coords="1120,901,1525,929"/><area shape="rect" id="node55" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent" alt="" coords="1142,953,1503,981"/><area shape="rect" id="node57" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity" alt="" coords="1155,1161,1490,1189"/><area shape="rect" id="node74" href="class_radiation_cavity_analysis.html#af707b1f733c9f12a5d791d18c74efc47" title="clears the property card initialization" alt="" coords="1148,1213,1497,1241"/><area shape="rect" id="node78" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a15f229e47968131c7df600ba3e6f2448" title="FESystemNumerics::PetscMatrixBase::diagonalAdd" alt="" coords="1159,1265,1487,1293"/><area shape="rect" id="node80" href="class_radiation_element.html#a3cae7f1c590c9bb5de710f8e5fe517eb" title="ID of the finite element that this is attached to." alt="" coords="1217,1317,1429,1345"/><area shape="rect" id="node84" href="class_property_1_1_property_database.html#a4120ff84d49bd7d1b547507759f2d27f" title="returns the element property card for this ID" alt="" coords="1150,1369,1495,1397"/><area shape="rect" id="node86" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ad0a5644dd5120fb02d602cae62a5a330" title="MeshDS::FEMeshData::getElemFromForeignID" alt="" coords="1171,1421,1474,1449"/><area shape="rect" id="node88" href="class_radiation_cavity.html#aa2186ca4c287a20ae923e6b5a5619801" title="RadiationCavity::getElemFromID" alt="" coords="1215,1473,1430,1501"/><area shape="rect" id="node90" href="class_mesh_d_s_1_1_f_e_mesh_data.html#ae50bb83a080c0f9d30cb6a7b9458af54" title="MeshDS::FEMeshData::getElemPropertyID" alt="" coords="1184,1525,1462,1553"/><area shape="rect" id="node92" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor" alt="" coords="1236,1577,1409,1605"/><area shape="rect" id="node94" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c" title="ElemDataCard::getFactorSensitivityForGlobalParameter" alt="" coords="1146,1629,1499,1657"/><area shape="rect" id="node96" href="class_design_data_1_1_design_parameter.html#ab0cb6d6c10206acebbc06d2be204c2e7" title="DesignData::DesignParameter::getID" alt="" coords="1202,1005,1443,1033"/><area shape="rect" id="node135" href="class_radiation_cavity.html#aa7fc38a25e02d4d38d20c16720124ef4" title="returns the cavity ID" alt="" coords="1227,1733,1418,1761"/><area shape="rect" id="node137" href="class_driver_1_1_transient_analysis_driver.html#aeb9ad9e6f71bacc09f168141428af9d5" title="Driver::TransientAnalysisDriver::getCurrentAnalysisTime" alt="" coords="1146,1785,1500,1813"/><area shape="rect" id="node140" href="class_driver_1_1_transient_analysis_driver.html#ab9622f4ee33604c4d864d63f8cc93ef6" title="Driver::TransientAnalysisDriver::getCurrentIterationNumber" alt="" coords="1137,1837,1508,1865"/><area shape="rect" id="node142" href="class_driver_1_1_analysis_driver.html#ad9f4c9e39727b9b9ba9fcbe7353e9c7f" title="returns the current load case number" alt="" coords="1182,1889,1463,1917"/><area shape="rect" id="node144" href="class_solution_1_1_solution_base.html#a73528968dadb7365a70b0503032ef7c6" title="Solution::SolutionBase::getDisciplineTransientNatureEnumID" alt="" coords="1132,1941,1514,1969"/><area shape="rect" id="node147" href="class_discipline_1_1_analysis_discipline_base.html#aaa6666781d3c78e003c9f8002aaeff16" title="Discipline::AnalysisDisciplineBase::getSolution" alt="" coords="1174,1993,1471,2021"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a92c0ccdda2e26fb12ef85ee8013cc314"></a><!-- doxytag: member="RadiationCavityAnalysis::getTemperatureDependentFluxCorrectionVector" ref="a92c0ccdda2e26fb12ef85ee8013cc314" args="(FESystemNumerics::PetscSeqVector&lt; double &gt; &amp;correction_vec, FESystemNumerics::PetscSeqDenseMatrix&lt; double &gt; &amp;AB_inv_mat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a92c0ccdda2e26fb12ef85ee8013cc314">RadiationCavityAnalysis::getTemperatureDependentFluxCorrectionVector</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>correction_vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html">FESystemNumerics::PetscSeqDenseMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>AB_inv_mat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>calculates the vector <img class="formulaInl" alt="$ \sum_{j} [((AB^{-1})_{ii})^{j-1} (\gamma_i)^j ]_{diag} $" src="form_2.png"/> . This is needed for the case of temperature dependent material property when the <img class="formulaInl" alt="$ [A][B]^{-1} $" src="form_0.png"/> is being approximated </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01592">1592</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="_petsc_vector_base_8h_source.html#l00422">FESystemNumerics::PetscVectorBase&lt; T &gt;::add()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00187">FESystemNumerics::PetscVectorBase&lt; T &gt;::el()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00365">FESystemNumerics::PetscMatrixBase&lt; T &gt;::getDiagonal()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">FESystemNumerics::PetscMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">FESystemNumerics::PetscMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00511">FESystemNumerics::PetscVectorBase&lt; T &gt;::scale()</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00215">FESystemNumerics::PetscVectorBase&lt; T &gt;::set()</a>, <a class="el" href="_data_info_8_c_source.html#l00169">FESystemDatabase::GenericDataInfoBase::setDisciplineEnumID()</a>, <a class="el" href="_data_info_8_c_source.html#l00087">FESystemDatabase::GenericDataInfoBase::setLoadCase()</a>, <a class="el" href="_data_info_8_c_source.html#l00136">FESystemDatabase::GenericDataInfoBase::setName()</a>, <a class="el" href="_arpack_eigen_solver_8h_source.html#l00408">sigma</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00408">FESystemNumerics::PetscVectorBase&lt; T &gt;::size()</a>, and <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_elems = this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#a5fb60ba2eb1d222cd3457059eec084b1" title="returns the number of radiation elems in the cavity">nRadiationElems</a>();
  
  Assert(correction_vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac">size</a>() == n_elems, ExcInternalError());
  Assert(AB_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() == n_elems, ExcInternalError());
  Assert(AB_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>() == n_elems, ExcInternalError());
  
  correction_vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
  
  <span class="comment">// calculate the epsilon vector and store it</span>
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector&lt;double&gt;</a> vec1(n_elems), vec2(n_elems);
  
  std::string name;
  std::ostringstream cavity_id;
  cavity_id &lt;&lt; this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#aa7fc38a25e02d4d38d20c16720124ef4" title="returns the cavity ID">getCavityID</a>();
  
  name.clear(); 
  name = <span class="stringliteral">&quot;BaseEpsilonVector&quot;</span>;
  name += <span class="stringliteral">&quot;_Cavity_&quot;</span>;
  name += cavity_id.str();
  
  <a class="code" href="class_f_e_system_database_1_1_time_independent_data_info.html" title="this defines a time independent quantity">FESystemDatabase::TimeIndependentDataInfo</a> time_independent_data_info;
  time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID">setDisciplineEnumID</a>(Discipline::RADIATION_DISCIPLINE::num());
  time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent">setLoadCase</a>(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a2f9cc3c81e1363d685cb65aeb6e91d80">getAnalysisDriver</a>().
                                         getCurrentLoadCase());
  time_independent_data_info.<a class="code" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity">setName</a>(name);
  
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a61c6211b1a2e6518ac9e357e385fad2b" title="stores global matrices and vectors">global_data_storage</a>-&gt;fillVector(time_independent_data_info,
                                                            vec1);
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a4d8daf804dae432452faf1334b5ee457" title="calculates the vector of emissivities for the current temperature of the cavity">calculateEmissivityVector</a>(&amp;vec2);
  
  <span class="comment">// next, calculate the gamma vector</span>
  vec2.add(-1.0, vec1);
  <span class="keywordtype">double</span> base_eps = 0.0, delta_eps = 0.0, val = 0.0;
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_elems; i++)
    {
      base_eps = vec1.el(i);
      delta_eps = vec2.el(i);
      
      val = -delta_eps/base_eps/(base_eps + delta_eps);
      vec2.set(i, val);
    }
  <span class="keywordtype">double</span> <a class="code" href="_arpack_eigen_solver_8h.html#ac687728cb5722b5730ca1b1197128920">sigma</a> = 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55" title="fesystem controller for this analysis">fesystem_controller</a>.<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#ae2f9f30b83db8a3cb69787c283708210" title="stores analysis details">analysis_case</a>-&gt;getRealParameter(<span class="stringliteral">&quot;S_B_CONSTANT&quot;</span>);
  <span class="comment">// store a copy of vec2 for future use</span>
  vec2.scale(1.0/sigma);

    
  AB_inv_mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a41de6854277687999d2d13fa124307b2" title="returns the diagonal of the matrix in the given vector">getDiagonal</a>(vec1);

  <span class="comment">// get the number of terms to use in the taylors series for approximation</span>
  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_taylor_terms = 
  this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ad452f2c3819ac1514a19b7a587defca0">getNTaylorTermsForABInvApproximation</a>();

  <span class="comment">// now iterate over the terms, and calculate the correction vector</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_taylor_terms; i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_elems; j++)
      {
        val = pow(-vec2.el(j)*vec1.el(j),i+1) / vec1.el(j);
        correction_vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a8d29fa33d3f981456e6bfa26a1fac17f">add</a>(j,val);
      }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a92c0ccdda2e26fb12ef85ee8013cc314_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a92c0ccdda2e26fb12ef85ee8013cc314_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a92c0ccdda2e26fb12ef85ee8013cc314_cgraph" id="class_radiation_cavity_analysis_a92c0ccdda2e26fb12ef85ee8013cc314_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a8d29fa33d3f981456e6bfa26a1fac17f" title="FESystemNumerics::PetscVectorBase::add" alt="" coords="573,5,851,33"/><area shape="rect" id="node9" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e" title="FESystemNumerics::PetscVectorBase::el" alt="" coords="579,57,845,85"/><area shape="rect" id="node11" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a41de6854277687999d2d13fa124307b2" title="returns the diagonal of the matrix in the given vector" alt="" coords="549,109,875,137"/><area shape="rect" id="node16" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91" title="FESystemNumerics::PetscMatrixBase::m" alt="" coords="579,161,845,189"/><area shape="rect" id="node18" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566" title="FESystemNumerics::PetscMatrixBase::n" alt="" coords="581,213,843,241"/><area shape="rect" id="node20" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a67cddf9b9ceb614362da1519af23b3d3" title="FESystemNumerics::PetscVectorBase::scale" alt="" coords="569,265,855,293"/><area shape="rect" id="node22" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a9fe9c425efb52cefc5b552cdf3295328" title="FESystemNumerics::PetscVectorBase::set" alt="" coords="575,317,849,345"/><area shape="rect" id="node24" href="class_f_e_system_database_1_1_generic_data_info_base.html#ac1115d95573153291185f76a1540f0e1" title="sets the discipline enum ID" alt="" coords="509,369,915,397"/><area shape="rect" id="node26" href="class_f_e_system_database_1_1_generic_data_info_base.html#a700ae1ec3358b497305c2099fbf1cfea" title="sets the load case value, and also sets to true the boolean value of if_load_case_dependent" alt="" coords="532,421,892,449"/><area shape="rect" id="node28" href="class_f_e_system_database_1_1_generic_data_info_base.html#a117399f629d87ea1b646333d91dee39f" title="sets the name of the quantity" alt="" coords="544,473,880,501"/><area shape="rect" id="node30" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#ab13ec4f05aad80c7e4060c45cf83caac" title="FESystemNumerics::PetscVectorBase::size" alt="" coords="572,525,852,553"/><area shape="rect" id="node32" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="571,577,853,605"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="963,57,1293,85"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="980,5,1276,33"/><area shape="rect" id="node14" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6" title="FESystemNumerics::VectorBase::size" alt="" coords="1005,109,1251,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3db1f2f4043524354d149fe910fd72df"></a><!-- doxytag: member="RadiationCavityAnalysis::initializePropertyCardAtElementTemperature" ref="a3db1f2f4043524354d149fe910fd72df" args="(ElemDataCard &amp;elem_data_card, const unsigned int rad_elem_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_radiation_cavity_analysis.html#a3db1f2f4043524354d149fe910fd72df">RadiationCavityAnalysis::initializePropertyCardAtElementTemperature</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_elem_data_card.html">ElemDataCard</a> &amp;&#160;</td>
          <td class="paramname"><em>elem_data_card</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>rad_elem_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>initializes the property card at the specified temperature </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l02087">2087</a> of file <a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a>.</p>

<p>References <a class="el" href="class_elem_data_card.html#a7c638e4644afb12563e60ca3235c1eba">ElemDataCard::reinitElemAndMaterialCardForLocalParameters()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">calculateB_Matrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// now initialize the property card at the specified value.</span>
  <span class="comment">// if the properties are temperature dependent, then initialize the</span>
  <span class="comment">// element property cards at the element average temperature</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29" title="reference to the thermal analysis discipline that owns this object">thermal_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    {
      Assert(this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aca8fb869507838123c3e8d1e226e38cb" title="pointer to the FE nodal temperature vector for the analysis">fe_nodal_temp_vector</a> != NULL, ExcEmptyObject());
      
      <span class="comment">// calculate the average of the nodal temperature of the finite element </span>
      <span class="comment">// to which the specified radiation element belongs.</span>
      <span class="keyword">static</span> std::vector&lt;unsigned int&gt; fe_node_ID_vec;
      fe_node_ID_vec.clear();
      
      <span class="comment">// get the vector of internal node IDs</span>
      this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0" title="cavity for this analysis">radiation_cavity</a>.<a class="code" href="class_radiation_cavity.html#ae94eed3036f1184da73c8b95d4a034ba">getInternalNodeIDForRadElem</a>
      (rad_elem_ID, fe_node_ID_vec);
      
      <span class="keywordtype">double</span> value = 0.0;
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; fe_node_ID_vec.size(); i++)
        value += this-&gt;<a class="code" href="class_radiation_cavity_analysis.html#aca8fb869507838123c3e8d1e226e38cb" title="pointer to the FE nodal temperature vector for the analysis">fe_nodal_temp_vector</a>-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a98c553254ecd51c3ece2b86e52cd960e">el</a>(fe_node_ID_vec[i]);
      
      value /= (1.0 * fe_node_ID_vec.size());
      
      <span class="keyword">static</span> std::map&lt;unsigned int, double&gt; local_param_map;    
      
      local_param_map[Property::TEMPERATURE::num()] = value; 
      elem_data_card.<a class="code" href="class_elem_data_card.html#a7c638e4644afb12563e60ca3235c1eba" title="initializes the card and the material card for the given local parameters">reinitElemAndMaterialCardForLocalParameters</a>(&amp;local_param_map);
    }
  <span class="keywordflow">else</span>
    {
      elem_data_card.<a class="code" href="class_elem_data_card.html#a7c638e4644afb12563e60ca3235c1eba" title="initializes the card and the material card for the given local parameters">reinitElemAndMaterialCardForLocalParameters</a>();
    }
  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_radiation_cavity_analysis_a3db1f2f4043524354d149fe910fd72df_cgraph.gif" border="0" usemap="#class_radiation_cavity_analysis_a3db1f2f4043524354d149fe910fd72df_cgraph" alt=""/></div>
<map name="class_radiation_cavity_analysis_a3db1f2f4043524354d149fe910fd72df_cgraph" id="class_radiation_cavity_analysis_a3db1f2f4043524354d149fe910fd72df_cgraph">
<area shape="rect" id="node3" href="class_elem_data_card.html#a7c638e4644afb12563e60ca3235c1eba" title="initializes the card and the material card for the given local parameters" alt="" coords="489,5,885,33"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aca8fb869507838123c3e8d1e226e38cb"></a><!-- doxytag: member="RadiationCavityAnalysis::fe_nodal_temp_vector" ref="aca8fb869507838123c3e8d1e226e38cb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_vector.html">FESystemNumerics::PetscSeqVector</a>&lt;double&gt;* <a class="el" href="class_radiation_cavity_analysis.html#aca8fb869507838123c3e8d1e226e38cb">RadiationCavityAnalysis::fe_nodal_temp_vector</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>pointer to the FE nodal temperature vector for the analysis </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00245">245</a> of file <a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a>.</p>

</div>
</div>
<a class="anchor" id="a548f39e72dfdeea8e77d637931023e55"></a><!-- doxytag: member="RadiationCavityAnalysis::fesystem_controller" ref="a548f39e72dfdeea8e77d637931023e55" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_system_1_1_f_e_system_controller.html">FESystem::FESystemController</a>&amp; <a class="el" href="class_radiation_cavity_analysis.html#a548f39e72dfdeea8e77d637931023e55">RadiationCavityAnalysis::fesystem_controller</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>fesystem controller for this analysis </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00233">233</a> of file <a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">calculateB_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00111">getMatrixQuantity()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00045">RadiationCavityAnalysis()</a>.</p>

</div>
</div>
<a class="anchor" id="ae71b3b3c642d07649bbacc8073c68b14"></a><!-- doxytag: member="RadiationCavityAnalysis::n_ABinv_calculations" ref="ae71b3b3c642d07649bbacc8073c68b14" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_radiation_cavity_analysis.html#ae71b3b3c642d07649bbacc8073c68b14">RadiationCavityAnalysis::n_ABinv_calculations</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>number of times the ABInv matrix has been calculated </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00242">242</a> of file <a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa6dcacf6d9a9f8f15e150f7bb86c88c2"></a><!-- doxytag: member="RadiationCavityAnalysis::performance_logging_header" ref="aa6dcacf6d9a9f8f15e150f7bb86c88c2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::string <a class="el" href="class_radiation_cavity_analysis.html#aa6dcacf6d9a9f8f15e150f7bb86c88c2">RadiationCavityAnalysis::performance_logging_header</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>performance logging header </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00248">248</a> of file <a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">calculateB_Matrix()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00045">RadiationCavityAnalysis()</a>.</p>

</div>
</div>
<a class="anchor" id="a1f138bfc5a3a6de6219d5893bfb79ec0"></a><!-- doxytag: member="RadiationCavityAnalysis::radiation_cavity" ref="a1f138bfc5a3a6de6219d5893bfb79ec0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_radiation_cavity.html">RadiationCavity</a>&amp; <a class="el" href="class_radiation_cavity_analysis.html#a1f138bfc5a3a6de6219d5893bfb79ec0">RadiationCavityAnalysis::radiation_cavity</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>cavity for this analysis </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00239">239</a> of file <a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">calculateB_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01799">getDataInfoForQty()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01045">getFENodalDofIDs()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00045">RadiationCavityAnalysis()</a>.</p>

</div>
</div>
<a class="anchor" id="af3c8a31a3265b0251b89b5e7773c2d29"></a><!-- doxytag: member="RadiationCavityAnalysis::thermal_discipline" ref="af3c8a31a3265b0251b89b5e7773c2d29" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_discipline_1_1_thermal_analysis.html">Discipline::ThermalAnalysis</a>&amp; <a class="el" href="class_radiation_cavity_analysis.html#af3c8a31a3265b0251b89b5e7773c2d29">RadiationCavityAnalysis::thermal_discipline</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>reference to the thermal analysis discipline that owns this object </p>

<p>Definition at line <a class="el" href="_radiation_cavity_analysis_8h_source.html#l00236">236</a> of file <a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">calculateB_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l02126">clearPropertyCardInitialization()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01799">getDataInfoForQty()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00111">getMatrixQuantity()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Radiation/<a class="el" href="_radiation_cavity_analysis_8h_source.html">RadiationCavityAnalysis.h</a></li>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Radiation/<a class="el" href="_radiation_cavity_analysis_8_c_source.html">RadiationCavityAnalysis.C</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 12 2012 18:06:21 for fesystem by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
