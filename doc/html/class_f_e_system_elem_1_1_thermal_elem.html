<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>fesystem: FESystemElem::ThermalElem Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">fesystem
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_f_e_system_elem.html">FESystemElem</a>      </li>
      <li class="navelem"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html">ThermalElem</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">FESystemElem::ThermalElem Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="FESystemElem::ThermalElem" --><!-- doxytag: inherits="FESystemElem::FESystemElemBase" -->
<p><code>#include &lt;<a class="el" href="thermal__elem_8h_source.html">thermal_elem.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for FESystemElem::ThermalElem:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_elem_1_1_thermal_elem__inherit__graph.gif" border="0" usemap="#_f_e_system_elem_1_1_thermal_elem_inherit__map" alt="Inheritance graph"/></div>
<map name="_f_e_system_elem_1_1_thermal_elem_inherit__map" id="_f_e_system_elem_1_1_thermal_elem_inherit__map">
<area shape="rect" id="node2" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html" title="FESystemElem::FESystemElemBase" alt="" coords="5,6,248,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for FESystemElem::ThermalElem:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_elem_1_1_thermal_elem__coll__graph.gif" border="0" usemap="#_f_e_system_elem_1_1_thermal_elem_coll__map" alt="Collaboration graph"/></div>
<map name="_f_e_system_elem_1_1_thermal_elem_coll__map" id="_f_e_system_elem_1_1_thermal_elem_coll__map">
<area shape="rect" id="node2" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html" title="FESystemElem::FESystemElemBase" alt="" coords="1845,293,2088,321"/><area shape="rect" id="node4" href="class_elem_data_card.html" title="ElemDataCard" alt="" coords="1508,62,1617,90"/><area shape="rect" id="node6" href="class_property_1_1_property_card_3_01double_01_4.html" title="this is a specialization of the class for property values that are stored as double" alt="" coords="1083,7,1304,35"/><area shape="rect" id="node8" href="class_property_1_1_property_card_base.html" title="Property::PropertyCardBase" alt="" coords="564,7,753,35"/><area shape="rect" id="node10" href="class_function_database.html" title="FunctionDatabase" alt="" coords="59,7,189,35"/><area shape="rect" id="node12" href="class_property_1_1_property_database.html" title="Property::PropertyDatabase" alt="" coords="872,67,1059,95"/><area shape="rect" id="node14" href="class_f_e_system_1_1_f_e_system_controller.html" title="FESystem::FESystemController" alt="" coords="19,329,229,357"/><area shape="rect" id="node16" href="class_discipline_1_1_analysis_discipline_base.html" title="Discipline::AnalysisDisciplineBase" alt="" coords="1451,293,1674,321"/><area shape="rect" id="node20" href="class_solution_1_1_solution_base.html" title="this class provides the base functionality for all solutions" alt="" coords="581,399,736,427"/><area shape="rect" id="node33" href="class_driver_1_1_analysis_driver.html" title="Driver::AnalysisDriver" alt="" coords="1119,535,1268,563"/><area shape="rect" id="node18" href="class_discipline_1_1_discipline_info.html" title="Discipline::DisciplineInfo" alt="" coords="1111,345,1276,373"/><area shape="rect" id="node23" href="class_mesh_d_s_1_1_f_e_dof_map.html" title="MeshDS::FEDofMap" alt="" coords="1122,462,1265,490"/><area shape="rect" id="node26" href="class_mesh_d_s_1_1_f_e_mesh_data.html" title="MeshDS::FEMeshData" alt="" coords="1114,241,1272,269"/><area shape="rect" id="node28" href="class_mesh_d_s_1_1_f_e_mesh.html" title="MeshDS::FEMesh" alt="" coords="594,143,723,171"/><area shape="rect" id="node31" href="class_f_e_system_utility_1_1_loaded_solution.html" title="this class is a data structure that stores loaded solution from the database" alt="" coords="1086,189,1301,217"/><area shape="rect" id="node36" href="class_solver_1_1_f_e_system_solver_base.html" title="Solver::FESystemSolverBase" alt="" coords="1465,559,1661,587"/><area shape="rect" id="node39" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; NumericVector\&lt; double \&gt; \&gt;" alt="" coords="469,594,848,622"/><area shape="rect" id="node41" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; T \&gt;" alt="" coords="6,594,242,622"/><area shape="rect" id="node44" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters." alt="" coords="558,542,760,570"/><area shape="rect" id="node46" href="class_element_data_storage.html" title="ElementDataStorage" alt="" coords="1490,345,1635,373"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_f_e_system_elem_1_1_thermal_elem-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a9f13ef2809a1fd0580c92b2a905a6747">ThermalElem</a> (const unsigned int dim, const unsigned int elem_enum_ID, <a class="el" href="class_discipline_1_1_analysis_discipline_base.html">Discipline::AnalysisDisciplineBase</a> &amp;discipline)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor  <a href="#a9f13ef2809a1fd0580c92b2a905a6747"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a5eaad14cd474ae96a77104a4cd410a2f">getTransientSystemOrder</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#afdf4c99e2e9a669b2897cb5805220ff5">~ThermalElem</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">destructor  <a href="#afdf4c99e2e9a669b2897cb5805220ff5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#aad30d4f7ee3d410dda88c6671652c4ac">getElementAssembledQty</a> (const unsigned int name_enum_ID, DenseVector&lt; double &gt; *qty)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the assembled vector quantity for the element  <a href="#aad30d4f7ee3d410dda88c6671652c4ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a8b90454e88d6733419c026422ae92465">getElementAssembledQty</a> (const unsigned int name_enum_ID, DenseMatrix&lt; double &gt; *qty)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the assembled matrix quantity for the element  <a href="#a8b90454e88d6733419c026422ae92465"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#abc6e975ec8a9274d9ccdc984852af1fa">getElementAssembledQtySensitivity</a> (const unsigned int name_enum_ID, DenseVector&lt; double &gt; *qty)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the assembled matrix quantity sensitivity for the element  <a href="#abc6e975ec8a9274d9ccdc984852af1fa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#ae78703e32d2d202aa04d8fcd48d22d3e">getElementAssembledQtySensitivity</a> (const unsigned int name_enum_ID, DenseMatrix&lt; double &gt; *qty)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the assembled matrix quantity sensitivity for the element  <a href="#ae78703e32d2d202aa04d8fcd48d22d3e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual std::auto_ptr<br class="typebreak"/>
&lt; <a class="el" href="class_elem_post_process_qty.html">ElemPostProcessQty</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a846a008053337a7f64e51c1675cffd91">getElementPostProcessQty</a> (std::vector&lt; unsigned int &gt; load_cases, std::vector&lt; <a class="el" href="class_design_data_1_1_design_parameter.html">DesignData::DesignParameter</a> * &gt; DV_vector)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#aa434bfc5568cdf31d6674e1e33c1475e">getFETypes</a> (std::vector&lt; FEType &gt; &amp;fetypes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#abe7e88d34cb867a7b63b12c5798952a1">getQuadratureRules</a> (std::map&lt; FEFamily, std::pair&lt; QuadratureType, Order &gt; &gt; &amp;quadratures)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">inserts the quadrature rules to be used for the different elements  <a href="#abe7e88d34cb867a7b63b12c5798952a1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a4b92c18aa9764afb97ad95478814617f">calculateAssembledQty</a> (DenseMatrix&lt; double &gt; *, const unsigned int qty_enum_ID, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a4f4eb8585aa9bce26fee1b5d946eec56">calculateAssembledQty</a> (DenseVector&lt; double &gt; *, const unsigned int qty_enum_ID, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class QtyType &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a0a926f5284f22b171288b3ba887c7208">getThermalElemQty</a> (const unsigned int name, QtyType *qty, const unsigned int design_point_enum_ID, const unsigned int domain, const bool sensitivity)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a5d19a7188c02c52d4c312026bcd385a5">calculateThermalElemQty</a> (DenseVector&lt; double &gt; *qty, const unsigned int qty_enum_ID, const unsigned int design_point_enum_ID, const unsigned int domain_enum_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#ad2e225b9e66c5bcc7dc983e14eadbc24">calculateThermalElemQty</a> (DenseMatrix&lt; double &gt; *qty, const unsigned int qty_enum_ID, const unsigned int design_point_enum_ID, const unsigned int domain_enum_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#ad19fe324123691d125c1128b4c186333">calculate_C</a> (DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a4773a287529b4a0dcf11617da7a0b125">calculate_C_Jac</a> (DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a2c6ec1d90e13aacb2226e18bb9e037ff">calculate_K_c</a> (DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a6de794cce348a820cd1ba5833c942fa2">calculate_K_c_Jac</a> (DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a5b81aeb1aa6d2d8749746d4517b47f1a">calculate_K_h</a> (DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a171342122f53fd9f5ba0bff3a26a9374">calculate_F_qsurf</a> (DenseVector&lt; double &gt; *vector, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a94002158ad218d837097c996653a1266">calculate_F_Qvol</a> (DenseVector&lt; double &gt; *vector, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a01cf3b54758f8b2138ca80e12ea20cd9">calculate_F_h</a> (DenseVector&lt; double &gt; *vector, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#ae27f28631b56d7c1763e30aeffc0125c">calculate_F_sigma</a> (DenseVector&lt; double &gt; *vector, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#aa5f991e4af393879446510bff34a8ea9">calculate_F_sigma_Jac</a> (DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculated and returns the jacobian contribution from the radiation loads  <a href="#aa5f991e4af393879446510bff34a8ea9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a21e06dbbd2bb8d90dbafaa9027075931">calculateEmittedRadiationLoadFactor</a> (DenseVector&lt; double &gt; *load_factor, const unsigned int design_point_enum_ID, const unsigned int domain)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">this calculates the factor for emitted radiation factor  <a href="#a21e06dbbd2bb8d90dbafaa9027075931"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a58c8e9789a990f6ff03c4c622038f109">initPropertyCard</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a9050fbb17fc569e2440de56ec8eef98c">clearPropertyCardInitialization</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">this clears the temperature initialization only for the property cards.  <a href="#a9050fbb17fc569e2440de56ec8eef98c"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>a base class defining the heat conduction elements </p>

<p>Definition at line <a class="el" href="thermal__elem_8h_source.html#l00210">210</a> of file <a class="el" href="thermal__elem_8h_source.html">thermal_elem.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a9f13ef2809a1fd0580c92b2a905a6747"></a><!-- doxytag: member="FESystemElem::ThermalElem::ThermalElem" ref="a9f13ef2809a1fd0580c92b2a905a6747" args="(const unsigned int dim, const unsigned int elem_enum_ID, Discipline::AnalysisDisciplineBase &amp;discipline)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a9f13ef2809a1fd0580c92b2a905a6747">FESystemElem::ThermalElem::ThermalElem</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>elem_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_discipline_1_1_analysis_discipline_base.html">Discipline::AnalysisDisciplineBase</a> &amp;&#160;</td>
          <td class="paramname"><em>discipline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>constructor </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00029">29</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">                                              :
<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#aef9c74acc51e534acc4bc932b94aad4d">FESystemElem::FESystemElemBase</a>(dim, elem_enum_ID, discipline)
{
  
}
</pre></div>
</div>
</div>
<a class="anchor" id="afdf4c99e2e9a669b2897cb5805220ff5"></a><!-- doxytag: member="FESystemElem::ThermalElem::~ThermalElem" ref="afdf4c99e2e9a669b2897cb5805220ff5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#afdf4c99e2e9a669b2897cb5805220ff5">FESystemElem::ThermalElem::~ThermalElem</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>destructor </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00039">39</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
        
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ad19fe324123691d125c1128b4c186333"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_C" ref="ad19fe324123691d125c1128b4c186333" args="(DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#ad19fe324123691d125c1128b4c186333">FESystemElem::ThermalElem::calculate_C</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to calculate the element capacitance matrix. The first arguement is the matrix that will be resized to the appropriate size, and filled with the matrix elements. If sensitivity of the matrix wrt to a property is to be calculated, then second arguement with the name of the property should be provided. </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00204">204</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>

<p>References <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> <span class="keywordtype">double</span> factor, factor_sens; 
  factor = 0.0, factor_sens = 0.0; 
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor, THERMAL_CAPACITANCE_FACTOR::num());

  <span class="keywordflow">if</span> (sensitivity_calculation &amp;&amp; 
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a> == DesignData::PROPERTY_PARAMETER::num())
    {
    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#abc346451898593d3646b745240c2e739">checkElemAndMaterialCardGlobalParameterDependence</a>
        (this-&gt;sensitivity_parameter_ID))
      <span class="keywordflow">return</span>;
    
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>
    (factor_sens, THERMAL_CAPACITANCE_FACTOR::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>);
    }
  
  <span class="keywordflow">if</span>(sensitivity_calculation)
    {
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
      {
      <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), matrix, 
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          matrix-&gt;scale(factor_sens);
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>(FESystemElem::N_N_FACTOR::num(), matrix, 
                                                   FESystemElem::ELEM_VOLUME::num(), 
                                                   LAGRANGE);
          matrix-&gt;scale(factor);
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">default</span>:
        abort();
        <span class="keywordflow">break</span>;
      }
    }
  <span class="keywordflow">else</span>
    {
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), matrix, 
                             design_point_enum_ID,
                             FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
    matrix-&gt;scale(factor);
    }
  
  
  <span class="comment">// diagonalize the matrix since the non-diagonal capacitance is not working well</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; matrix-&gt;m(); i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; matrix-&gt;n(); j++)
      {
      <span class="keywordflow">if</span> (i==j)
        <span class="keywordflow">continue</span>;
      (*matrix)(i,i) += (*matrix)(i,j);
      (*matrix)(i,j) = 0.0;
      }
  
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4773a287529b4a0dcf11617da7a0b125"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_C_Jac" ref="a4773a287529b4a0dcf11617da7a0b125" args="(DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a4773a287529b4a0dcf11617da7a0b125">FESystemElem::ThermalElem::calculate_C_Jac</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00276">276</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    <span class="keywordflow">return</span>;
  
  <span class="keyword">static</span> <span class="keywordtype">double</span> factor; 
  factor = 0.0; 
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55">getFactorSensitivityForLocalParameter</a>
    (factor, THERMAL_CAPACITANCE_FACTOR::num(), Property::TEMPERATURE::num());
  
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  
  <span class="comment">// it is assumed that the matrices and vectors remain the same size as </span>
  <span class="comment">// created here. Hence, they are not resized again.</span>
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; mat1(n_nodes, n_nodes);
  <span class="keyword">static</span> DenseVector&lt;double&gt; vec2(n_nodes);
  <span class="keywordflow">if</span> ((vec2.size() != n_nodes))
    {
    vec2.resize(n_nodes);
    mat1.resize(n_nodes, n_nodes); 
    }

  mat1.zero();
  vec2.zero();  
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), &amp;mat1, 
                           design_point_enum_ID,
                           FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
  mat1.scale(factor / (1.0 * n_nodes));
  
  mat1.right_multiply_vector(this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26c3c4e9ea952cbc8a7de979f74e0fde" title="vector of element dof values">dof_values_vec</a>[1], vec2);
  
  <span class="comment">// now, this vector has to be placed inside the jacobian matrix</span>
  <span class="keyword">static</span> <span class="keywordtype">double</span> value = 0.0;
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes; i++)
    {
    value = vec2(i);
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; n_nodes; j++)
      (*matrix)(i,j) = value;
    }

  <span class="comment">// diagonalize the matrix since the non-diagonal capacitance is not working well</span>
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; matrix-&gt;m(); i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; matrix-&gt;m(); j++)
      {
      <span class="keywordflow">if</span> (i==j)
        <span class="keywordflow">continue</span>;
      (*matrix)(i,i) += (*matrix)(i,j);
      (*matrix)(i,j) = 0.0;
      }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a01cf3b54758f8b2138ca80e12ea20cd9"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_F_h" ref="a01cf3b54758f8b2138ca80e12ea20cd9" args="(DenseVector&lt; double &gt; *vector, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a01cf3b54758f8b2138ca80e12ea20cd9">FESystemElem::ThermalElem::calculate_F_h</a> </td>
          <td>(</td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to calculate the element surface convection load vector. The first arguement is the vector that will be resized to the appropriate size, and filled with the vector elements. The second arguement should be the vector of surface convection loads for the element. If sensitivity of the vector wrt to a property is to be calculated, then third arguement with the name of the property should be provided. </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00988">988</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>

<p>References <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// initialize the data structures for loads and their sensitivities</span>
  std::map&lt;unsigned int, std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt; &gt;::const_iterator 
    load_map_it, load_sens_map_it;
  std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt;::const_iterator 
  load_iterator, end_iterator,          <span class="comment">// iterators for the loads</span>
  load_sens_iterator;           <span class="comment">// iterators for the load sensitivities</span>
  
  <span class="comment">// if no loads exist return from the function with an arguement false</span>
  <span class="comment">// this implies that the quantity is zero and need not be processed</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;count(SURFACE_CONVECTION_HEAT_LOAD::num()) == 0)
    <span class="keywordflow">return</span>;
  <span class="keywordflow">else</span>
    load_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;find(SURFACE_CONVECTION_HEAT_LOAD::num());
  
  <span class="comment">// obtain the two iterators as separate values</span>
  load_iterator = load_map_it-&gt;second.begin();
  end_iterator = load_map_it-&gt;second.end();
        
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> side_num;
  <span class="keywordtype">bool</span> load_on_elem_face;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sides;
  n_sides = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a28c863a4fa859e3b5725bb0688412806">geometric_elems_for_DV_map</a>.find(design_point_enum_ID)-&gt;second-&gt;n_sides();
   
  <span class="keywordtype">double</span> coeff_val, coeff_val_sens, temp_val, temp_val_sens;
  coeff_val = 0.0; coeff_val_sens = 0.0; temp_val = 0.0; temp_val_sens = 0.0;
   
  <span class="comment">// process the load and update the element load vector.</span>
  <span class="keywordflow">for</span> (; load_iterator != end_iterator; load_iterator++)
    {
    side_num = load_iterator-&gt;second-&gt;getSurfaceID();
                
    <span class="comment">// for 2-D elements, the element face itself can carry a surface flux load.</span>
    load_on_elem_face = <span class="keyword">false</span>;
                
    <span class="keywordflow">if</span> (n_sides == side_num)
      load_on_elem_face = <span class="keyword">true</span>;
    
    <span class="keywordtype">double</span> factor, factor_sens;
    factor = 0.0; factor_sens = 0.0;
    
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
      {
      <span class="keywordflow">case</span> 1:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#aa4029e1e403519cf9003458d2d788e65" title="this method returns the value of a property">getPropertyValue</a>(AREA::num(), factor);
          <span class="keywordflow">if</span> (sensitivity_calculation)
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#a530325d5a9a887c5ae7919ac04a5b89b">getPropertyDerivativeForGlobalParameter</a>
            (AREA::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
        }
        <span class="keywordflow">break</span>;
                                
      <span class="keywordflow">case</span> 2:
        {
          <span class="comment">// the integration will be different if the load is on the element face</span>
          <span class="keywordflow">if</span> (load_on_elem_face)
            {
            factor =  1.0;
            factor_sens = 0.0;
            }
          <span class="keywordflow">else</span> 
            {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#aa4029e1e403519cf9003458d2d788e65" title="this method returns the value of a property">getPropertyValue</a>(THICKNESS_2D_ELEM::num(), factor);
            <span class="keywordflow">if</span> (sensitivity_calculation)
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#a530325d5a9a887c5ae7919ac04a5b89b">getPropertyDerivativeForGlobalParameter</a>
              (THICKNESS_2D_ELEM::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
            }
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">case</span> 3:
        {
          factor = 1.0;
          factor_sens = 0.0;
        }
        <span class="keywordflow">break</span>;
      }
        
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> domain = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a0a233a1ea240348c578b8c66947f59c1">getDomainEnumFromSideNumber</a>(side_num);
    
    coeff_val = 
      <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_surface_convection_load_combination.html">Loads::SurfaceConvectionLoadCombination</a>*<span class="keyword">&gt;</span>(load_iterator-&gt;second)-&gt;getConvectionCoeff();
    temp_val = 
      <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_surface_convection_load_combination.html">Loads::SurfaceConvectionLoadCombination</a>*<span class="keyword">&gt;</span>(load_iterator-&gt;second)-&gt;getAmbientTemperature();
    
    <span class="comment">// now, scale the matrix with the right factors to take into </span>
    <span class="comment">// account the sensitivity if needed</span>
    <span class="keywordflow">if</span> (sensitivity_calculation)
      {
      load_sens_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acba94cde0c083ff023592b46f2d6391e">surface_load_sens</a>-&gt;find(SURFACE_CONVECTION_HEAT_LOAD::num());
      <span class="comment">// if the load exists, its sensitivity should also be specified</span>
      Assert(load_sens_map_it != this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acba94cde0c083ff023592b46f2d6391e">surface_load_sens</a>-&gt;end(),
             ExcInternalError());
      load_sens_iterator = load_sens_map_it-&gt;second.find(side_num);
      AssertThrow(load_sens_iterator != load_sens_map_it-&gt;second.end(),
                  ExcInternalError());
      
      coeff_val_sens = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_surface_convection_load_combination.html">Loads::SurfaceConvectionLoadCombination</a>*<span class="keyword">&gt;</span>
        (load_sens_iterator-&gt;second)-&gt;getConvectionCoeff();
      temp_val_sens = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_surface_convection_load_combination.html">Loads::SurfaceConvectionLoadCombination</a>*<span class="keyword">&gt;</span>
        (load_sens_iterator-&gt;second)-&gt;getAmbientTemperature();

      
      <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
        {
        <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
          {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>( FESystemElem::N_FACTOR::num(), vector,
                                      design_point_enum_ID,
                                      domain, LAGRANGE);
            vector-&gt;scale(factor * (coeff_val_sens *temp_val + 
                                    coeff_val * temp_val_sens) + 
                          factor_sens * coeff_val * temp_val);
          }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
          {
            <span class="keyword">static</span> DenseVector&lt;double&gt; qty, qty_sens;
            qty.zero(); qty_sens.zero();
            
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), &amp;qty,
                                     design_point_enum_ID,
                                     domain, LAGRANGE);
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>(FESystemElem::N_FACTOR::num(),
                                                     &amp;qty_sens, domain, LAGRANGE);
            
            qty.scale(factor * (coeff_val_sens *temp_val + 
                                coeff_val * temp_val_sens));
            qty_sens.scale(factor * coeff_val * temp_val);
            
            vector-&gt;add(1.0, qty);
            vector-&gt;add(1.0, qty_sens);
          }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">default</span>:
          abort();
          <span class="keywordflow">break</span>;
        }
      }
    <span class="keywordflow">else</span>
      {
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), vector,
                               design_point_enum_ID,
                               domain, LAGRANGE);
      vector-&gt;scale(factor * coeff_val * temp_val);
      }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a171342122f53fd9f5ba0bff3a26a9374"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_F_qsurf" ref="a171342122f53fd9f5ba0bff3a26a9374" args="(DenseVector&lt; double &gt; *vector, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a171342122f53fd9f5ba0bff3a26a9374">FESystemElem::ThermalElem::calculate_F_qsurf</a> </td>
          <td>(</td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to calculate the element surface heat flux load vector. The first arguement is the vector that will be resized to the appropriate size, and filled with the vector elements. The second arguement should be the vector of surface flux loads for the element. If sensitivity of the vector wrt to a property is to be calculated, then third arguement with the name of the property should be provided. </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00728">728</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>

<p>References <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// initialize the data structures for loads and their sensitivities</span>
  std::map&lt;unsigned int, std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt; &gt;::const_iterator 
  load_map_it, load_sens_map_it;
  std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt;::const_iterator 
  load_iterator, end_iterator,          <span class="comment">// iterators for the loads</span>
  load_sens_iterator;           <span class="comment">// iterators for the load sensitivities</span>
  
  <span class="comment">// if no loads exist return from the function with an arguement false</span>
  <span class="comment">// this implies that the quantity is zero and need not be processed</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;count(SURFACE_HEAT_LOAD::num()) == 0)
    <span class="keywordflow">return</span>;
  <span class="keywordflow">else</span>
    load_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;find(SURFACE_HEAT_LOAD::num());
                
  <span class="comment">// obtain the two iterators as separate values</span>
  load_iterator = load_map_it-&gt;second.begin();
  end_iterator = load_map_it-&gt;second.end();

  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> side_num, n_sides;
  <span class="keywordtype">bool</span> load_on_elem_face;
  n_sides = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a28c863a4fa859e3b5725bb0688412806">geometric_elems_for_DV_map</a>.find(design_point_enum_ID)-&gt;second-&gt;n_sides();
        
  <span class="keywordtype">double</span> load_val, load_val_sens;
  load_val = 0.0; load_val_sens = 0.0;

  <span class="comment">// process the load and update the element load vector.</span>
  <span class="keywordflow">for</span> (; load_iterator != end_iterator; load_iterator++)
    {
    side_num = load_iterator-&gt;second-&gt;getSurfaceID();
                
    <span class="comment">// for 2-D elements, the element face itself can carry a surface flux load.</span>
    load_on_elem_face = <span class="keyword">false</span>;
                
    <span class="keywordflow">if</span> (n_sides == side_num)
      load_on_elem_face = <span class="keyword">true</span>;
                
    <span class="keywordtype">double</span> factor, factor_sens;
    factor = 0.0; factor_sens = 0.0;
    
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
      {
      <span class="keywordflow">case</span> 1:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#aa4029e1e403519cf9003458d2d788e65" title="this method returns the value of a property">getPropertyValue</a>(AREA::num(), factor);
          <span class="keywordflow">if</span> (sensitivity_calculation)
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#a530325d5a9a887c5ae7919ac04a5b89b">getPropertyDerivativeForGlobalParameter</a>
            (AREA::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
        }
        <span class="keywordflow">break</span>;
                                
      <span class="keywordflow">case</span> 2:
        {
          <span class="comment">// the integration will be different if the load is on the element face</span>
          <span class="keywordflow">if</span> (load_on_elem_face)
            {
            factor =  1.0;
            factor_sens = 0.0;
            }
          <span class="keywordflow">else</span> 
            {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#aa4029e1e403519cf9003458d2d788e65" title="this method returns the value of a property">getPropertyValue</a>(THICKNESS_2D_ELEM::num(), factor);
            <span class="keywordflow">if</span> (sensitivity_calculation)
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#a530325d5a9a887c5ae7919ac04a5b89b">getPropertyDerivativeForGlobalParameter</a>
              (THICKNESS_2D_ELEM::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
            }
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">case</span> 3:
        {
          factor = 1.0;
          factor_sens = 0.0;
        }
        <span class="keywordflow">break</span>;
      }
    
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> domain = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a0a233a1ea240348c578b8c66947f59c1">getDomainEnumFromSideNumber</a>(side_num);
                
    load_val = 
      <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_scalar_surface_load_combination.html">Loads::ScalarSurfaceLoadCombination</a>*<span class="keyword">&gt;</span>(load_iterator-&gt;second)-&gt;getValue();

        <span class="keywordflow">if</span> (sensitivity_calculation)
      {
      load_sens_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acba94cde0c083ff023592b46f2d6391e">surface_load_sens</a>-&gt;find(SURFACE_HEAT_LOAD::num());
      <span class="comment">// if the load exists, its sensitivity should also be specified</span>
      Assert(load_sens_map_it != this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acba94cde0c083ff023592b46f2d6391e">surface_load_sens</a>-&gt;end(),
             ExcInternalError());
      load_sens_iterator = load_sens_map_it-&gt;second.find(side_num);
      AssertThrow(load_sens_iterator != load_sens_map_it-&gt;second.end(),
                  ExcInternalError());
      
      load_val_sens = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_scalar_surface_load_combination.html">Loads::ScalarSurfaceLoadCombination</a>*<span class="keyword">&gt;</span>
        (load_sens_iterator-&gt;second)-&gt;getValue();
      
      
      <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
        {
        <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
          {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), vector, 
                                     design_point_enum_ID,
                                     domain, LAGRANGE);
            vector-&gt;scale(factor * load_val_sens + factor_sens * load_val);
          }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
          {
            <span class="keyword">static</span> DenseVector&lt;double&gt; qty, qty_sens;
            qty.zero(); qty_sens.zero();
            
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), &amp;qty, 
                                     design_point_enum_ID,
                                     domain, LAGRANGE);
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>(FESystemElem::N_FACTOR::num(),
                                                     &amp;qty_sens, domain, LAGRANGE);
            
            qty.scale(factor * load_val_sens);
            qty_sens.scale(factor * load_val);
            
            vector-&gt;add(1.0, qty);
            vector-&gt;add(1.0, qty_sens);
          }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">default</span>:
          abort();
          <span class="keywordflow">break</span>;
        }
      }
    <span class="keywordflow">else</span>
      {
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), vector, 
                               design_point_enum_ID,
                               domain, LAGRANGE);
      vector-&gt;scale(factor * load_val);
      }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a94002158ad218d837097c996653a1266"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_F_Qvol" ref="a94002158ad218d837097c996653a1266" args="(DenseVector&lt; double &gt; *vector, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a94002158ad218d837097c996653a1266">FESystemElem::ThermalElem::calculate_F_Qvol</a> </td>
          <td>(</td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to calculate the element volume heat load vector. The first arguement is the vector that will be resized to the appropriate size, and filled with the vector elements. The second arguement should be the vector of volume heat loads for the element. If sensitivity of the vector wrt to a property is to be calculated, then third arguement with the name of the property should be provided. </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00877">877</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>

<p>References <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// initialize the data structures for loads and their sensitivities</span>
  std::map&lt;unsigned int, const Loads::VolumeLoadCombination*&gt;::const_iterator load_map_it, load_sens_map_it;
    
  <span class="comment">// if no loads exist return from the function with an arguement false</span>
  <span class="comment">// this implies that the quantity is zero and need not be processed</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a24d8d62e82199eb8cbbb16b38ba1206d" title="map of element loads">volume_loads</a>-&gt;count(VOLUME_HEAT_LOAD::num()) == 0)
    <span class="keywordflow">return</span>;
  <span class="keywordflow">else</span>
    load_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a24d8d62e82199eb8cbbb16b38ba1206d" title="map of element loads">volume_loads</a>-&gt;find(VOLUME_HEAT_LOAD::num());

  <span class="keywordtype">double</span> factor, factor_sens;
  factor = 0.0; factor_sens = 0.0;
    
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
    {
    <span class="keywordflow">case</span> 1:
      {
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#aa4029e1e403519cf9003458d2d788e65" title="this method returns the value of a property">getPropertyValue</a>(AREA::num(), factor);
        <span class="keywordflow">if</span> (sensitivity_calculation)
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#a530325d5a9a887c5ae7919ac04a5b89b">getPropertyDerivativeForGlobalParameter</a>
            (AREA::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> 2:
      {
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#aa4029e1e403519cf9003458d2d788e65" title="this method returns the value of a property">getPropertyValue</a>(THICKNESS_2D_ELEM::num(), factor);
        <span class="keywordflow">if</span> (sensitivity_calculation)
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#a530325d5a9a887c5ae7919ac04a5b89b">getPropertyDerivativeForGlobalParameter</a>
            (THICKNESS_2D_ELEM::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> 3:
      {
        factor = 1.0;
        factor_sens = 0.0;
      }
      <span class="keywordflow">break</span>;
    }
  
  <span class="keywordtype">double</span> load_val, load_val_sens;
  load_val = 0.0; load_val_sens = 0.0;

  load_val = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_scalar_volume_load_combination.html">Loads::ScalarVolumeLoadCombination</a>*<span class="keyword">&gt;</span>(load_map_it-&gt;second)-&gt;getValue();
  
  <span class="comment">// now, scale the matrix with the right factors to take into </span>
  <span class="comment">// account the sensitivity if needed</span>
  <span class="keywordflow">if</span> (sensitivity_calculation)
    {
    load_sens_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a6301f3b298e57276fa2344b881fc6c60">volume_load_sens</a>-&gt;find(VOLUME_HEAT_LOAD::num()); 
    <span class="comment">// if the load exists, its sensitivity should also be specified </span>
    Assert(load_sens_map_it != this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a6301f3b298e57276fa2344b881fc6c60">volume_load_sens</a>-&gt;end(),
           ExcInternalError());
    
    load_val_sens = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_scalar_volume_load_combination.html">Loads::ScalarVolumeLoadCombination</a>*<span class="keyword">&gt;</span>(load_sens_map_it-&gt;second)-&gt;getValue();
    
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
      {
      <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), vector, 
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          vector-&gt;scale(factor * load_val_sens + factor_sens * load_val);
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
        {
          <span class="keyword">static</span> DenseVector&lt;double&gt; qty, qty_sens;
          qty.zero(); qty_sens.zero();
          
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), &amp;qty, 
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>(FESystemElem::N_FACTOR::num(), &amp;qty_sens,
                                                   FESystemElem::ELEM_VOLUME::num(),
                                                   LAGRANGE);
          
          qty.scale(factor * load_val_sens);
          qty_sens.scale(factor * load_val);
          
          vector-&gt;add(1.0, qty);
          vector-&gt;add(1.0, qty_sens);
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">default</span>:
        abort();
        <span class="keywordflow">break</span>;
      }
    }
  <span class="keywordflow">else</span>
    {
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>( FESystemElem::N_FACTOR::num(), vector, 
                              design_point_enum_ID,
                              FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
    vector-&gt;scale(factor * load_val);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae27f28631b56d7c1763e30aeffc0125c"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_F_sigma" ref="ae27f28631b56d7c1763e30aeffc0125c" args="(DenseVector&lt; double &gt; *vector, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#ae27f28631b56d7c1763e30aeffc0125c">FESystemElem::ThermalElem::calculate_F_sigma</a> </td>
          <td>(</td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to calculate the element emitted radiation load vector. The first arguement is the vector that will be resized to the appropriate size, and filled with the vector elements. The third arguement should be the vector of emitted radiation load vector for the element. If sensitivity of the vector wrt to a property is to be calculated, then third arguement with the name of the property should be provided. </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l01147">1147</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>

<p>References <a class="el" href="_material_property_name_enums_8h_source.html#l00353">EMISSIVITY::num()</a>, <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// initialize the data structures for loads and their sensitivities</span>
  std::map&lt;unsigned int, std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt; &gt;::const_iterator 
  load_map_it, load_sens_map_it;
  std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt;::const_iterator 
  load_iterator, end_iterator,          <span class="comment">// iterators for the loads</span>
  load_sens_iterator;           <span class="comment">// iterators for the load sensitivities</span>
  
  <span class="comment">// if no loads exist return from the function with an arguement false</span>
  <span class="comment">// this implies that the quantity is zero and need not be processed</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;count(SURFACE_RADIATION_HEAT_LOAD::num()) == 0)
    <span class="keywordflow">return</span>;
  <span class="keywordflow">else</span>
    load_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;find(SURFACE_RADIATION_HEAT_LOAD::num());
                
  <span class="comment">// obtain the two iterators as separate values</span>
  load_iterator = load_map_it-&gt;second.begin();
  end_iterator = load_map_it-&gt;second.end();
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> side_num, n_sides;
  <span class="keywordtype">bool</span> load_on_elem_face;
  n_sides = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a28c863a4fa859e3b5725bb0688412806">geometric_elems_for_DV_map</a>.find(design_point_enum_ID)-&gt;second-&gt;n_sides();
        
  <span class="keywordtype">double</span> load_val, load_val_sens;
  load_val = 0.0; load_val_sens = 0.0;
        
  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> absolute_temp =
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a28478797fd744e7360306caca230b7be">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#ae2f9f30b83db8a3cb69787c283708210" title="stores analysis details">analysis_case</a>-&gt;getRealParameter(<span class="stringliteral">&quot;ABSOLUTE_TEMP&quot;</span>);
  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> sb_constant =
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a28478797fd744e7360306caca230b7be">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#ae2f9f30b83db8a3cb69787c283708210" title="stores analysis details">analysis_case</a>-&gt;getRealParameter(<span class="stringliteral">&quot;S_B_CONSTANT&quot;</span>);
                
  <span class="keywordtype">double</span> factor, factor_sens;

  <span class="comment">// process the load and update the element load vector.</span>
  <span class="keywordflow">for</span> (; load_iterator != end_iterator; load_iterator++)
    {
    side_num = load_iterator-&gt;second-&gt;getSurfaceID();
                
    <span class="comment">// for 2-D elements, the element face itself can carry a surface flux load.</span>
    load_on_elem_face = <span class="keyword">false</span>;
                
    <span class="keywordflow">if</span> (n_sides == side_num)
      load_on_elem_face = <span class="keyword">true</span>;
                
    factor = 0.0; factor_sens = 0.0;
    
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
      {
      <span class="keywordflow">case</span> 1:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor, THERMAL_EMITTED_LOAD_FACTOR::num());
          <span class="keywordflow">if</span> (sensitivity_calculation)
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>
            (factor_sens, THERMAL_EMITTED_LOAD_FACTOR::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>);
        }
        <span class="keywordflow">break</span>;
                                
      <span class="keywordflow">case</span> 2:
        {
          <span class="comment">// the integration will be different if the load is on the element face</span>
          <span class="keywordflow">if</span> (load_on_elem_face)
            {
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a6668a99eca477724cd612fa8c4bd7409" title="returns value from material card">getPropertyValueFromMaterialCard</a>(<a class="code" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6">EMISSIVITY::num</a>(),
                                                                         factor);
            
              <span class="keywordflow">if</span> (sensitivity_calculation)
                this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a6f76feccbf483acc763c05cf9bb48f72" title="returns value of the derivative of a property from the material card">getPropertyValueDerivativeForGlobalParameterFromMaterialCard</a>
              (<a class="code" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6">EMISSIVITY::num</a>(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
            }
          <span class="keywordflow">else</span> 
            {
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor, THERMAL_EMITTED_LOAD_FACTOR::num());
              <span class="keywordflow">if</span> (sensitivity_calculation)
                this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>
                (factor_sens, THERMAL_EMITTED_LOAD_FACTOR::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>);
            }
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">case</span> 3:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a6668a99eca477724cd612fa8c4bd7409" title="returns value from material card">getPropertyValueFromMaterialCard</a>(<a class="code" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6">EMISSIVITY::num</a>(),
                                                                     factor);
          <span class="keywordflow">if</span> (sensitivity_calculation)
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a6f76feccbf483acc763c05cf9bb48f72" title="returns value of the derivative of a property from the material card">getPropertyValueDerivativeForGlobalParameterFromMaterialCard</a>
            (<a class="code" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6">EMISSIVITY::num</a>(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
        }
        <span class="keywordflow">break</span>;
      }

    factor *= sb_constant;
    factor_sens *= sb_constant;         
    
 
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> domain = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a0a233a1ea240348c578b8c66947f59c1">getDomainEnumFromSideNumber</a>(side_num);
    
    <span class="keyword">static</span> DenseVector&lt;double&gt; qty_face, qty_sigma, qty_sigma_sens, qty_face_sens;
    qty_face.zero(); qty_sigma.zero(); qty_sigma_sens.zero(); qty_face_sens.zero();

    load_val = 
      <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_surface_radiation_load_combination.html">Loads::SurfaceRadiationLoadCombination</a>*<span class="keyword">&gt;</span>(load_iterator-&gt;second)-&gt;getTemperature();

    <span class="comment">// now, scale the matrix with the right factors to take into </span>
    <span class="comment">// account the sensitivity if needed</span>
    <span class="keywordflow">if</span> (sensitivity_calculation)
      {
      load_sens_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acba94cde0c083ff023592b46f2d6391e">surface_load_sens</a>-&gt;find(SURFACE_RADIATION_HEAT_LOAD::num());
      <span class="comment">// if the load exists, its sensitivity should also be specified</span>
      Assert(load_sens_map_it != this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acba94cde0c083ff023592b46f2d6391e">surface_load_sens</a>-&gt;end(),
             ExcInternalError());
      load_sens_iterator = load_sens_map_it-&gt;second.find(side_num);
      AssertThrow(load_sens_iterator != load_sens_map_it-&gt;second.end(),
                  ExcInternalError());
      
      load_val_sens = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_surface_radiation_load_combination.html">Loads::SurfaceRadiationLoadCombination</a>*<span class="keyword">&gt;</span>
        (load_sens_iterator-&gt;second)-&gt;getTemperature();
      
      
      <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
        {
        <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
          {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a0a926f5284f22b171288b3ba887c7208">getThermalElemQty</a>(FESystemElem::THERMAL_F_SIGMA_FACTOR::num(), 
                                    &amp;qty_sigma,  design_point_enum_ID,
                                    domain, <span class="keyword">false</span>);
            
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), &amp;qty_face, 
                                     design_point_enum_ID,
                                     domain, LAGRANGE);
            
            
            vector-&gt;add(-factor_sens, qty_sigma);
            
            vector-&gt;add((factor_sens * pow((load_val + absolute_temp), 4)+
                         4.0 * factor * pow((load_val + absolute_temp), 3) * load_val_sens), 
                        qty_face);
          }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
          {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), &amp;qty_face, 
                                     design_point_enum_ID, domain, LAGRANGE);
            
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a0a926f5284f22b171288b3ba887c7208">getThermalElemQty</a>
              (FESystemElem::THERMAL_F_SIGMA_FACTOR::num(), &amp;qty_sigma_sens, 
               design_point_enum_ID, domain, <span class="keyword">true</span>);
            
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>
              (FESystemElem::N_FACTOR::num(), &amp;qty_face_sens, domain, LAGRANGE);
            
            
            vector-&gt;add(-factor, qty_sigma_sens);
            vector-&gt;add(4.0 * factor * pow((load_val + absolute_temp), 3) * load_val_sens, 
                        qty_face);
            vector-&gt;add(factor * pow((load_val + absolute_temp), 4),
                        qty_face_sens);
          }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">default</span>:
          abort();
          <span class="keywordflow">break</span>;
        }
      }
    <span class="keywordflow">else</span>
      {
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a0a926f5284f22b171288b3ba887c7208">getThermalElemQty</a>(FESystemElem::THERMAL_F_SIGMA_FACTOR::num(), &amp;qty_sigma,
                              design_point_enum_ID, domain, <span class="keyword">false</span>);
      
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_FACTOR::num(), &amp;qty_face, 
                               design_point_enum_ID, domain, LAGRANGE);
      
      vector-&gt;add(-factor, qty_sigma);
      vector-&gt;add(factor * pow((load_val + absolute_temp), 4),
                  qty_face);
      }
    }
  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_elem_1_1_thermal_elem_ae27f28631b56d7c1763e30aeffc0125c_cgraph.gif" border="0" usemap="#class_f_e_system_elem_1_1_thermal_elem_ae27f28631b56d7c1763e30aeffc0125c_cgraph" alt=""/></div>
<map name="class_f_e_system_elem_1_1_thermal_elem_ae27f28631b56d7c1763e30aeffc0125c_cgraph" id="class_f_e_system_elem_1_1_thermal_elem_ae27f28631b56d7c1763e30aeffc0125c_cgraph">
<area shape="rect" id="node3" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6" title="EMISSIVITY::num" alt="" coords="374,5,503,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa5f991e4af393879446510bff34a8ea9"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_F_sigma_Jac" ref="aa5f991e4af393879446510bff34a8ea9" args="(DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#aa5f991e4af393879446510bff34a8ea9">FESystemElem::ThermalElem::calculate_F_sigma_Jac</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculated and returns the jacobian contribution from the radiation loads </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l01336">1336</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>

<p>References <a class="el" href="_material_property_name_enums_8h_source.html#l00353">EMISSIVITY::num()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// initialize the data structures for loads and their sensitivities</span>
  std::map&lt;unsigned int, std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt; &gt;::const_iterator 
  load_map_it, load_sens_map_it;
  std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt;::const_iterator 
  load_iterator, end_iterator,          <span class="comment">// iterators for the loads</span>
  load_sens_iterator;           <span class="comment">// iterators for the load sensitivities</span>
  
  <span class="comment">// if no loads exist return from the function with an arguement false</span>
  <span class="comment">// this implies that the quantity is zero and need not be processed</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;count(SURFACE_RADIATION_HEAT_LOAD::num()) == 0)
    <span class="keywordflow">return</span>;
  <span class="keywordflow">else</span>
    load_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;find(SURFACE_RADIATION_HEAT_LOAD::num());
                
  <span class="comment">// obtain the two iterators as separate values</span>
  load_iterator = load_map_it-&gt;second.begin();
  end_iterator = load_map_it-&gt;second.end();
  
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> side_num, n_sides;
  <span class="keywordtype">bool</span> load_on_elem_face;
  n_sides = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a28c863a4fa859e3b5725bb0688412806">geometric_elems_for_DV_map</a>.find(design_point_enum_ID)-&gt;second-&gt;n_sides();
        
  <span class="keywordtype">double</span> load_val, load_val_sens;
  load_val = 0.0; load_val_sens = 0.0;
        
  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> absolute_temp =
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a28478797fd744e7360306caca230b7be">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#ae2f9f30b83db8a3cb69787c283708210" title="stores analysis details">analysis_case</a>-&gt;getRealParameter(<span class="stringliteral">&quot;ABSOLUTE_TEMP&quot;</span>);
  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> sb_constant =
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a28478797fd744e7360306caca230b7be">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#ae2f9f30b83db8a3cb69787c283708210" title="stores analysis details">analysis_case</a>-&gt;getRealParameter(<span class="stringliteral">&quot;S_B_CONSTANT&quot;</span>);
  
  <span class="keywordtype">double</span> factor;

  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a985dd0dcf9494a99e82b8157b7755419" title="boolean for keeping track of whether this element is initialized or not">local_elem_is_initialized_for_DV_map</a>[design_point_enum_ID])
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a931293597ee8b5ae45fbc0e26efb1b2b">initialize_element</a>(design_point_enum_ID);

  <span class="comment">// process the load and update the element load vector.</span>
  <span class="keywordflow">for</span> (; load_iterator != end_iterator; load_iterator++)
    {
    side_num = load_iterator-&gt;second-&gt;getSurfaceID();
                
    <span class="comment">// for 2-D elements, the element face itself can carry a surface flux load.</span>
    load_on_elem_face = <span class="keyword">false</span>;
                
    FEBase *fe_base_local = NULL;
    QBase *qbase_local = NULL;
    <span class="keyword">const</span> std::vector&lt;std::vector&lt;Real&gt; &gt; *phi = NULL;
    <span class="keyword">const</span> std::vector&lt;Real&gt;* JxW = NULL;


      <span class="keywordflow">if</span> (n_sides == side_num)
      {
      load_on_elem_face = <span class="keyword">true</span>;
      fe_base_local = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a4641918ee8a42e1acfa9129447e40d45" title="finite element object for the element domain. This is stored for each design point.">fe_base_map_for_DV</a>[design_point_enum_ID][LAGRANGE];
      qbase_local = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acdf182ca5b844617c48bf453347ab771" title="quadrature rule for the element volume integration. This is stored for each design point...">qbase_map_for_DV</a>[design_point_enum_ID][LAGRANGE];
      }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a> &gt; 1)
      {
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#aaf5fa2e9663cee5dd3a0d09796995f43" title="initialized the element side given by the side number passed in the arguement">initialize_element_side</a>(side_num, design_point_enum_ID);
      fe_base_local = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#ac289e3c53bb21b509734498d57f6ad7e" title="finite element object for the side. This is stored for each design point.">fe_side_map_for_DV</a>[design_point_enum_ID][LAGRANGE];
      qbase_local = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#abb5a145789d2f70f366f9f13f41d94d4" title="quadrature rule for the side integration. This is stored for each design point.">qbase_side_map_for_DV</a>[design_point_enum_ID][LAGRANGE];
      }

      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a> &gt; 1)
        {
          JxW = &amp;(fe_base_local-&gt;get_JxW());
          phi = &amp;(fe_base_local-&gt;get_phi());
        }

    factor = 0.0; 
    
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
      {
      <span class="keywordflow">case</span> 1:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor, THERMAL_EMITTED_LOAD_FACTOR::num());
        }
        <span class="keywordflow">break</span>;
                                
      <span class="keywordflow">case</span> 2:
        {
          <span class="comment">// the integration will be different if the load is on the element face</span>
          <span class="keywordflow">if</span> (load_on_elem_face)
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a6668a99eca477724cd612fa8c4bd7409" title="returns value from material card">getPropertyValueFromMaterialCard</a>
              (<a class="code" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6">EMISSIVITY::num</a>(), factor);
          <span class="keywordflow">else</span> 
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor, THERMAL_EMITTED_LOAD_FACTOR::num());
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">case</span> 3:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a6668a99eca477724cd612fa8c4bd7409" title="returns value from material card">getPropertyValueFromMaterialCard</a>(<a class="code" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6">EMISSIVITY::num</a>(),
                                                                     factor);
        }
        <span class="keywordflow">break</span>;
      }
    
    factor *= (4.0 * sb_constant);
    
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
      {
      <span class="keywordflow">case</span> 1:
        {
          <span class="keywordflow">switch</span> (side_num)
            {
            <span class="keywordflow">case</span> 0:
              (*matrix)(0,0) += -factor * pow((this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26c3c4e9ea952cbc8a7de979f74e0fde" title="vector of element dof values">dof_values_vec</a>[0](0)+absolute_temp), 3);
              <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> 1:
              (*matrix)(1,1) += -factor * pow((this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26c3c4e9ea952cbc8a7de979f74e0fde" title="vector of element dof values">dof_values_vec</a>[0](1)+absolute_temp), 3);
              <span class="keywordflow">break</span>;
            <span class="keywordflow">default</span>:
              libmesh_error();
              <span class="keywordflow">break</span>;
            }
        }
        <span class="keywordflow">break</span>;
                                
      <span class="keywordflow">case</span> 2:
      <span class="keywordflow">case</span> 3:
        {
          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points = qbase_local-&gt;n_points();
          
          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp=0; qp&lt;n_q_points; qp++)
            {
            <span class="comment">// calculate the temperature at this quadrature point</span>
            <span class="keywordtype">double</span> temp = 0.0;
            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*phi).size(); i++)
              temp += (*phi)[i][qp]* this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26c3c4e9ea952cbc8a7de979f74e0fde" title="vector of element dof values">dof_values_vec</a>[0](i);
            
            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*phi).size(); i++)
              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;(*phi).size(); j++)
                (*matrix)(i,j) += - (*JxW)[qp]* factor * pow((temp+absolute_temp),3)*
                  ((*phi)[i][qp]* (*phi)[j][qp]);
            }
        }
        <span class="keywordflow">break</span>;
      }
    }   
  
  
  <span class="comment">// now, to add the effect of temperature dependent property, the following needs to be done. </span>
  <span class="comment">// the whole operation is simplified by directly using the radiative load</span>
  
  <span class="comment">// create a local static vector to be used for this computation</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  <span class="keyword">static</span> DenseVector&lt;double&gt; vec1(n_nodes);
  <span class="keywordtype">double</span> eps, eps_temp_sens;
  
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    {
    vec1.zero();
    eps = 0.0; eps_temp_sens = 0.0;
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#aad30d4f7ee3d410dda88c6671652c4ac" title="returns the assembled vector quantity for the element">getElementAssembledQty</a>(FESystemElem::THERMAL_F_EMITTED_RAD_VECTOR::num(),
                                 &amp;vec1);
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a6668a99eca477724cd612fa8c4bd7409" title="returns value from material card">getPropertyValueFromMaterialCard</a>(<a class="code" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6">EMISSIVITY::num</a>(), eps);
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a1cd322bb0fd663be7318845e1a7c39d6" title="returns value of the derivative of a property from the material card">getPropertyValueDerivativeForLocalParameterFromMaterialCard</a>
      (<a class="code" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6">EMISSIVITY::num</a>(), Property::TEMPERATURE::num(), eps_temp_sens);
    
    <span class="comment">// this scaling is based on the assumption that the property is calculated on the </span>
    <span class="comment">// average temperature per elem.</span>
    vec1.scale(eps_temp_sens / (1.0 * n_nodes) / eps);
    
    <span class="comment">// now add this to the vector</span>
    <span class="keywordtype">double</span> val = 0.0;
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes; i++)
      {
      val = vec1(i);
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_nodes; j++)
        (*matrix)(i,j) += val;
      }
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_elem_1_1_thermal_elem_aa5f991e4af393879446510bff34a8ea9_cgraph.gif" border="0" usemap="#class_f_e_system_elem_1_1_thermal_elem_aa5f991e4af393879446510bff34a8ea9_cgraph" alt=""/></div>
<map name="class_f_e_system_elem_1_1_thermal_elem_aa5f991e4af393879446510bff34a8ea9_cgraph" id="class_f_e_system_elem_1_1_thermal_elem_aa5f991e4af393879446510bff34a8ea9_cgraph">
<area shape="rect" id="node3" href="class_e_m_i_s_s_i_v_i_t_y.html#a06efa255fa8f614eed83ae956748e9e6" title="EMISSIVITY::num" alt="" coords="401,5,530,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2c6ec1d90e13aacb2226e18bb9e037ff"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_K_c" ref="a2c6ec1d90e13aacb2226e18bb9e037ff" args="(DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a2c6ec1d90e13aacb2226e18bb9e037ff">FESystemElem::ThermalElem::calculate_K_c</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to calculate the element conductance matrix. The first arguement is the matrix that will be resized to the appropriate size, and filled with the matrix elements. If sensitivity of the matrix wrt to a property is to be calculated, then second arguement with the name of the property should be provided. </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00334">334</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>

<p>References <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> <span class="keywordtype">double</span> factor, factor_sens; 
  factor = 0.0, factor_sens = 0.0; 
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor, THERMAL_CONDUCTANCE_FACTOR::num());
  <span class="keywordflow">if</span> (sensitivity_calculation &amp;&amp; 
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a> == DesignData::PROPERTY_PARAMETER::num())
    {
    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#abc346451898593d3646b745240c2e739">checkElemAndMaterialCardGlobalParameterDependence</a>
        (this-&gt;sensitivity_parameter_ID))
      <span class="keywordflow">return</span>;
    
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>
      (factor_sens, THERMAL_CONDUCTANCE_FACTOR::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>);
    }
  
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; mat;

  <span class="keywordflow">if</span> (sensitivity_calculation)
    {
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
      {
      <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
        {
          <span class="keywordflow">switch</span> ( this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
            {
            <span class="keywordflow">case</span> 3:
              {
                mat.zero();
                <span class="comment">// get the factors and add them to the matrix dN/dx * dN/dx</span>
                this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Z_N_Z_FACTOR::num(), &amp;mat, 
                                         design_point_enum_ID,
                                         FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
                matrix-&gt;add(1.0, mat);
              }
              
            <span class="keywordflow">case</span> 2:
              {
                <span class="comment">// dN/dy * dN/dy</span>
                mat.zero();
                this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Y_N_Y_FACTOR::num(), &amp;mat, 
                                         design_point_enum_ID,
                                         FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
                matrix-&gt;add(1.0, mat);
              }
              
              <span class="keywordflow">case</span> 1:
              {
                mat.zero();
                <span class="comment">// get the factors and add them to the matrix dN/dx * dN/dx</span>
                this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_X_FACTOR::num(), &amp;mat, 
                                         design_point_enum_ID,
                                         FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
                matrix-&gt;add(1.0, mat);
              }
              <span class="keywordflow">break</span>;
             
              <span class="keywordflow">default</span>:
                abort();
            }
          
          matrix-&gt;scale(factor_sens);
        }
        <span class="keywordflow">break</span>;
                                
      <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
        {
          <span class="keywordflow">switch</span> ( this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
            {
            <span class="keywordflow">case</span> 3:
              {
                <span class="comment">// get the factors and add them to the matrix dN/dx * dN/dx</span>
                mat.zero();
                this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>
                  (FESystemElem::N_Z_N_Z_FACTOR::num(), &amp;mat,
                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
                matrix-&gt;add(1.0, mat);
              }
              
            <span class="keywordflow">case</span> 2:
              {  
                <span class="comment">// dN/dy * dN/dy</span>
                mat.zero();
                this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>
                  (FESystemElem::N_Y_N_Y_FACTOR::num(), &amp;mat, 
                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
                matrix-&gt;add(1.0, mat);
              }
              
            <span class="keywordflow">case</span> 1:
              {
                <span class="comment">// get the factors and add them to the matrix dN/dx * dN/dx</span>
                mat.zero();
                this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>
                  (FESystemElem::N_X_N_X_FACTOR::num(), &amp;mat,
                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
                matrix-&gt;add(1.0, mat);
              }
              <span class="keywordflow">break</span>;
              
            <span class="keywordflow">default</span>:
              abort();
            }
          
          matrix-&gt;scale(factor);
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">default</span>:
        abort();
        <span class="keywordflow">break</span>;
      }
    }
  <span class="keywordflow">else</span> 
    {
    <span class="keywordflow">switch</span> ( this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
      {
      <span class="keywordflow">case</span> 3:
        {
          mat.zero();
          <span class="comment">// get the factors and add them to the matrix dN/dx * dN/dx</span>
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Z_N_Z_FACTOR::num(), &amp;mat, 
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          matrix-&gt;add(1.0, mat);
        }
        
      <span class="keywordflow">case</span> 2:
        {
          <span class="comment">// dN/dy * dN/dy</span>
          mat.zero();
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Y_N_Y_FACTOR::num(), &amp;mat, 
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          matrix-&gt;add(1.0, mat);
        }
        
      <span class="keywordflow">case</span> 1:
        {
          mat.zero();
          <span class="comment">// get the factors and add them to the matrix dN/dx * dN/dx</span>
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_X_FACTOR::num(), &amp;mat, 
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          matrix-&gt;add(1.0, mat);
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">default</span>:
        abort();
      }
    
    matrix-&gt;scale(factor);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6de794cce348a820cd1ba5833c942fa2"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_K_c_Jac" ref="a6de794cce348a820cd1ba5833c942fa2" args="(DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a6de794cce348a820cd1ba5833c942fa2">FESystemElem::ThermalElem::calculate_K_c_Jac</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to calculate the conductance of element conductance matrix. The first arguement is the matrix that will be resized to the appropriate size, and filled with the matrix elements. This quantity exists only when the material properties are temperature dependent. Otherwise, it is zero </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00497">497</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    <span class="keywordflow">return</span>;
  
  <span class="keyword">static</span> <span class="keywordtype">double</span> factor; 
  factor = 0.0; 
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55">getFactorSensitivityForLocalParameter</a>
    (factor, THERMAL_CONDUCTANCE_FACTOR::num(), Property::TEMPERATURE::num());

  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  
  <span class="comment">// it is assumed that the matrices and vectors remain the same size as </span>
  <span class="comment">// created here. Hence, they are not resized again.</span>
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; mat1(n_nodes, n_nodes), mat2(n_nodes, n_nodes);
  <span class="keyword">static</span> DenseVector&lt;double&gt; vec2(n_nodes);
  <span class="keywordflow">if</span> ((vec2.size() != n_nodes))
    {
    vec2.resize(n_nodes);
    mat1.resize(n_nodes, n_nodes); mat2.resize(n_nodes, n_nodes);
    }

  vec2.zero();  
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)  <span class="comment">// get the factors and add them to the matrix dN/dx * dN/dx</span>
    {
    <span class="keywordflow">case</span> 3:
      {
        mat1.zero(); mat2.zero();
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Z_N_Z_FACTOR::num(), &amp;mat1, 
                                 design_point_enum_ID,
                                 FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
        mat2.add(1.0, mat1);
      }
      
    <span class="keywordflow">case</span> 2:
      {
        <span class="comment">// dN/dy * dN/dy</span>
        mat1.zero(); mat2.zero();
        mat1.zero();
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Y_N_Y_FACTOR::num(), &amp;mat1, 
                                 design_point_enum_ID,
                                 FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
        mat2.add(1.0, mat1);
      }
      
    <span class="keywordflow">case</span> 1:
      {
        mat1.zero(); mat2.zero();
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_X_FACTOR::num(), &amp;mat1,
                                 design_point_enum_ID,
                                 FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
        mat2.add(1.0, mat1);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      abort();
    }
  
  mat2.scale(factor / (1.0 * n_nodes));
  
  mat2.right_multiply_vector(this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26c3c4e9ea952cbc8a7de979f74e0fde" title="vector of element dof values">dof_values_vec</a>[0], vec2);
  
  <span class="comment">// now, this vector has to be placed inside the jacobian matrix</span>
  <span class="keyword">static</span> <span class="keywordtype">double</span> value = 0.0;
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes; i++)
    {
    value = vec2(i);
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; n_nodes; j++)
      (*matrix)(i,j) = value;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5b81aeb1aa6d2d8749746d4517b47f1a"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculate_K_h" ref="a5b81aeb1aa6d2d8749746d4517b47f1a" args="(DenseMatrix&lt; double &gt; *matrix, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a5b81aeb1aa6d2d8749746d4517b47f1a">FESystemElem::ThermalElem::calculate_K_h</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to calculate the element capacitance matrix contribution due to surface convection load. The first arguement is the matrix that will be resized to the appropriate size, and filled with the matrix elements. The second arguement should be the vector of surface convection loads for the element. If sensitivity of the matrix wrt to a property is to be calculated, then third arguement with the name of the property should be provided. </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00578">578</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>

<p>References <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// initialize the data structures for loads and their sensitivities</span>
  std::map&lt;unsigned int, std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt; &gt;::const_iterator 
    load_map_it, load_sens_map_it;
  std::map&lt;unsigned int, const Loads::SurfaceLoadCombination*&gt;::const_iterator 
  load_iterator, end_iterator,          <span class="comment">// iterators for the loads</span>
  load_sens_iterator;           <span class="comment">// iterators for the load sensitivities</span>
  
  <span class="comment">// if no loads exist return from the function with an arguement false</span>
  <span class="comment">// this implies that the quantity is zero and need not be processed</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;count(SURFACE_CONVECTION_HEAT_LOAD::num()) == 0)
    <span class="keywordflow">return</span>;
  <span class="keywordflow">else</span>
    load_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3d7fda463ee208755f71aaf57b1b4c71">surface_loads</a>-&gt;find(SURFACE_CONVECTION_HEAT_LOAD::num());
        
  <span class="comment">// obtain the two iterators as separate values</span>
  load_iterator = load_map_it-&gt;second.begin();
  end_iterator = load_map_it-&gt;second.end();
          
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> side_num;
  <span class="keywordtype">bool</span> load_on_elem_face;
         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sides;
  n_sides = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a28c863a4fa859e3b5725bb0688412806">geometric_elems_for_DV_map</a>.find(design_point_enum_ID)-&gt;second-&gt;n_sides();
  
  <span class="keywordtype">double</span> load_val, load_val_sens;
  load_val = 0.0; load_val_sens = 0.0;

  <span class="comment">// process the load and update the element load vector.</span>
  <span class="keywordflow">for</span> (; load_iterator != end_iterator; load_iterator++)
    {
    side_num = load_iterator-&gt;second-&gt;getSurfaceID();
                
    <span class="comment">// for 2-D elements, the element face itself can carry a surface flux load.</span>
    load_on_elem_face = <span class="keyword">false</span>;
                
    <span class="keywordflow">if</span> (n_sides == side_num)
      load_on_elem_face = <span class="keyword">true</span>;
                
    <span class="keywordtype">double</span> factor, factor_sens;
    factor = 0.0; factor_sens = 0.0;
    
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
      {
      <span class="keywordflow">case</span> 1:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#aa4029e1e403519cf9003458d2d788e65" title="this method returns the value of a property">getPropertyValue</a>(AREA::num(), factor);
          <span class="keywordflow">if</span> (sensitivity_calculation)
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#a530325d5a9a887c5ae7919ac04a5b89b">getPropertyDerivativeForGlobalParameter</a>
              (AREA::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
        }
        <span class="keywordflow">break</span>;
                                
      <span class="keywordflow">case</span> 2:
        {
          <span class="comment">// the integration will be different if the load is on the element face</span>
          <span class="keywordflow">if</span> (load_on_elem_face)
            {
            factor =  1.0;
            factor_sens = 0.0;
            }
          <span class="keywordflow">else</span> 
            {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#aa4029e1e403519cf9003458d2d788e65" title="this method returns the value of a property">getPropertyValue</a>(THICKNESS_2D_ELEM::num(), factor);
            <span class="keywordflow">if</span> (sensitivity_calculation)
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_property_1_1_property_card_3_01double_01_4.html#a530325d5a9a887c5ae7919ac04a5b89b">getPropertyDerivativeForGlobalParameter</a>
                (THICKNESS_2D_ELEM::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>, factor_sens);
            }
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">case</span> 3:
        {
          factor = 1.0;
          factor_sens = 0.0;
        }
        <span class="keywordflow">break</span>;
      }
                
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> domain = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a0a233a1ea240348c578b8c66947f59c1">getDomainEnumFromSideNumber</a>(side_num);
    
    load_val = 
      <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_loads_1_1_surface_convection_load_combination.html">Loads::SurfaceConvectionLoadCombination</a>*<span class="keyword">&gt;</span>(load_iterator-&gt;second)-&gt;getConvectionCoeff();
    
    <span class="keywordflow">if</span> (sensitivity_calculation)
      {
      load_sens_map_it = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acba94cde0c083ff023592b46f2d6391e">surface_load_sens</a>-&gt;find(SURFACE_CONVECTION_HEAT_LOAD::num());
      <span class="comment">// if the load exists, its sensitivity should also be specified</span>
      Assert(load_sens_map_it != this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acba94cde0c083ff023592b46f2d6391e">surface_load_sens</a>-&gt;end(),
             ExcInternalError());
      load_sens_iterator = load_sens_map_it-&gt;second.find(side_num);
      AssertThrow(load_sens_iterator != load_sens_map_it-&gt;second.end(),
             ExcInternalError());
      
      load_val_sens = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_surface_convection_load.html">SurfaceConvectionLoad</a>*<span class="keyword">&gt;</span>
        (load_sens_iterator-&gt;second)-&gt;getConvectionCoeff();

      
      <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
        {
        <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
          {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), matrix, 
                                     design_point_enum_ID,
                                     domain, LAGRANGE);
            matrix-&gt;scale(factor * load_val_sens + factor_sens * load_val);
          }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
          {
            <span class="keyword">static</span> DenseMatrix&lt;double&gt; qty, qty_sens;
            qty.zero(); qty_sens.zero();
            
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), &amp;qty,
                                     design_point_enum_ID,
                                     domain, LAGRANGE);
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>(FESystemElem::N_N_FACTOR::num(), 
                                                     &amp;qty_sens, domain, LAGRANGE);
            
            qty.scale(factor * load_val_sens);
            qty_sens.scale(factor * load_val);
            
            matrix-&gt;add(1.0, qty);
            matrix-&gt;add(1.0, qty_sens);
          }
          <span class="keywordflow">break</span>;
          
        <span class="keywordflow">default</span>:
          abort();
          <span class="keywordflow">break</span>;
        }
      }
    <span class="keywordflow">else</span>
      {
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), matrix, 
                               design_point_enum_ID,
                               domain, LAGRANGE);
      matrix-&gt;scale(factor * load_val);
      }
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4b92c18aa9764afb97ad95478814617f"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculateAssembledQty" ref="a4b92c18aa9764afb97ad95478814617f" args="(DenseMatrix&lt; double &gt; *, const unsigned int qty_enum_ID, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a4b92c18aa9764afb97ad95478814617f">FESystemElem::ThermalElem::calculateAssembledQty</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>quantity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qty_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to direct the call to appropriate calculation routine based on the quantity seeked. The arguements are: </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pointer</td><td>of quantity to return the data in </td></tr>
    <tr><td class="paramname">quantity</td><td>name </td></tr>
    <tr><td class="paramname">bool</td><td>specifying if sensitivity has been asked </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00083">83</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert (quantity != NULL);
  
  <span class="comment">// make sure that if sensitivity is being requested, it is at the base point</span>
  <span class="keywordflow">if</span>(sensitivity_calc)
    Assert (design_point_enum_ID == FESystemElem::BASE_ELEM::num(), 
            ExcInternalError());
  
  
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  
  <span class="keywordflow">if</span> (!(quantity-&gt;m() == n_nodes &amp;&amp; quantity-&gt;n() == n_nodes))
    {
    quantity-&gt;resize(n_nodes, n_nodes);
    quantity-&gt;zero();
    }
  
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a11a2c563875d371ec536f90ee4111a90" title="boolean for keeping track of whether the property card was initialized">property_card_initialized</a>)
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a58c8e9789a990f6ff03c4c622038f109">initPropertyCard</a>();
  
  <span class="keywordflow">switch</span> (qty_name)
    {
    <span class="keywordflow">case</span> THERMAL_C_MATRIX_ENUM_ID:
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#ad19fe324123691d125c1128b4c186333">calculate_C</a>(quantity, design_point_enum_ID, sensitivity_calc);
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span> THERMAL_K_C_MATRIX_ENUM_ID:
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a2c6ec1d90e13aacb2226e18bb9e037ff">calculate_K_c</a>(quantity, design_point_enum_ID, sensitivity_calc);
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span> THERMAL_K_H_MATRIX_ENUM_ID:
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a5b81aeb1aa6d2d8749746d4517b47f1a">calculate_K_h</a>(quantity, design_point_enum_ID, sensitivity_calc);
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span> THERMAL_EMITTED_RAD_JAC_MATRIX_ENUM_ID:
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#aa5f991e4af393879446510bff34a8ea9" title="calculated and returns the jacobian contribution from the radiation loads">calculate_F_sigma_Jac</a>(quantity, design_point_enum_ID);
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span> THERMAL_K_C_JAC_MATRIX_ENUM_ID:
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a6de794cce348a820cd1ba5833c942fa2">calculate_K_c_Jac</a>(quantity, design_point_enum_ID);
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> THERMAL_C_JAC_MATRIX_ENUM_ID:
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a4773a287529b4a0dcf11617da7a0b125">calculate_C_Jac</a>(quantity, design_point_enum_ID);
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> THERMAL_F_H_VECTOR_ENUM_ID:
    <span class="keywordflow">case</span> THERMAL_F_VOL_VECTOR_ENUM_ID:
    <span class="keywordflow">case</span> THERMAL_F_Q_SURF_VECTOR_ENUM_ID:
    <span class="keywordflow">case</span> THERMAL_F_EMITTED_RAD_VECTOR_ENUM_ID:
    <span class="keywordflow">default</span>:
      abort();
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4f4eb8585aa9bce26fee1b5d946eec56"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculateAssembledQty" ref="a4f4eb8585aa9bce26fee1b5d946eec56" args="(DenseVector&lt; double &gt; *, const unsigned int qty_enum_ID, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a4b92c18aa9764afb97ad95478814617f">FESystemElem::ThermalElem::calculateAssembledQty</a> </td>
          <td>(</td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>quantity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qty_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function to direct the call to appropriate calculation routine based on the quantity seeked. The arguements are: </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pointer</td><td>of quantity to return the data in </td></tr>
    <tr><td class="paramname">quantity</td><td>name </td></tr>
    <tr><td class="paramname">bool</td><td>specifying if sensitivity has been asked </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00146">146</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert (quantity != NULL);

  <span class="comment">// make sure that if sensitivity is being requested, it is at the base point</span>
  <span class="keywordflow">if</span>(sensitivity_calc)
    Assert (design_point_enum_ID == FESystemElem::BASE_ELEM::num(), 
            ExcInternalError());
    
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  
  <span class="keywordflow">if</span> (quantity-&gt;size() != n_nodes)
    {
    quantity-&gt;resize(n_nodes);
    quantity-&gt;zero();
    }
  
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a11a2c563875d371ec536f90ee4111a90" title="boolean for keeping track of whether the property card was initialized">property_card_initialized</a>)
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a58c8e9789a990f6ff03c4c622038f109">initPropertyCard</a>();
  

  <span class="keywordflow">switch</span> (qty_name)
    {
    <span class="keywordflow">case</span> THERMAL_F_H_VECTOR_ENUM_ID:
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a01cf3b54758f8b2138ca80e12ea20cd9">calculate_F_h</a>(quantity,      design_point_enum_ID, sensitivity_calc);
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span> THERMAL_F_VOL_VECTOR_ENUM_ID:
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a94002158ad218d837097c996653a1266">calculate_F_Qvol</a>(quantity, design_point_enum_ID, sensitivity_calc);
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span> THERMAL_F_Q_SURF_VECTOR_ENUM_ID:
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a171342122f53fd9f5ba0bff3a26a9374">calculate_F_qsurf</a>(quantity, design_point_enum_ID, sensitivity_calc);
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">case</span> THERMAL_F_EMITTED_RAD_VECTOR_ENUM_ID:
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#ae27f28631b56d7c1763e30aeffc0125c">calculate_F_sigma</a>(quantity, design_point_enum_ID, sensitivity_calc);
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> THERMAL_C_MATRIX_ENUM_ID:
    <span class="keywordflow">case</span> THERMAL_K_C_MATRIX_ENUM_ID:
    <span class="keywordflow">case</span> THERMAL_K_H_MATRIX_ENUM_ID:
    <span class="keywordflow">case</span> THERMAL_EMITTED_RAD_JAC_MATRIX_ENUM_ID:
    <span class="keywordflow">case</span> THERMAL_K_C_JAC_MATRIX_ENUM_ID:
    <span class="keywordflow">default</span>:
      abort();
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a21e06dbbd2bb8d90dbafaa9027075931"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculateEmittedRadiationLoadFactor" ref="a21e06dbbd2bb8d90dbafaa9027075931" args="(DenseVector&lt; double &gt; *load_factor, const unsigned int design_point_enum_ID, const unsigned int domain)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a21e06dbbd2bb8d90dbafaa9027075931">FESystemElem::ThermalElem::calculateEmittedRadiationLoadFactor</a> </td>
          <td>(</td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>load_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>domain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>this calculates the factor for emitted radiation factor </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l01519">1519</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> absolute_temp =
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a28478797fd744e7360306caca230b7be">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#ae2f9f30b83db8a3cb69787c283708210" title="stores analysis details">analysis_case</a>-&gt;getRealParameter(<span class="stringliteral">&quot;ABSOLUTE_TEMP&quot;</span>);

  <span class="comment">// for 2-D elements, the element face itself can carry a surface flux load.</span>
  <span class="keywordtype">bool</span> load_on_elem_face;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> side_num;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sides;
  n_sides = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a28c863a4fa859e3b5725bb0688412806">geometric_elems_for_DV_map</a>.find(design_point_enum_ID)-&gt;second-&gt;n_sides();

  side_num = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a2456ffd9718f6b42e4ef16d066020a89">getSideNumberFromDomainEnum</a>(domain);
  load_on_elem_face = <span class="keyword">false</span>;
  
  FEBase *fe_base_local = NULL;
  QBase *qbase_local = NULL;
  <span class="keyword">const</span> std::vector&lt;std::vector&lt;Real&gt; &gt; *phi = NULL;
  <span class="keyword">const</span> std::vector&lt;Real&gt;* JxW = NULL;
  
  <span class="keywordflow">if</span> (n_sides == side_num)
    {
    load_on_elem_face = <span class="keyword">true</span>;
    fe_base_local = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a4641918ee8a42e1acfa9129447e40d45" title="finite element object for the element domain. This is stored for each design point.">fe_base_map_for_DV</a>[design_point_enum_ID][LAGRANGE];
    qbase_local = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acdf182ca5b844617c48bf453347ab771" title="quadrature rule for the element volume integration. This is stored for each design point...">qbase_map_for_DV</a>[design_point_enum_ID][LAGRANGE];
    }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a> &gt; 1)
    {
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#aaf5fa2e9663cee5dd3a0d09796995f43" title="initialized the element side given by the side number passed in the arguement">initialize_element_side</a>(side_num, design_point_enum_ID);
    fe_base_local = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#ac289e3c53bb21b509734498d57f6ad7e" title="finite element object for the side. This is stored for each design point.">fe_side_map_for_DV</a>[design_point_enum_ID][LAGRANGE];
    qbase_local = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#abb5a145789d2f70f366f9f13f41d94d4" title="quadrature rule for the side integration. This is stored for each design point.">qbase_side_map_for_DV</a>[design_point_enum_ID][LAGRANGE];
    }
  
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a> &gt; 1)
    {
    JxW = &amp;(fe_base_local-&gt;get_JxW());
    phi = &amp;(fe_base_local-&gt;get_phi());
    }

  DenseVector&lt;double&gt;&amp; vec_ref = *vector;
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a64b94b8ee8c56abfdf2bfeb2db8f5212" title="dimension of the element">dimension</a>)
    {
    <span class="keywordflow">case</span> 1:
      {
        <span class="keywordflow">switch</span> (side_num)
          {
          <span class="keywordflow">case</span> 0:
            vec_ref(0) += pow((this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26c3c4e9ea952cbc8a7de979f74e0fde" title="vector of element dof values">dof_values_vec</a>[0](0)+absolute_temp), 4);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">case</span> 1:
            vec_ref(1) += pow((this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26c3c4e9ea952cbc8a7de979f74e0fde" title="vector of element dof values">dof_values_vec</a>[0](1)+absolute_temp), 4);
            <span class="keywordflow">break</span>;
          <span class="keywordflow">default</span>:
            libmesh_error();
            <span class="keywordflow">break</span>;
          }
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> 2:
    <span class="keywordflow">case</span> 3:
      {
        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points = qbase_local-&gt;n_points();
        <span class="keywordtype">double</span> temp_power=0.0, temp = 0.0;
        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp=0; qp&lt;n_q_points; qp++)
          {
          <span class="comment">// calculate the temperature at this quadrature point</span>
          temp = 0.0;
          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*phi).size(); i++)
            temp += (*phi)[i][qp]* this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26c3c4e9ea952cbc8a7de979f74e0fde" title="vector of element dof values">dof_values_vec</a>[0](i);
          temp_power = pow(temp+absolute_temp, 4);
          
          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;(*phi).size(); i++)
            vec_ref(i) += (*JxW)[qp]* (*phi)[i][qp] * temp_power;
          }
      }        
      <span class="keywordflow">break</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5d19a7188c02c52d4c312026bcd385a5"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculateThermalElemQty" ref="a5d19a7188c02c52d4c312026bcd385a5" args="(DenseVector&lt; double &gt; *qty, const unsigned int qty_enum_ID, const unsigned int design_point_enum_ID, const unsigned int domain_enum_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a5d19a7188c02c52d4c312026bcd385a5">FESystemElem::ThermalElem::calculateThermalElemQty</a> </td>
          <td>(</td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>qty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qty_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>domain_enum_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this method is an interface to the specific functions to calculate element quantities. It calls the method that performs the calculations and returns the quantity in the first arguement. </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l01659">1659</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert (quantity != NULL);
        
  <span class="comment">// check if the local element has been initialized or not. If not, </span>
  <span class="comment">// initialize it, also, resize the quantity</span>
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a985dd0dcf9494a99e82b8157b7755419" title="boolean for keeping track of whether this element is initialized or not">local_elem_is_initialized_for_DV_map</a>.find(design_point_enum_ID)-&gt;second)
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a931293597ee8b5ae45fbc0e26efb1b2b">initialize_element</a>(design_point_enum_ID);
  
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  
  <span class="keywordflow">if</span> ((quantity-&gt;size() != n_nodes))
    {
    quantity-&gt;resize(n_nodes);
    quantity-&gt;zero();
    }
  
  <span class="keywordflow">switch</span>(qty_name)
    {
    <span class="keywordflow">case</span> THERMAL_F_SIGMA_FACTOR_ENUM_ID:
      {
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a21e06dbbd2bb8d90dbafaa9027075931" title="this calculates the factor for emitted radiation factor">calculateEmittedRadiationLoadFactor</a>(quantity, design_point_enum_ID, domain);
      }
      <span class="keywordflow">break</span>;
                        
    <span class="keywordflow">default</span>:
      abort();
      <span class="keywordflow">break</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad2e225b9e66c5bcc7dc983e14eadbc24"></a><!-- doxytag: member="FESystemElem::ThermalElem::calculateThermalElemQty" ref="ad2e225b9e66c5bcc7dc983e14eadbc24" args="(DenseMatrix&lt; double &gt; *qty, const unsigned int qty_enum_ID, const unsigned int design_point_enum_ID, const unsigned int domain_enum_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a5d19a7188c02c52d4c312026bcd385a5">FESystemElem::ThermalElem::calculateThermalElemQty</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>qty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qty_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>domain_enum_ID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this method is an interface to the specific functions to calculate element quantities. It calls the method that performs the calculations and returns the quantity in the first arguement. </p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l01622">1622</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// unused parameter here</span>
  (void) domain;

  assert (quantity != NULL);
  
  <span class="comment">// check if the local element has been initialized or not. If not, </span>
  <span class="comment">// initialize it, also, resize the quantity</span>
  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a985dd0dcf9494a99e82b8157b7755419" title="boolean for keeping track of whether this element is initialized or not">local_elem_is_initialized_for_DV_map</a>.find(design_point_enum_ID)-&gt;second)
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a931293597ee8b5ae45fbc0e26efb1b2b">initialize_element</a>(design_point_enum_ID);
  
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  
  <span class="keywordflow">if</span> (!(quantity-&gt;m() == n_nodes &amp;&amp; quantity-&gt;n() == n_nodes))
    {
    quantity-&gt;resize(n_nodes, n_nodes);
    quantity-&gt;zero();
    }
  
  <span class="keywordflow">switch</span>(qty_name)
    {
    <span class="keywordflow">case</span> THERMAL_F_SIGMA_FACTOR_ENUM_ID:
    <span class="keywordflow">default</span>:
      abort();
      <span class="keywordflow">break</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a9050fbb17fc569e2440de56ec8eef98c"></a><!-- doxytag: member="FESystemElem::ThermalElem::clearPropertyCardInitialization" ref="a9050fbb17fc569e2440de56ec8eef98c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a9050fbb17fc569e2440de56ec8eef98c">FESystemElem::ThermalElem::clearPropertyCardInitialization</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>this clears the temperature initialization only for the property cards. </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a20f20f167cd63cd88fbed89f5f4fa6c8">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l01730">1730</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> std::vector&lt;unsigned int&gt; param_vec;
  <span class="keyword">static</span> std::vector&lt;unsigned int&gt; no_param_vec;
  
  <span class="keywordflow">if</span> (param_vec.size() != 0)
   param_vec.push_back(Property::TEMPERATURE::num());
  
  <span class="comment">// if the properties are temperature dependent, then initialize the</span>
  <span class="comment">// element property cards at the element average temperature</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#ab50a2a6c9317349ae278ad3859c103b5">partialClearElemAndMaterialCardLocalParameterInitialization</a>
      (param_vec);
  <span class="keywordflow">else</span>
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#ab50a2a6c9317349ae278ad3859c103b5">partialClearElemAndMaterialCardLocalParameterInitialization</a>
      (no_param_vec);
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a11a2c563875d371ec536f90ee4111a90" title="boolean for keeping track of whether the property card was initialized">property_card_initialized</a> = <span class="keyword">false</span>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aad30d4f7ee3d410dda88c6671652c4ac"></a><!-- doxytag: member="FESystemElem::ThermalElem::getElementAssembledQty" ref="aad30d4f7ee3d410dda88c6671652c4ac" args="(const unsigned int name_enum_ID, DenseVector&lt; double &gt; *qty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#aad30d4f7ee3d410dda88c6671652c4ac">FESystemElem::ThermalElem::getElementAssembledQty</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>name_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>qty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns the assembled vector quantity for the element </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a954c0e79b36f7f43d245dd5bddc3a134">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8h_source.html#l00453">453</a> of file <a class="el" href="thermal__elem_8h_source.html">thermal_elem.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(qty != NULL, ExcInternalError());
  qty-&gt;zero();
  
  <span class="comment">// get the quantity at the base design point</span>
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a4b92c18aa9764afb97ad95478814617f">calculateAssembledQty</a>(qty, name_enum_ID, FESystemElem::BASE_ELEM::num(), <span class="keyword">false</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a8b90454e88d6733419c026422ae92465"></a><!-- doxytag: member="FESystemElem::ThermalElem::getElementAssembledQty" ref="a8b90454e88d6733419c026422ae92465" args="(const unsigned int name_enum_ID, DenseMatrix&lt; double &gt; *qty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#aad30d4f7ee3d410dda88c6671652c4ac">FESystemElem::ThermalElem::getElementAssembledQty</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>name_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>qty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns the assembled matrix quantity for the element </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a6487dc5224dd94a2a5f5781a7960e556">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8h_source.html#l00466">466</a> of file <a class="el" href="thermal__elem_8h_source.html">thermal_elem.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(qty != NULL, ExcInternalError());
  qty-&gt;zero();

  <span class="comment">// get the quantity</span>
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a4b92c18aa9764afb97ad95478814617f">calculateAssembledQty</a>(qty, name_enum_ID, FESystemElem::BASE_ELEM::num(), <span class="keyword">false</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="abc6e975ec8a9274d9ccdc984852af1fa"></a><!-- doxytag: member="FESystemElem::ThermalElem::getElementAssembledQtySensitivity" ref="abc6e975ec8a9274d9ccdc984852af1fa" args="(const unsigned int name_enum_ID, DenseVector&lt; double &gt; *qty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#abc6e975ec8a9274d9ccdc984852af1fa">FESystemElem::ThermalElem::getElementAssembledQtySensitivity</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>name_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>qty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns the assembled matrix quantity sensitivity for the element </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a031f53305deffce69d9f98098475fce3">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8h_source.html#l00480">480</a> of file <a class="el" href="thermal__elem_8h_source.html">thermal_elem.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert (qty != NULL);
  qty-&gt;zero();
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a4b92c18aa9764afb97ad95478814617f">calculateAssembledQty</a>(qty, name_enum_ID, FESystemElem::BASE_ELEM::num(),
                              <span class="keyword">true</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae78703e32d2d202aa04d8fcd48d22d3e"></a><!-- doxytag: member="FESystemElem::ThermalElem::getElementAssembledQtySensitivity" ref="ae78703e32d2d202aa04d8fcd48d22d3e" args="(const unsigned int name_enum_ID, DenseMatrix&lt; double &gt; *qty)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#abc6e975ec8a9274d9ccdc984852af1fa">FESystemElem::ThermalElem::getElementAssembledQtySensitivity</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>name_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>qty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns the assembled matrix quantity sensitivity for the element </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a734f6d0f7dc1f816de3bf757c5bea962">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8h_source.html#l00494">494</a> of file <a class="el" href="thermal__elem_8h_source.html">thermal_elem.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  assert (qty != NULL);
  qty-&gt;zero();
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a4b92c18aa9764afb97ad95478814617f">calculateAssembledQty</a>(qty, name_enum_ID, FESystemElem::BASE_ELEM::num(),
                              <span class="keyword">true</span>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a846a008053337a7f64e51c1675cffd91"></a><!-- doxytag: member="FESystemElem::ThermalElem::getElementPostProcessQty" ref="a846a008053337a7f64e51c1675cffd91" args="(std::vector&lt; unsigned int &gt; load_cases, std::vector&lt; DesignData::DesignParameter * &gt; DV_vector)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::auto_ptr&lt; <a class="el" href="class_elem_post_process_qty.html">ElemPostProcessQty</a> &gt; <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a846a008053337a7f64e51c1675cffd91">FESystemElem::ThermalElem::getElementPostProcessQty</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; unsigned int &gt;&#160;</td>
          <td class="paramname"><em>load_cases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="class_design_data_1_1_design_parameter.html">DesignData::DesignParameter</a> * &gt;&#160;</td>
          <td class="paramname"><em>DV_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this function returns the element post process quantity </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">vector</td><td>of load case IDs for which the quantitis should be calculated </td></tr>
    <tr><td class="paramname">vector</td><td>of DVs for which the quantities should be calculated </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#aab919792849ca2534674dc440a77fd51">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l01606">1606</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  (void) load_cases;
  (void) DV_vector;

  std::auto_ptr&lt;ElemPostProcessQty&gt; return_qty;
  
  
  <span class="keywordflow">return</span> return_qty;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa434bfc5568cdf31d6674e1e33c1475e"></a><!-- doxytag: member="FESystemElem::ThermalElem::getFETypes" ref="aa434bfc5568cdf31d6674e1e33c1475e" args="(std::vector&lt; FEType &gt; &amp;fetypes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#aa434bfc5568cdf31d6674e1e33c1475e">FESystemElem::ThermalElem::getFETypes</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; FEType &gt; &amp;&#160;</td>
          <td class="paramname"><em>fetypes</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>inserts the finite element types to be used for this element in the input parameters </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a37fb0c443dc328281227b0edbc3ff6cf">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00051">51</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  fetypes.clear();
  
  fetypes.push_back(FEType());
  FEType&amp; fe = fetypes.back();
  fe.order = FIRST;
  fe.family = LAGRANGE;
}
</pre></div>
</div>
</div>
<a class="anchor" id="abe7e88d34cb867a7b63b12c5798952a1"></a><!-- doxytag: member="FESystemElem::ThermalElem::getQuadratureRules" ref="abe7e88d34cb867a7b63b12c5798952a1" args="(std::map&lt; FEFamily, std::pair&lt; QuadratureType, Order &gt; &gt; &amp;quadratures)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#abe7e88d34cb867a7b63b12c5798952a1">FESystemElem::ThermalElem::getQuadratureRules</a> </td>
          <td>(</td>
          <td class="paramtype">std::map&lt; FEFamily, std::pair&lt; QuadratureType, Order &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>quadratures</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>inserts the quadrature rules to be used for the different elements </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#ac4ee610fdbe303c87d6b4e4f901d96ba">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l00067">67</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  quadratures.clear();
  
  <span class="keywordtype">bool</span> insert_success = 
    quadratures.insert(std::map&lt;FEFamily, std::pair&lt;QuadratureType, Order&gt; &gt;::
                       value_type(LAGRANGE, std::make_pair(QGAUSS, FIFTH))).second;
  
  Assert(insert_success, ExcInternalError());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0a926f5284f22b171288b3ba887c7208"></a><!-- doxytag: member="FESystemElem::ThermalElem::getThermalElemQty" ref="a0a926f5284f22b171288b3ba887c7208" args="(const unsigned int name, QtyType *qty, const unsigned int design_point_enum_ID, const unsigned int domain, const bool sensitivity)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class QtyType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a0a926f5284f22b171288b3ba887c7208">FESystemElem::ThermalElem::getThermalElemQty</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QtyType *&#160;</td>
          <td class="paramname"><em>qty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>domain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>sensitivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this method returns the quantity specified in the arguement list. This has been templatized so that the template can be used in derived element types. This element class will provide its element quantity and calculation routines. the sensitivity calculated from this is only shape sensitivity, and not property sensitivity </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>name of the quantity to be returned </td></tr>
    <tr><td class="paramname">qty</td><td>data structure in which the quantity will be removed </td></tr>
    <tr><td class="paramname">side_num</td><td>number of the side if this is a side quantity </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="thermal__elem_8h_source.html#l00510">510</a> of file <a class="el" href="thermal__elem_8h_source.html">thermal_elem.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// the quantities are not stored in the database.</span>
  assert (qty != NULL);
  qty-&gt;zero();
  
  <span class="keywordflow">if</span> (!sensitivity)
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a5d19a7188c02c52d4c312026bcd385a5">calculateThermalElemQty</a>(qty, name, design_point_enum_ID, domain);
  <span class="keywordflow">else</span>
    {
    <span class="comment">// this is only for shape sensitivity, since the local quantities specific to this </span>
    <span class="comment">// element are assumed not to be property dependent</span>
    Assert (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a> == DesignData::SHAPE_PARAMETER::num(), 
            ExcInternalError());

    <span class="keyword">static</span> QtyType  base_qty;
    
    <span class="comment">// next, obtain the quantity for the perturbed element</span>
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a5d19a7188c02c52d4c312026bcd385a5">calculateThermalElemQty</a>(qty, name,
                                  FESystemElem::BASE_PLUS_DELTA_ELEM::num(), domain);
    
    <span class="comment">// also, obtain the quantity for the base element. The base quantity also needs to</span>
    <span class="comment">// be evaluated at the same load case, dof_value for sensitivity calculation</span>
    base_qty.zero();
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_thermal_elem.html#a0a926f5284f22b171288b3ba887c7208">getThermalElemQty</a>(name, &amp;base_qty,  FESystemElem::BASE_ELEM::num(), domain, <span class="keyword">false</span>);
    
    qty-&gt;add(-1.0, base_qty);
    qty-&gt;scale(1.0/this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#abf3ee79816a6d274193746508d63d3b6" title="perturbation for a finite difference calculation">perturbation</a>);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5eaad14cd474ae96a77104a4cd410a2f"></a><!-- doxytag: member="FESystemElem::ThermalElem::getTransientSystemOrder" ref="a5eaad14cd474ae96a77104a4cd410a2f" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a5eaad14cd474ae96a77104a4cd410a2f">FESystemElem::ThermalElem::getTransientSystemOrder</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the transient system order for the elem equations </dd></dl>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#ae43b4253f009fe3dfc72200a5fe9a635">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8h_source.html#l00445">445</a> of file <a class="el" href="thermal__elem_8h_source.html">thermal_elem.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> 1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a58c8e9789a990f6ff03c4c622038f109"></a><!-- doxytag: member="FESystemElem::ThermalElem::initPropertyCard" ref="a58c8e9789a990f6ff03c4c622038f109" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_thermal_elem.html#a58c8e9789a990f6ff03c4c622038f109">FESystemElem::ThermalElem::initPropertyCard</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>initializes the property card at element local temperature, which is taken as the average of all nodal temperatures. This is needed for temperature dependent properties. This is an approximate way of using parameter dependent properties, since ideally they should be calculated at each quadrature point. That is, however, not done due to memory and CPU constraints. </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#acad9aa8915727e40bfb74d94d67d0264">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="thermal__elem_8_c_source.html#l01697">1697</a> of file <a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(!this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a11a2c563875d371ec536f90ee4111a90" title="boolean for keeping track of whether the property card was initialized">property_card_initialized</a>, ExcInternalError());

  <span class="comment">// if the properties are temperature dependent, then initialize the</span>
  <span class="comment">// element property cards at the element average temperature</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
    {
    <span class="comment">// get the load case number and the dof values</span>
    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
    n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
    <span class="keyword">static</span> std::map&lt;unsigned int, double&gt; local_param_map;
    
    <span class="comment">// now calculate the average</span>
    <span class="keyword">static</span> <span class="keywordtype">double</span> temp;
    temp = 0.0;
    
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_nodes; i++)
      temp += this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26c3c4e9ea952cbc8a7de979f74e0fde" title="vector of element dof values">dof_values_vec</a>[0](i);
    
    temp /= (1.0 * n_nodes);
    
    local_param_map[Property::TEMPERATURE::num()] = temp; 
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a7c638e4644afb12563e60ca3235c1eba" title="initializes the card and the material card for the given local parameters">reinitElemAndMaterialCardForLocalParameters</a>(&amp;local_param_map);
    }
  <span class="keywordflow">else</span>
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a7c638e4644afb12563e60ca3235c1eba" title="initializes the card and the material card for the given local parameters">reinitElemAndMaterialCardForLocalParameters</a>();
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a11a2c563875d371ec536f90ee4111a90" title="boolean for keeping track of whether the property card was initialized">property_card_initialized</a> = <span class="keyword">true</span>;
}
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/ThermalElems/<a class="el" href="thermal__elem_8h_source.html">thermal_elem.h</a></li>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/ThermalElems/<a class="el" href="thermal__elem_8_c_source.html">thermal_elem.C</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 12 2012 18:06:22 for fesystem by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
