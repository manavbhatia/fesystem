<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>fesystem: FESystemElem::PlateDKBatoz Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">fesystem
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_f_e_system_elem.html">FESystemElem</a>      </li>
      <li class="navelem"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html">PlateDKBatoz</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">FESystemElem::PlateDKBatoz Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="FESystemElem::PlateDKBatoz" --><!-- doxytag: inherits="FESystemElem::StructuralElem" -->
<p><code>#include &lt;<a class="el" href="_plate_d_k_batoz_8h_source.html">PlateDKBatoz.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for FESystemElem::PlateDKBatoz:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_elem_1_1_plate_d_k_batoz__inherit__graph.gif" border="0" usemap="#_f_e_system_elem_1_1_plate_d_k_batoz_inherit__map" alt="Inheritance graph"/></div>
<map name="_f_e_system_elem_1_1_plate_d_k_batoz_inherit__map" id="_f_e_system_elem_1_1_plate_d_k_batoz_inherit__map">
<area shape="rect" id="node2" href="class_f_e_system_elem_1_1_structural_elem.html" title="FESystemElem::StructuralElem" alt="" coords="23,83,231,111"/><area shape="rect" id="node4" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html" title="FESystemElem::FESystemElemBase" alt="" coords="5,6,248,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for FESystemElem::PlateDKBatoz:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_elem_1_1_plate_d_k_batoz__coll__graph.gif" border="0" usemap="#_f_e_system_elem_1_1_plate_d_k_batoz_coll__map" alt="Collaboration graph"/></div>
<map name="_f_e_system_elem_1_1_plate_d_k_batoz_coll__map" id="_f_e_system_elem_1_1_plate_d_k_batoz_coll__map">
<area shape="rect" id="node2" href="class_f_e_system_elem_1_1_structural_elem.html" title="FESystemElem::StructuralElem" alt="" coords="2139,293,2347,321"/><area shape="rect" id="node4" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html" title="FESystemElem::FESystemElemBase" alt="" coords="1845,293,2088,321"/><area shape="rect" id="node6" href="class_elem_data_card.html" title="ElemDataCard" alt="" coords="1508,62,1617,90"/><area shape="rect" id="node8" href="class_property_1_1_property_card_3_01double_01_4.html" title="this is a specialization of the class for property values that are stored as double" alt="" coords="1083,7,1304,35"/><area shape="rect" id="node10" href="class_property_1_1_property_card_base.html" title="Property::PropertyCardBase" alt="" coords="564,7,753,35"/><area shape="rect" id="node12" href="class_function_database.html" title="FunctionDatabase" alt="" coords="59,7,189,35"/><area shape="rect" id="node14" href="class_property_1_1_property_database.html" title="Property::PropertyDatabase" alt="" coords="872,67,1059,95"/><area shape="rect" id="node16" href="class_f_e_system_1_1_f_e_system_controller.html" title="FESystem::FESystemController" alt="" coords="19,329,229,357"/><area shape="rect" id="node18" href="class_discipline_1_1_analysis_discipline_base.html" title="Discipline::AnalysisDisciplineBase" alt="" coords="1451,293,1674,321"/><area shape="rect" id="node22" href="class_solution_1_1_solution_base.html" title="this class provides the base functionality for all solutions" alt="" coords="581,399,736,427"/><area shape="rect" id="node35" href="class_driver_1_1_analysis_driver.html" title="Driver::AnalysisDriver" alt="" coords="1119,535,1268,563"/><area shape="rect" id="node20" href="class_discipline_1_1_discipline_info.html" title="Discipline::DisciplineInfo" alt="" coords="1111,345,1276,373"/><area shape="rect" id="node25" href="class_mesh_d_s_1_1_f_e_dof_map.html" title="MeshDS::FEDofMap" alt="" coords="1122,462,1265,490"/><area shape="rect" id="node28" href="class_mesh_d_s_1_1_f_e_mesh_data.html" title="MeshDS::FEMeshData" alt="" coords="1114,241,1272,269"/><area shape="rect" id="node30" href="class_mesh_d_s_1_1_f_e_mesh.html" title="MeshDS::FEMesh" alt="" coords="594,143,723,171"/><area shape="rect" id="node33" href="class_f_e_system_utility_1_1_loaded_solution.html" title="this class is a data structure that stores loaded solution from the database" alt="" coords="1086,189,1301,217"/><area shape="rect" id="node38" href="class_solver_1_1_f_e_system_solver_base.html" title="Solver::FESystemSolverBase" alt="" coords="1465,559,1661,587"/><area shape="rect" id="node41" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; NumericVector\&lt; double \&gt; \&gt;" alt="" coords="469,594,848,622"/><area shape="rect" id="node43" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; T \&gt;" alt="" coords="6,594,242,622"/><area shape="rect" id="node46" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters." alt="" coords="558,542,760,570"/><area shape="rect" id="node48" href="class_element_data_storage.html" title="ElementDataStorage" alt="" coords="1490,345,1635,373"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_f_e_system_elem_1_1_plate_d_k_batoz-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#aac9f8d784aa50b6e99de5eb817a5c44f">PlateDKBatoz</a> (const unsigned int dim, const unsigned int elem_enum_ID, <a class="el" href="class_discipline_1_1_analysis_discipline_base.html">Discipline::AnalysisDisciplineBase</a> &amp;discipline)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#abb9a9b3a2a86595ade08d82bd2954898">~PlateDKBatoz</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual std::auto_ptr<br class="typebreak"/>
&lt; <a class="el" href="class_elem_post_process_qty.html">ElemPostProcessQty</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a003ac8d11e7615d288b2caaebeda9519">getElementPostProcessQty</a> (std::vector&lt; unsigned int &gt;, std::vector&lt; <a class="el" href="class_design_data_1_1_design_parameter.html">DesignData::DesignParameter</a> * &gt;)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#aa440d800b75eb23ada903a2c74f9850a">getFETypes</a> (std::vector&lt; FEType &gt; &amp;fetypes)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a5408f7d2c73594738f4b725680c57f5c">getQuadratureRules</a> (std::map&lt; FEFamily, std::pair&lt; QuadratureType, Order &gt; &gt; &amp;quadratures)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">inserts the quadrature rules to be used for the different elements  <a href="#a5408f7d2c73594738f4b725680c57f5c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a71146714bfa188a131f85c15a8f8fc53">calculate_M</a> (DenseMatrix&lt; double &gt; *, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#abe2e98d1f2ca98932b26d331d7db17ec">calculate_K</a> (DenseMatrix&lt; double &gt; *, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates and returns the element stiffness matrix  <a href="#abe2e98d1f2ca98932b26d331d7db17ec"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a01d5265cce1add13b828b5cec72ba87b">calculate_K_G</a> (DenseMatrix&lt; double &gt; *, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates and returns the stiffness matrix  <a href="#a01d5265cce1add13b828b5cec72ba87b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a57678b90ecb737cd288e7ba13dcdea0a">calculate_F_T</a> (DenseVector&lt; double &gt; *, const unsigned int design_point_enum_ID, bool sensitivity_calculation)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates and returns the element thermal load vector  <a href="#a57678b90ecb737cd288e7ba13dcdea0a"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="_plate_d_k_batoz_8h_source.html#l00173">173</a> of file <a class="el" href="_plate_d_k_batoz_8h_source.html">PlateDKBatoz.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aac9f8d784aa50b6e99de5eb817a5c44f"></a><!-- doxytag: member="FESystemElem::PlateDKBatoz::PlateDKBatoz" ref="aac9f8d784aa50b6e99de5eb817a5c44f" args="(const unsigned int dim, const unsigned int elem_enum_ID, Discipline::AnalysisDisciplineBase &amp;discipline)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#aac9f8d784aa50b6e99de5eb817a5c44f">FESystemElem::PlateDKBatoz::PlateDKBatoz</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>elem_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_discipline_1_1_analysis_discipline_base.html">Discipline::AnalysisDisciplineBase</a> &amp;&#160;</td>
          <td class="paramname"><em>discipline</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_plate_d_k_batoz_8_c_source.html#l00020">20</a> of file <a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                      :
<a class="code" href="class_f_e_system_elem_1_1_structural_elem.html#ac6e01925a1242e1c6b8f73fe32fdb7d8">FESystemElem::StructuralElem</a>(dim, elem_enum_ID, discipline)
{
  
}
</pre></div>
</div>
</div>
<a class="anchor" id="abb9a9b3a2a86595ade08d82bd2954898"></a><!-- doxytag: member="FESystemElem::PlateDKBatoz::~PlateDKBatoz" ref="abb9a9b3a2a86595ade08d82bd2954898" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#abb9a9b3a2a86595ade08d82bd2954898">FESystemElem::PlateDKBatoz::~PlateDKBatoz</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_plate_d_k_batoz_8_c_source.html#l00032">32</a> of file <a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a>.</p>
<div class="fragment"><pre class="fragment">{
        
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a57678b90ecb737cd288e7ba13dcdea0a"></a><!-- doxytag: member="FESystemElem::PlateDKBatoz::calculate_F_T" ref="a57678b90ecb737cd288e7ba13dcdea0a" args="(DenseVector&lt; double &gt; *, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a57678b90ecb737cd288e7ba13dcdea0a">FESystemElem::PlateDKBatoz::calculate_F_T</a> </td>
          <td>(</td>
          <td class="paramtype">DenseVector&lt; double &gt; *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates and returns the element thermal load vector </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_structural_elem.html#ad8766a86a72b2b1f7c8d7f4ca3810cda">FESystemElem::StructuralElem</a>.</p>

<p>Definition at line <a class="el" href="_plate_d_k_batoz_8_c_source.html#l00586">586</a> of file <a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a>.</p>

<p>References <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> <span class="keywordtype">double</span> ref_temp = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a28478797fd744e7360306caca230b7be">getFESystemController</a>().
  analysis_case-&gt;getRealParameter(<span class="stringliteral">&quot;REFERENCE_TEMP&quot;</span>);
  
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  
  <span class="comment">// initialize the data structures for the load</span>
  <span class="keyword">static</span> DenseVector&lt;double&gt; nodal_temp(n_nodes), nodal_temp_sens(n_nodes);
  
  <span class="keywordflow">if</span> (nodal_temp.size() != n_nodes)
    {
    nodal_temp.resize(n_nodes);
    nodal_temp_sens.resize(n_nodes);
    }
  
  nodal_temp.zero(); nodal_temp_sens.zero();
  
  <span class="comment">// get the loads for this element</span>
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_structural_elem.html#a5b448e76e2d8c3d4fe1d9b2776cfcfc9">extractNodalTemperatureVectorFromLoads</a>(nodal_temp, <span class="keyword">false</span>);
  
  <span class="keyword">static</span> <span class="keywordtype">double</span> factor, factor_sens, factor_temp_sens;
  factor = 0.0; factor_sens = 0.0; factor_temp_sens = 0.0;
  
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(factor, THERMAL_EXPANSION_FACTOR::num());  
  
  <span class="keywordflow">if</span> (sensitivity_calculation)
    {
    <span class="comment">// get the nodal temperature vector sensitivity</span>
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_structural_elem.html#a5b448e76e2d8c3d4fe1d9b2776cfcfc9">extractNodalTemperatureVectorFromLoads</a>(nodal_temp_sens, <span class="keyword">true</span>);
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
      {
      <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>
        (factor_sens, THERMAL_EXPANSION_FACTOR::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>);
        
      <span class="keywordflow">default</span>:
        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55">getFactorSensitivityForLocalParameter</a>
            (factor_temp_sens, THERMAL_EXPANSION_FACTOR::num(), Property::TEMPERATURE::num());
        <span class="keywordflow">break</span>;
      }
    }
  
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; nx_n_matrix(n_nodes,n_nodes), 
    ny_n_matrix(n_nodes,n_nodes), 
    nx_n_matrix_sens(n_nodes,n_nodes), 
    ny_n_matrix_sens(n_nodes,n_nodes);
  
  nx_n_matrix.zero(); ny_n_matrix.zero(); 
  nx_n_matrix_sens.zero(); ny_n_matrix_sens.zero(); 
  
  <span class="keyword">static</span> <span class="keywordtype">double</span> avg_factor_temp_sens, avg_temp_sens;
  avg_factor_temp_sens = 0.0; avg_temp_sens = 0.0;
  
  <span class="comment">// now, scale the matrix with the right factors to take into </span>
  <span class="comment">// account the sensitivity if needed</span>
  <span class="keywordflow">switch</span> (sensitivity_calculation)
    {
    
    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
      {
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_nodes; i++)
        avg_temp_sens += nodal_temp_sens(i);
      avg_temp_sens /= (1.0 * n_nodes);
      
      avg_factor_temp_sens = factor_temp_sens * avg_temp_sens;
      }
    
    <span class="keywordflow">case</span> <span class="keyword">true</span>:
      {
        <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
          {
          <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
            {
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_FACTOR::num(), &amp;nx_n_matrix,
                                       design_point_enum_ID,
                                       FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Y_N_FACTOR::num(), &amp;ny_n_matrix,
                                       design_point_enum_ID,
                                       FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
              
              <span class="keywordtype">double</span> sum1 = 0.0, sum2 = 0.0;
              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes; i++)
                {
                sum1 = 0.0; sum2 = 0.0;
                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_nodes; j++)
                  {
                  sum1 += nx_n_matrix(i,j) * 
                  ((factor_sens + avg_factor_temp_sens)* (nodal_temp(j)-ref_temp) +
                   factor * nodal_temp_sens(j));
                  sum2 += ny_n_matrix(i,j) * 
                    ((factor_sens + avg_factor_temp_sens)* (nodal_temp(j)-ref_temp) + 
                     factor * nodal_temp_sens(j));
                  }
                (*vector)(i) = sum1;
                (*vector)(n_nodes+i) = sum2;
                }
            }
            <span class="keywordflow">break</span>;
            
          <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
            {
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_FACTOR::num(), &amp;nx_n_matrix,
                                       design_point_enum_ID,
                                       FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Y_N_FACTOR::num(), &amp;ny_n_matrix,
                                       design_point_enum_ID,
                                       FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>(FESystemElem::N_X_N_FACTOR::num(),
                                                       &amp;nx_n_matrix_sens,
                                                       FESystemElem::ELEM_VOLUME::num(),
                                                       LAGRANGE);
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>(FESystemElem::N_Y_N_FACTOR::num(), 
                                                       &amp;ny_n_matrix_sens,
                                                       FESystemElem::ELEM_VOLUME::num(),
                                                       LAGRANGE);
              
              <span class="keywordtype">double</span> sum1 = 0.0, sum2 = 0.0;
              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes; i++)
                {
                sum1 = 0.0; sum2 = 0.0; 
                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_nodes; j++)
                  {
                  sum1 += factor* (nx_n_matrix_sens(i,j) * (nodal_temp(j)-ref_temp) + 
                                   nx_n_matrix(i,j) * nodal_temp_sens(j)) +
                  avg_factor_temp_sens * nx_n_matrix(i,j) * (nodal_temp(j)-ref_temp);
                  sum2 += factor* ( ny_n_matrix_sens(i,j) * (nodal_temp(j)-ref_temp) + 
                                    ny_n_matrix(i,j) * nodal_temp_sens(j)) +
                    avg_factor_temp_sens * ny_n_matrix(i,j) * (nodal_temp(j)-ref_temp); 
                  }
                (*vector)(i) = sum1;
                (*vector)(n_nodes + i) = sum2;
                }
            }
            <span class="keywordflow">break</span>;
            
          <span class="keywordflow">default</span>:
            Assert(<span class="keyword">false</span>, ExcInternalError());
          }
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <span class="keyword">false</span>:
    <span class="keywordflow">default</span>:
      {
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_FACTOR::num(), &amp;nx_n_matrix, 
                                 design_point_enum_ID,
                                 FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Y_N_FACTOR::num(), &amp;ny_n_matrix, 
                                 design_point_enum_ID,
                                 FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
        
        <span class="keywordtype">double</span> sum1 = 0.0, sum2 = 0.0;
        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes; i++)
          {
          sum1 = 0.0; sum2 = 0.0;
          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_nodes; j++)
            {
            sum1 += nx_n_matrix(i,j) * (factor* (nodal_temp(j)-ref_temp));
            sum2 += ny_n_matrix(i,j) * (factor* (nodal_temp(j)-ref_temp));
            }
          (*vector)(i) = sum1;
          (*vector)(n_nodes + i) = sum2;
          }
      }
      <span class="keywordflow">break</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="abe2e98d1f2ca98932b26d331d7db17ec"></a><!-- doxytag: member="FESystemElem::PlateDKBatoz::calculate_K" ref="abe2e98d1f2ca98932b26d331d7db17ec" args="(DenseMatrix&lt; double &gt; *, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#abe2e98d1f2ca98932b26d331d7db17ec">FESystemElem::PlateDKBatoz::calculate_K</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates and returns the element stiffness matrix </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_structural_elem.html#a7f78e4e0648e93e586de6df36e2e0e33">FESystemElem::StructuralElem</a>.</p>

<p>Definition at line <a class="el" href="_plate_d_k_batoz_8_c_source.html#l00267">267</a> of file <a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a>.</p>

<p>References <a class="el" href="_plate_d_k_batoz_8h_source.html#l00235">FESystemElem::getPlateDKBatozQty()</a>, <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; mem_material_mat(3,3), mem_material_mat_sens(3,3),
    mem_material_mat_temp_sens(3,3);
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; plate_material_mat(3,3), plate_material_mat_sens(3,3),
    plate_material_mat_temp_sens(3,3);
  mem_material_mat.zero(); mem_material_mat_sens.zero(); mem_material_mat_temp_sens.zero();
  plate_material_mat.zero(); plate_material_mat_sens.zero(); plate_material_mat_temp_sens.zero();
  

  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(mem_material_mat, STIFFNESS_A_MATRIX_FACTOR::num());
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(plate_material_mat, STIFFNESS_D_MATRIX_FACTOR::num());
  <span class="keywordflow">if</span> (sensitivity_calculation)
    {
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
      {
      <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
        {
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>
          (mem_material_mat_sens, STIFFNESS_A_MATRIX_FACTOR::num(), 
           this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>);
        this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>
          (plate_material_mat_sens, STIFFNESS_D_MATRIX_FACTOR::num(), 
           this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>);
        }
        
      <span class="keywordflow">default</span>:
        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
          {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55">getFactorSensitivityForLocalParameter</a>
            (mem_material_mat_temp_sens, STIFFNESS_A_MATRIX_FACTOR::num(), 
             Property::TEMPERATURE::num());
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55">getFactorSensitivityForLocalParameter</a>
            (plate_material_mat_temp_sens, STIFFNESS_D_MATRIX_FACTOR::num(), 
             Property::TEMPERATURE::num());
          }
        <span class="keywordflow">break</span>;
      }
    }

  <span class="comment">// if the property is temperature dependent, then the temperature sensitivity </span>
  <span class="comment">// will be needed</span>
  <span class="keyword">static</span> DenseVector&lt;double&gt; nodal_temp_sens(n_nodes);
  nodal_temp_sens.zero();

  <span class="comment">// following factors are needed for the membrane effects</span>
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; Nx_Nx(n_nodes,n_nodes), Ny_Ny(n_nodes,n_nodes),
    Nx_Ny(n_nodes,n_nodes);
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; Nx_Nx_sens(n_nodes,n_nodes), Ny_Ny_sens(n_nodes,n_nodes),
    Nx_Ny_sens(n_nodes,n_nodes);
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; N_N_mem_factor(3,3), N_N_sens_mem_factor(3,3),
    N_N_plate_factor(3,3), N_N_sens_plate_factor(3,3);
  
        Nx_Nx.zero(); Ny_Ny.zero(); Nx_Ny.zero(); 
        Nx_Nx_sens.zero(); Ny_Ny_sens.zero(); Nx_Ny_sens.zero(); 
  N_N_mem_factor.zero(); N_N_sens_mem_factor.zero();
  N_N_plate_factor.zero(); N_N_sens_plate_factor.zero();
  
  <span class="comment">// following factors are needed for plate bending effects</span>
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; Hxx_Hxx(n_nodes*3, n_nodes*3), Hxx_Hyy(n_nodes*3, n_nodes*3),
    Hyy_Hyy(n_nodes*3, n_nodes*3), Hxy_Hxy(n_nodes*3, n_nodes*3), 
    Hyx_Hxy(n_nodes*3, n_nodes*3), Hyx_Hyx(n_nodes*3, n_nodes*3);
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; Hxx_Hxx_sens(n_nodes*3, n_nodes*3), 
    Hxx_Hyy_sens(n_nodes*3, n_nodes*3),
    Hyy_Hyy_sens(n_nodes*3, n_nodes*3), Hxy_Hxy_sens(n_nodes*3, n_nodes*3), 
    Hyx_Hxy_sens(n_nodes*3, n_nodes*3), Hyx_Hyx_sens(n_nodes*3, n_nodes*3);
  Hxx_Hxx.zero(); Hxx_Hyy.zero(); Hyy_Hyy.zero(); Hxy_Hxy.zero();
  Hyx_Hxy.zero(); Hyx_Hyx.zero();
  Hxx_Hxx_sens.zero(); Hxx_Hyy_sens.zero(); Hyy_Hyy_sens.zero(); Hxy_Hxy_sens.zero();
  Hyx_Hxy_sens.zero(); Hyx_Hyx_sens.zero();
        
  <span class="keywordflow">if</span> (sensitivity_calculation)
    {
    
    <span class="keyword">static</span> <span class="keywordtype">double</span> avg_temp_sens = 0.0;
    avg_temp_sens = 0.0;
    
    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
      {
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_structural_elem.html#a5b448e76e2d8c3d4fe1d9b2776cfcfc9">extractNodalTemperatureVectorFromLoads</a>(nodal_temp_sens, <span class="keyword">true</span>);
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_nodes; i++)
        avg_temp_sens += nodal_temp_sens(i);
      avg_temp_sens /= (1.0 * n_nodes);
      
      mem_material_mat_temp_sens.scale(avg_temp_sens);
      plate_material_mat_temp_sens.scale(avg_temp_sens);
      }
    
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
      {
      <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_X_FACTOR::num(), &amp;Nx_Nx,
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Y_N_Y_FACTOR::num(), &amp;Ny_Ny,
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_Y_FACTOR::num(), &amp;Nx_Ny,
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          
          <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                           FESystemElem::PLATE_DK_BATOZ_HXX_HXX_FACTOR::num(), 
                                           &amp;Hxx_Hxx, design_point_enum_ID,
                                           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
          <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                           FESystemElem::PLATE_DK_BATOZ_HYY_HYY_FACTOR::num(), 
                                           &amp;Hyy_Hyy, design_point_enum_ID,
                                           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
          <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                           FESystemElem::PLATE_DK_BATOZ_HXX_HYY_FACTOR::num(), 
                                           &amp;Hxx_Hyy, design_point_enum_ID,
                                           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
          <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                           FESystemElem::PLATE_DK_BATOZ_HXY_HXY_FACTOR::num(), 
                                           &amp;Hxy_Hxy, design_point_enum_ID,
                                           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
          <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                           FESystemElem::PLATE_DK_BATOZ_HYX_HXY_FACTOR::num(), 
                                           &amp;Hyx_Hxy, design_point_enum_ID,
                                           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
          <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                           FESystemElem::PLATE_DK_BATOZ_HYX_HYX_FACTOR::num(), 
                                           &amp;Hyx_Hyx, design_point_enum_ID,
                                           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
          
          N_N_mem_factor = mem_material_mat_sens;
          N_N_mem_factor += mem_material_mat_temp_sens;

          N_N_plate_factor = plate_material_mat_sens;
          N_N_plate_factor += plate_material_mat_temp_sens;
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>
          (FESystemElem::N_X_N_X_FACTOR::num(), &amp;Nx_Nx_sens,
           FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>
            (FESystemElem::N_Y_N_Y_FACTOR::num(), &amp;Ny_Ny_sens,
             FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>
            (FESystemElem::N_X_N_Y_FACTOR::num(), &amp;Nx_Ny_sens,
             FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          
        <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>
          (<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HXX_HXX_FACTOR::num(), 
           &amp;Hxx_Hxx_sens, 
           design_point_enum_ID,
           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">true</span>);
        <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>
          (<span class="keyword">this</span>, FESystemElem::PLATE_DK_BATOZ_HYY_HYY_FACTOR::num(), 
           &amp;Hyy_Hyy_sens, 
           design_point_enum_ID,
           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">true</span>);
        <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>
          (<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HXX_HYY_FACTOR::num(), 
           &amp;Hxx_Hyy_sens,
           design_point_enum_ID,
           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">true</span>);
        <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>
          (<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HXY_HXY_FACTOR::num(), 
           &amp;Hxy_Hxy_sens,
           design_point_enum_ID,
           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">true</span>);
        <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>
          (<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HYX_HXY_FACTOR::num(), 
           &amp;Hyx_Hxy_sens,
           design_point_enum_ID,
           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">true</span>);
        <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>
          (<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HYX_HYX_FACTOR::num(), 
           &amp;Hyx_Hyx_sens,
           design_point_enum_ID,
           FESystemElem::ELEM_VOLUME::num(), <span class="keyword">true</span>);

          N_N_sens_mem_factor = mem_material_mat;
          N_N_sens_plate_factor = plate_material_mat;

          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
            {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_X_FACTOR::num(), &amp;Nx_Nx,
                                     design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Y_N_Y_FACTOR::num(), &amp;Ny_Ny,
                                     design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_Y_FACTOR::num(), &amp;Nx_Ny,
                                     design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
            
            <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                             FESystemElem::PLATE_DK_BATOZ_HXX_HXX_FACTOR::num(), 
                                             &amp;Hxx_Hxx, design_point_enum_ID,
                                             FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
            <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                             FESystemElem::PLATE_DK_BATOZ_HYY_HYY_FACTOR::num(), 
                                             &amp;Hyy_Hyy, design_point_enum_ID,
                                             FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
            <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                             FESystemElem::PLATE_DK_BATOZ_HXX_HYY_FACTOR::num(), 
                                             &amp;Hxx_Hyy, design_point_enum_ID,
                                             FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
            <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                             FESystemElem::PLATE_DK_BATOZ_HXY_HXY_FACTOR::num(), 
                                             &amp;Hxy_Hxy, design_point_enum_ID,
                                             FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
            <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                             FESystemElem::PLATE_DK_BATOZ_HYX_HXY_FACTOR::num(), 
                                             &amp;Hyx_Hxy, design_point_enum_ID,
                                             FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
            <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,
                                             FESystemElem::PLATE_DK_BATOZ_HYX_HYX_FACTOR::num(), 
                                             &amp;Hyx_Hyx, design_point_enum_ID,
                                             FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
            N_N_mem_factor = mem_material_mat_temp_sens;
            N_N_plate_factor = plate_material_mat_temp_sens;
            }
        }
      <span class="keywordflow">break</span>;
      
      <span class="keywordflow">default</span>:
        Assert(<span class="keyword">false</span>, ExcInternalError());
      }
    }
  <span class="keywordflow">else</span>
    {
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_X_FACTOR::num(), &amp;Nx_Nx,
                             design_point_enum_ID,
                             FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_Y_N_Y_FACTOR::num(), &amp;Ny_Ny,
                             design_point_enum_ID,
                             FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
    this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_X_N_Y_FACTOR::num(), &amp;Nx_Ny,
                             design_point_enum_ID,
                             FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
    
    <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HXX_HXX_FACTOR::num(), 
                                     &amp;Hxx_Hxx, design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
    <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HYY_HYY_FACTOR::num(), 
                                     &amp;Hyy_Hyy, design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
    <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HXX_HYY_FACTOR::num(), 
                                     &amp;Hxx_Hyy, design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
    <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HXY_HXY_FACTOR::num(), 
                                     &amp;Hxy_Hxy, design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
    <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HYX_HXY_FACTOR::num(), 
                                     &amp;Hyx_Hxy, design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
    <a class="code" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c">FESystemElem::getPlateDKBatozQty</a>(<span class="keyword">this</span>,FESystemElem::PLATE_DK_BATOZ_HYX_HYX_FACTOR::num(), 
                                     &amp;Hyx_Hyx, design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), <span class="keyword">false</span>);
    N_N_mem_factor = mem_material_mat;
    N_N_plate_factor = plate_material_mat;
    }
  
        
        <span class="comment">// calculate the stiffness matrix. Add the membrane stiffness effects for u, v dofs</span>
  <span class="keyword">static</span> <span class="keywordtype">double</span> factor1, factor2, factor3, factor1_sens, factor2_sens, factor3_sens;
  factor1 = N_N_mem_factor(0,0);
  factor2 = N_N_mem_factor(0,1);
  factor3 = N_N_mem_factor(2,2);
  
  factor1_sens = N_N_sens_mem_factor(0,0);
  factor2_sens = N_N_sens_mem_factor(0,1);
  factor3_sens = N_N_sens_mem_factor(2,2);
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes; i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_nodes; j++)
      {
      (*matrix)(i,j) = factor1*Nx_Nx(i,j) + factor3 * Ny_Ny(i,j) + 
      factor1_sens*Nx_Nx_sens(i,j) + factor3_sens * Ny_Ny_sens(i,j);
      
      (*matrix)(i,n_nodes+j) = factor2*Nx_Ny(i,j) + factor3 * Nx_Ny(j,i) + 
        factor2_sens*Nx_Ny_sens(i,j) + factor3_sens* Nx_Ny_sens(j,i);
      
      (*matrix)(n_nodes+i,j) = factor2*Nx_Ny(j,i) + factor3*(Nx_Ny(i,j)) + 
        factor2_sens*Nx_Ny_sens(j,i) + factor3_sens*Nx_Ny_sens(i,j);
      
      (*matrix)(n_nodes+i,n_nodes+j) = factor1*Ny_Ny(i,j) + factor3*Nx_Nx(i,j) + 
        factor1_sens*Ny_Ny_sens(i,j) + factor3_sens*Nx_Nx_sens(i,j);
      }
      
    <span class="comment">// now add the stiffness effects of the plate bending for the w, thetax, thetay dofs</span>
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes*3; i++)
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_nodes*3; j++)
        {
        (*matrix)(2*n_nodes+i,2*n_nodes+j) += 
        N_N_plate_factor(0,0)* (Hxx_Hxx(i,j) + Hyy_Hyy(i,j)) +
        N_N_plate_factor(0,1)* (Hxx_Hyy(i,j) + Hxx_Hyy(j,i)) +
        N_N_plate_factor(2,2)* (Hxy_Hxy(i,j) + Hyx_Hxy(i,j) + Hyx_Hxy(j,i) + Hyx_Hyx(i,j)) + 
        N_N_sens_plate_factor(0,0)* (Hxx_Hxx_sens(i,j) + Hyy_Hyy_sens(i,j)) +
        N_N_sens_plate_factor(0,1)* (Hxx_Hyy_sens(i,j) + Hxx_Hyy_sens(j,i)) +
        N_N_sens_plate_factor(2,2)* (Hxy_Hxy_sens(i,j) + Hyx_Hxy_sens(i,j) + 
                                     Hyx_Hxy_sens(j,i) + Hyx_Hyx_sens(i,j));
        }
        
    <span class="comment">// finally, place a unity at the diagonal for the theta_z rows, to remove singularity </span>
    <span class="comment">// of the element</span>
    <span class="comment">// this will be changed in future, since the value of this fictitious stiffness is dependent on the </span>
    <span class="comment">// value of the other diagonal terms </span>
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes; i++)
      (*matrix)(5*n_nodes+i,5*n_nodes+i) = 1.0;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_elem_1_1_plate_d_k_batoz_abe2e98d1f2ca98932b26d331d7db17ec_cgraph.gif" border="0" usemap="#class_f_e_system_elem_1_1_plate_d_k_batoz_abe2e98d1f2ca98932b26d331d7db17ec_cgraph" alt=""/></div>
<map name="class_f_e_system_elem_1_1_plate_d_k_batoz_abe2e98d1f2ca98932b26d331d7db17ec_cgraph" id="class_f_e_system_elem_1_1_plate_d_k_batoz_abe2e98d1f2ca98932b26d331d7db17ec_cgraph">
<area shape="rect" id="node3" href="namespace_f_e_system_elem.html#a750a0ea56cc65531402a179f57856d7c" title="FESystemElem::getPlateDKBatozQty" alt="" coords="333,57,576,85"/><area shape="rect" id="node5" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e" title="FESystemElem::FESystemElemBase::getFESystemElemQty" alt="" coords="673,5,1055,33"/><area shape="rect" id="node7" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a" title="FESystemElem::FESystemElemBase::getFESystemElemQtyShapeSensitivity" alt="" coords="624,57,1104,85"/><area shape="rect" id="node9" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11" title="FESystemElem::FESystemElemBase::getNNodes" alt="" coords="706,109,1022,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a01d5265cce1add13b828b5cec72ba87b"></a><!-- doxytag: member="FESystemElem::PlateDKBatoz::calculate_K_G" ref="a01d5265cce1add13b828b5cec72ba87b" args="(DenseMatrix&lt; double &gt; *, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a01d5265cce1add13b828b5cec72ba87b">FESystemElem::PlateDKBatoz::calculate_K_G</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>calculates and returns the stiffness matrix </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_structural_elem.html#a5dd6489faee097e247394758efbd887b">FESystemElem::StructuralElem</a>.</p>

<p>Definition at line <a class="el" href="_plate_d_k_batoz_8_c_source.html#l00252">252</a> of file <a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// params not used here</span>
  (void) matrix;
  (void) design_point_enum_ID;
  (void) sensitivity_calculation;

  Assert(<span class="keyword">false</span>, ExcInternalError());
}
</pre></div>
</div>
</div>
<a class="anchor" id="a71146714bfa188a131f85c15a8f8fc53"></a><!-- doxytag: member="FESystemElem::PlateDKBatoz::calculate_M" ref="a71146714bfa188a131f85c15a8f8fc53" args="(DenseMatrix&lt; double &gt; *, const unsigned int design_point_enum_ID, bool sensitivity_calculation)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a71146714bfa188a131f85c15a8f8fc53">FESystemElem::PlateDKBatoz::calculate_M</a> </td>
          <td>(</td>
          <td class="paramtype">DenseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>design_point_enum_ID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>sensitivity_calculation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>function will calculate the matrix of the element, and fill the matrix passed as the arguement. The second arguement is the name of the property, which, if passed to this function, will make the function calculate the sensitivity of the qty wrt the property </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_structural_elem.html#a4afeb5a62dae236abfa0e77a00e8b391">FESystemElem::StructuralElem</a>.</p>

<p>Definition at line <a class="el" href="_plate_d_k_batoz_8_c_source.html#l00095">95</a> of file <a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a>.</p>

<p>References <a class="el" href="_property_parameter_8h_source.html#l00015">PROPERTY_PARAMETER_ENUM_ID</a>, and <a class="el" href="_shape_parameter_8h_source.html#l00014">SHAPE_PARAMETER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;
  n_nodes = this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a68efcd3cae7b2b27cdb7956722fb1e11">getNNodes</a>();
  
  <span class="keyword">static</span> <span class="keywordtype">double</span> mem_factor, mem_factor_sens, mem_factor_temp_sens,
    plate_factor, plate_factor_sens, plate_factor_temp_sens;
  mem_factor = 0.0; mem_factor_sens = 0.0; mem_factor_temp_sens = 0.0;
  plate_factor = 0.0; plate_factor_sens = 0.0; plate_factor_temp_sens = 0.0;  

  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(mem_factor, MEMBRANE_MASS_FACTOR::num());
  this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a27af74f2017cf1c03e920645e59a2359" title="returns the value of the factor">getFactor</a>(plate_factor, PLATE_MASS_FACTOR::num());

  <span class="keywordflow">if</span> (sensitivity_calculation)
    {
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
      {
      <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>
          (mem_factor_sens, MEMBRANE_MASS_FACTOR::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>);
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#afb821b62f9ea7f4b9895115ee33bee7c">getFactorSensitivityForGlobalParameter</a>
            (plate_factor_sens, PLATE_MASS_FACTOR::num(), this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a1d540209d4fbc8e392a85d8b0d104196" title="ID of the sensitivity parameter.">sensitivity_parameter_ID</a>);
        }
        
      <span class="keywordflow">default</span>:
        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
          {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55">getFactorSensitivityForLocalParameter</a>
          (mem_factor_temp_sens, MEMBRANE_MASS_FACTOR::num(), Property::TEMPERATURE::num());
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a7853dcdf723fbd53309a438c74a3b46a" title="card that stores the information for this element">elem_property_card</a>-&gt;<a class="code" href="class_elem_data_card.html#a1afbbbdd7610f00fd43e7ddfba50ca55">getFactorSensitivityForLocalParameter</a>
            (plate_factor_temp_sens, PLATE_MASS_FACTOR::num(), Property::TEMPERATURE::num());
          }
        <span class="keywordflow">break</span>;
      }
    }


  
  <span class="comment">// if the property is temperature dependent, then the temperature sensitivity </span>
  <span class="comment">// will be needed</span>
  <span class="keyword">static</span> DenseVector&lt;double&gt; nodal_temp_sens(n_nodes);
  nodal_temp_sens.zero();
  
  <span class="keyword">static</span> <span class="keywordtype">double</span> avg_mem_factor_temp_sens, avg_temp_sens, N_N_mem_factor, N_N_mem_sens_factor,
    avg_plate_factor_temp_sens, N_N_plate_factor, N_N_plate_sens_factor;

  avg_mem_factor_temp_sens = 0.0; avg_mem_factor_temp_sens = 0.0; avg_temp_sens = 0.0;
  avg_plate_factor_temp_sens = 0.0; avg_plate_factor_temp_sens = 0.0;

  N_N_mem_factor = 0.0; N_N_mem_sens_factor = 0.0;
  N_N_plate_factor = 0.0; N_N_plate_sens_factor = 0.0;
  
  <span class="keyword">static</span> DenseMatrix&lt;double&gt; N_N(n_nodes, n_nodes), N_N_sens(n_nodes, n_nodes), 
  N_N_bend(n_nodes*3,n_nodes*3), N_N_bend_sens(n_nodes*3,n_nodes*3);
  N_N.zero(); N_N_sens.zero();
  N_N_bend.zero(); N_N_bend_sens.zero();
  
  
  <span class="keywordflow">if</span> (sensitivity_calculation)
    {
    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
      {
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_structural_elem.html#a5b448e76e2d8c3d4fe1d9b2776cfcfc9">extractNodalTemperatureVectorFromLoads</a>(nodal_temp_sens, <span class="keyword">true</span>);
      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; n_nodes; i++)
        avg_temp_sens += nodal_temp_sens(i);
      avg_temp_sens /= (1.0 * n_nodes);
      
      avg_mem_factor_temp_sens = mem_factor_temp_sens * avg_temp_sens;
      avg_plate_factor_temp_sens = plate_factor_temp_sens * avg_temp_sens;
      }
    
    <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a3642ed0e6582c57a21ffc02b44890ad4" title="type of the sensitivity parameter">sensitivity_parameter</a>)
      {
      <span class="keywordflow">case</span> <a class="code" href="_property_parameter_8h.html#a80cffea30c32206041836bb3b44294e5">PROPERTY_PARAMETER_ENUM_ID</a>:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), &amp;N_N,
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), &amp;N_N_bend,
                                   design_point_enum_ID,
                                   FESystemElem::ELEM_VOLUME::num(), BCIZ);
          
          N_N_mem_factor = mem_factor_sens + avg_mem_factor_temp_sens;
          N_N_plate_factor = plate_factor_sens + avg_plate_factor_temp_sens;
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">case</span> <a class="code" href="_shape_parameter_8h.html#ac516f3dcf880878bbcd0ee739b4cda5c">SHAPE_PARAMETER_ENUM_ID</a>:
        {
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>(FESystemElem::N_N_FACTOR::num(), &amp;N_N_sens,
                                                   FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
          this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#afa027c1230bd104db07d72e0df21869a">getFESystemElemQtyShapeSensitivity</a>(FESystemElem::N_N_FACTOR::num(), &amp;N_N_bend_sens,
                                                   FESystemElem::ELEM_VOLUME::num(), BCIZ);
          
          N_N_mem_sens_factor = mem_factor;
          N_N_plate_sens_factor = plate_factor;
          
          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a12d0a7a9c33167a9af367e0423372f3f" title="the discipline that owns this element">analysis_discipline</a>.<a class="code" href="class_discipline_1_1_analysis_discipline_base.html#a6dc9ef38729f861b96bf31634e24b5d0" title="checks if the analysis is dependent on temperature">checkPropertyDependenceOnTemperature</a>())
            {
            this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), &amp;N_N,
                                     design_point_enum_ID,
                                     FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
              this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), &amp;N_N_bend,
                                       design_point_enum_ID,
                                       FESystemElem::ELEM_VOLUME::num(), BCIZ);
              
            N_N_mem_factor = avg_mem_factor_temp_sens;
            N_N_plate_factor = avg_plate_factor_temp_sens;
            }
        }
        <span class="keywordflow">break</span>;
        
      <span class="keywordflow">default</span>:
        Assert(<span class="keyword">false</span>, ExcInternalError());
      }
    }
  <span class="keywordflow">else</span>
    {
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), &amp;N_N,
                             design_point_enum_ID,
                             FESystemElem::ELEM_VOLUME::num(), LAGRANGE);
      this-&gt;<a class="code" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a26d299a0ec41235dfac6fe0f9980716e">getFESystemElemQty</a>(FESystemElem::N_N_FACTOR::num(), &amp;N_N_bend,
                               design_point_enum_ID,
                               FESystemElem::ELEM_VOLUME::num(), BCIZ);
      
    N_N_mem_factor = mem_factor;
    N_N_plate_factor = plate_factor;
    }
  
  
  <span class="comment">// calculate the mass matrix</span>
  <span class="keyword">static</span> <span class="keywordtype">double</span> val1;
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes; i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_nodes; j++)
      {
        val1 = N_N_mem_factor * N_N(i,j) + N_N_mem_sens_factor * N_N_sens(i,j);
        (*matrix)(i,j) = val1;
        (*matrix)(n_nodes+i,n_nodes+j) = val1;
      }

  <span class="comment">//std::cout &lt;&lt; _N_bend;</span>
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;3*n_nodes; i++)
    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;3*n_nodes; j++)
      (*matrix)(2*n_nodes+i,2*n_nodes+j) = N_N_mem_factor * N_N_bend(i,j) + N_N_mem_sens_factor * N_N_bend_sens(i,j);
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_nodes;i++)
    (*matrix)(5*n_nodes+i,5*n_nodes+i) = 1.0e-6;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a003ac8d11e7615d288b2caaebeda9519"></a><!-- doxytag: member="FESystemElem::PlateDKBatoz::getElementPostProcessQty" ref="a003ac8d11e7615d288b2caaebeda9519" args="(std::vector&lt; unsigned int &gt;, std::vector&lt; DesignData::DesignParameter * &gt;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::auto_ptr&lt; <a class="el" href="class_elem_post_process_qty.html">ElemPostProcessQty</a> &gt; <a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a003ac8d11e7615d288b2caaebeda9519">FESystemElem::PlateDKBatoz::getElementPostProcessQty</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; unsigned int &gt;&#160;</td>
          <td class="paramname"><em>load_cases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="class_design_data_1_1_design_parameter.html">DesignData::DesignParameter</a> * &gt;&#160;</td>
          <td class="paramname"><em>dv_vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this function returns a vector of the post process quanties for this element. The quantities will consist of the strain, stress and their sensitivities. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">vector</td><td>of load case IDs for which the post process quantities need to be calculated </td></tr>
    <tr><td class="paramname">vector</td><td>of DVs for which the quantities need to be calculated </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_structural_elem.html#ab9be36a1a1bb9dee0a23194a0a79211d">FESystemElem::StructuralElem</a>.</p>

<p>Definition at line <a class="el" href="_plate_d_k_batoz_8_c_source.html#l00763">763</a> of file <a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  (void) load_cases;
  (void) dv_vector;
<span class="comment">//  std::auto_ptr&lt;ElemPostProcessQty&gt; return_qty(new ElemPostProcessQty(this-&gt;elem_ID));</span>
<span class="comment">//  </span>
<span class="comment">//  TensorValue&lt;double&gt; tensor;</span>
<span class="comment">//  </span>
<span class="comment">//  // create an fe that will be used for calculationi of the element strains and</span>
<span class="comment">//  // stresses. The vector fe_sens is for shape sensitivity</span><span class="comment"></span>
<span class="comment">////  std::auto_ptr&lt;FEBase&gt; fe(new FE&lt;2,LAGRANGE&gt;(FEType())),</span>
<span class="comment">////    fe_sens (new FE&lt;2,LAGRANGE&gt;(FEType()));</span>
<span class="comment"></span><span class="comment">//    </span>
<span class="comment">//  </span>
<span class="comment">//  unsigned int n_nodes = this-&gt;base_elem-&gt;n_nodes();</span>
<span class="comment">//  </span>
<span class="comment">//  static DenseMatrix&lt;double&gt; B_strain(3, 6*n_nodes) , B_strain_sens(3, 6*n_nodes);</span>
<span class="comment">//  B_strain.zero(); B_strain_sens.zero();</span>
<span class="comment">//  </span>
<span class="comment">//  // create rest of the necessary data structures</span>
<span class="comment">//  static DenseVector&lt;double&gt;  strain(3), strain_sens(3),</span>
<span class="comment">//    stress(3), stress_sens(3), strain_plus_thermal(3), </span>
<span class="comment">//    strain_plus_thermal_sens(3), strain_scratch(3);</span>
<span class="comment">//  </span>
<span class="comment">//  strain.zero(); strain_sens.zero();</span>
<span class="comment">//  stress.zero(); stress_sens.zero(); strain_plus_thermal.zero(); </span>
<span class="comment">//  strain_plus_thermal_sens.zero(); strain_scratch.zero();</span>
<span class="comment">//  </span>
<span class="comment">//  static DenseMatrix&lt;double&gt; material_factor(3,3), material_factor_sens(3,3);</span>
<span class="comment">//  material_factor.zero(); </span>
<span class="comment">//  material_factor_sens.zero();</span>
<span class="comment">//  </span>
<span class="comment">//  double temp_strain_material_factor = 0.0, temp_strain_material_factor_sens = 0.0,</span>
<span class="comment">//    ref_temp = 0.0, thickness = 0.0, thickness_sens = 0.0;</span>
<span class="comment">//    </span>
<span class="comment">//  // point at which this element will be initialized</span>
<span class="comment">//  // for now, this is only the centroid of the element</span>
<span class="comment">//  std::vector&lt;Point&gt; point_vec;</span>
<span class="comment">//  point_vec.push_back(Point(0.0,0.0,0.0));</span>
<span class="comment">//  </span>
<span class="comment">//  // then, reinit it at the base elem, at the element centroid, where the </span>
<span class="comment">//  // element strains and stresses will be evaluated</span>
<span class="comment">//  this-&gt;initialize_element(&amp;point_vec);</span>
<span class="comment">//  </span>
<span class="comment">//  // get the necessary data out of this element </span>
<span class="comment">//  const std::vector&lt; std::vector&lt;Real&gt; &gt;&amp; dphi_dx = this-&gt;fe_base-&gt;get_dphidx();</span>
<span class="comment">//  const std::vector&lt; std::vector&lt;Real&gt; &gt;&amp; dphi_dy = this-&gt;fe_base-&gt;get_dphidy();</span>
<span class="comment">//  const std::vector&lt;std::vector&lt;Real&gt; &gt;&amp; phi = this-&gt;fe_base-&gt;get_phi();</span>
<span class="comment">//  </span>
<span class="comment">//  // calculate B_strain matrix. Since the calculation is being performed at a single point, </span>
<span class="comment">//  // the vector of shape factor derivatives should have size = 1</span>
<span class="comment">//  assert (dphi_dx[0].size() == 1);</span>
<span class="comment">//  for (unsigned int i=0; i &lt; n_nodes; i++)</span>
<span class="comment">//    {</span>
<span class="comment">//    B_strain(0,i) = dphi_dx[i][0];  // epsilon_xx</span>
<span class="comment">//    B_strain(0,4*n_nodes+i) = 0.5 * thickness * dphi_dx[i][0]; // bending contribution</span>
<span class="comment">//    B_strain(1,n_nodes+i) = dphi_dy[i][0];  // epsilon_yy</span>
<span class="comment">//    B_strain(1,3*n_nodes+i) = - 0.5 * thickness * dphi_dy[i][0]; // bending contribution</span>
<span class="comment">//    B_strain(2,i) = dphi_dy[i][0];  // epsilon  xy </span>
<span class="comment">//    B_strain(2,3*n_nodes+i) = - 0.5 * thickness * dphi_dx[i][0]; // bending contribution</span>
<span class="comment">//    B_strain(2,n_nodes+i) = dphi_dx[i][0];  // epsilon xy</span>
<span class="comment">//    B_strain(2,4*n_nodes+i) = 0.5 * thickness * dphi_dy[i][0]; // bending contribution</span>
<span class="comment">//    }</span>
<span class="comment">//  </span>
<span class="comment">//  </span>
<span class="comment">//  // iterate over all the load cases, to calculate the strains and stresses</span>
<span class="comment">//  std::vector&lt;unsigned int&gt;::const_iterator load_case_it = load_cases.begin();</span>
<span class="comment">//  std::vector&lt;unsigned int&gt;::const_iterator load_case_end = load_cases.end(); </span>
<span class="comment">//      </span>
<span class="comment">//  std::vector&lt;DesignData::DesignParameter*&gt;::const_iterator dv_it, dv_begin, dv_end;</span>
<span class="comment">//  dv_begin = dv_vector.begin();</span>
<span class="comment">//  dv_end = dv_vector.end();</span>
<span class="comment">//  </span>
<span class="comment">//  </span>
<span class="comment">//  static DenseMatrix&lt;double&gt; transform_mat, transform_mat_sens;</span>
<span class="comment">//  transform_mat.zero(); transform_mat_sens.zero();</span>
<span class="comment">//  </span>
<span class="comment">//  this-&gt;getStructuralT_matrix(&amp;transform_mat, false);</span>
<span class="comment">//  </span>
<span class="comment">//  </span>
<span class="comment">//  // also, create dof_vectors</span>
<span class="comment">//  static DenseVector&lt;double&gt;  dof_values(6*n_nodes), dof_value_sens(6*n_nodes),</span>
<span class="comment">//    local_dof(6*n_nodes), local_dof_sens(6*n_nodes), scratch_vec(6*n_nodes),</span>
<span class="comment">//    nodal_temp(n_nodes),nodal_temp_sens(n_nodes),</span>
<span class="comment">//    dphi_dx_sens(n_nodes), dphi_dy_sens(n_nodes);</span>
<span class="comment">//  </span>
<span class="comment">//  dof_values.zero(); dof_value_sens.zero();</span>
<span class="comment">//  local_dof.zero(); local_dof_sens.zero(); </span>
<span class="comment">//  nodal_temp.zero(); nodal_temp_sens.zero();</span>
<span class="comment">//  dphi_dx_sens.zero(); dphi_dy_sens.zero(); </span>
<span class="comment">//  scratch_vec.zero();</span>
<span class="comment">//</span>
<span class="comment">//  </span>
<span class="comment">//  // initialize the material factors</span>
<span class="comment">//  this-&gt;elem_property_card-&gt;getPropertyValueFromMaterialCard(ALPHA_EXPANSION::num(),</span>
<span class="comment">//                                                             temp_strain_material_factor);</span>
<span class="comment">//  this-&gt;elem_property_card-&gt;getPropertyValueFromMaterialCard(TEMP_REF::num(),</span>
<span class="comment">//                                                             ref_temp);</span>
<span class="comment">//  this-&gt;elem_property_card-&gt;getPropertyValueFromMaterialCard(THICKNESS_2D_ELEM::num(),</span>
<span class="comment">//                                                             thickness);</span>
<span class="comment">//  </span>
<span class="comment">//  this-&gt;elem_property_card-&gt;getFactor(material_factor, STRESS_STRAIN_FACTOR::num());</span>
<span class="comment">//  </span>
<span class="comment">//  double temp = 0.0, temp_sens = 0.0;</span>
<span class="comment">//  </span>
<span class="comment">//  // iterate over each load case, and ask solver to solve for it</span>
<span class="comment">//  for (; load_case_it != load_case_end; load_case_it++)</span>
<span class="comment">//    {</span>
<span class="comment">//    </span>
<span class="comment">//    // get the DOF vector for this elem</span>
<span class="comment">//    this-&gt;getElemDofValuesForLoadCase(dof_values, *load_case_it);</span>
<span class="comment">//    </span>
<span class="comment">//    // transform these dofs to the local coordinate system</span>
<span class="comment">//    local_dof.zero();</span>
<span class="comment">//    transform_mat.right_multiply_vector(dof_values, local_dof);</span>
<span class="comment">//    </span>
<span class="comment">//    // get the loads for this element</span>
<span class="comment">//    this-&gt;getNodalTemperatureVector(nodal_temp, *load_case_it);</span>
<span class="comment">//    </span>
<span class="comment">//    // calculate the factor and the strain and stress</span>
<span class="comment">//    B_strain.right_multiply_vector(local_dof, strain);</span>
<span class="comment">//    </span>
<span class="comment">//    // add the thermal strain component and then calculate the stress</span>
<span class="comment">//    for (unsigned int i=0; i&lt;phi.size(); i++)</span>
<span class="comment">//      temp += phi[i][0] * nodal_temp(i);</span>
<span class="comment">//    </span>
<span class="comment">//    strain_plus_thermal.zero();</span>
<span class="comment">//    strain_plus_thermal(0) = strain(0) - temp_strain_material_factor * (temp - ref_temp);</span>
<span class="comment">//    strain_plus_thermal(1) = strain(1) - temp_strain_material_factor * (temp - ref_temp);</span>
<span class="comment">//    strain_plus_thermal(2) = strain(2);</span>
<span class="comment">//    </span>
<span class="comment">//    // now multiply to calculate the stresses</span>
<span class="comment">//    material_factor.right_multiply_vector(strain_plus_thermal, stress);</span>
<span class="comment">//    </span>
<span class="comment">//    </span>
<span class="comment">//    // add the two tensors</span>
<span class="comment">//    tensor.zero();</span>
<span class="comment">//    tensor(0,0) = strain(0);  // xx</span>
<span class="comment">//    tensor(1,1) = strain(1);  // yy</span>
<span class="comment">//    tensor(0,1) = strain(2);  // xy</span>
<span class="comment">//    tensor(1,0) = strain(2);  // yx</span>
<span class="comment">//    return_qty-&gt;addStrainTensor(tensor, *load_case_it);</span>
<span class="comment">//    </span>
<span class="comment">//    tensor.zero();</span>
<span class="comment">//    tensor(0,0) = stress(0);  // xx</span>
<span class="comment">//    tensor(1,1) = stress(1);  // yy</span>
<span class="comment">//    tensor(0,1) = stress(2);  // xy</span>
<span class="comment">//    tensor(1,0) = stress(2);  // yx</span>
<span class="comment">//    return_qty-&gt;addStressTensor(tensor, *load_case_it);</span>
<span class="comment">//    </span>
<span class="comment">//    tensor.zero();</span>
<span class="comment">//    tensor(0,0) = strain_plus_thermal(0);  // xx</span>
<span class="comment">//    tensor(1,1) = strain_plus_thermal(1);  // yy</span>
<span class="comment">//    tensor(0,1) = strain_plus_thermal(2);  // xy</span>
<span class="comment">//    tensor(1,0) = strain_plus_thermal(2);  // yx</span>
<span class="comment">//    return_qty-&gt;addMechanicalStrainTensor(tensor, *load_case_it);</span>
<span class="comment">//    </span>
<span class="comment">//    unsigned int dv_ID = 0;</span>
<span class="comment">//</span>
<span class="comment">//    // now calculate the sensitivities</span>
<span class="comment">//    dv_it = dv_begin;</span>
<span class="comment">//    for (; dv_it != dv_end; dv_it++)</span>
<span class="comment">//      {</span>
<span class="comment">//      dv_ID = (*dv_it)-&gt;getID();</span>
<span class="comment">//      this-&gt;clearSensitivityInitialization();</span>
<span class="comment">//      </span>
<span class="comment">//      // get the dof value sensitivity for this case</span>
<span class="comment">//      this-&gt;getElemDofValueSensitivityForLoadCaseAndDV(dof_value_sens, *load_case_it, dv_ID);</span>
<span class="comment">//      </span>
<span class="comment">//      // get the load sensitivity vectors</span>
<span class="comment">//      this-&gt;getNodalTemperatureVector(nodal_temp_sens, *load_case_it, true, dv_ID);</span>
<span class="comment">//      </span>
<span class="comment">//      material_factor_sens.zero();</span>
<span class="comment">//      temp_strain_material_factor_sens = 0.0;</span>
<span class="comment">//      </span>
<span class="comment">//      switch ((*dv_it)-&gt;getParameterTypeEnumID())</span>
<span class="comment">//        {</span>
<span class="comment">//        case PROPERTY_PARAMETER_ENUM_ID:</span>
<span class="comment">//          {</span>
<span class="comment">//            this-&gt;reinitForPropertySensitivity(dv_ID);</span>
<span class="comment">//            </span>
<span class="comment">//            // for a property DV, the strain operator sensitivity will be zero</span>
<span class="comment">//            B_strain_sens.zero();</span>
<span class="comment">//            </span>
<span class="comment">//            // if the property ID is the same as this elements property, then set the </span>
<span class="comment">//            // value of the property sensitivity. Else the value be zero</span>
<span class="comment">//            if ( this-&gt;elem_property_card-&gt;checkGlobalParameterDependence(dv_ID))</span>
<span class="comment">//              {</span>
<span class="comment">//              this-&gt;elem_property_card-&gt;getFactorSensitivityForGlobalParameter</span>
<span class="comment">//              (material_factor_sens, STRESS_STRAIN_FACTOR::num(), dv_ID);</span>
<span class="comment">//              this-&gt;elem_property_card-&gt;</span>
<span class="comment">//                getPropertyValueDerivativeForGlobalParameterFromMaterialCard</span>
<span class="comment">//                (ALPHA_EXPANSION::num(), dv_ID, temp_strain_material_factor_sens);</span>
<span class="comment">//              this-&gt;elem_property_card-&gt;</span>
<span class="comment">//                getPropertyValueDerivativeForGlobalParameterFromMaterialCard</span>
<span class="comment">//                (THICKNESS_2D_ELEM::num(), dv_ID, thickness_sens);</span>
<span class="comment">//              }</span>
<span class="comment">//            else </span>
<span class="comment">//              {</span>
<span class="comment">//              material_factor_sens.zero();</span>
<span class="comment">//              </span>
<span class="comment">//              temp_strain_material_factor_sens = 0.0;</span>
<span class="comment">//              }</span>
<span class="comment">//            </span>
<span class="comment">//            // also, calculate the sensitivity of the dof vector. The transformation matrix sensitivity </span>
<span class="comment">//            // will be zero for this case, since shape sensitivity will be zero</span>
<span class="comment">//            transform_mat.right_multiply_vector(dof_value_sens, local_dof_sens);</span>
<span class="comment">//          }</span>
<span class="comment">//          break;</span>
<span class="comment">//          </span>
<span class="comment">//        case SHAPE_PARAMETER_ENUM_ID:</span>
<span class="comment">//          {</span>
<span class="comment">//            Elem* pert_elem = NULL;</span>
<span class="comment">//            pert_elem = this-&gt;analysis_discipline.getPerturbedElemForShapeParameter(this-&gt;elem_ID,</span>
<span class="comment">//                                                                                    *dv_it);</span>
<span class="comment">//            this-&gt;reinitForShapeSensitivity(dv_ID, pert_elem, </span>
<span class="comment">//                                            (*dv_it)-&gt;getPerturbationStepSize());</span>
<span class="comment">//            </span>
<span class="comment">//            // set the factor_sens to zero</span>
<span class="comment">//            material_factor_sens.zero();</span>
<span class="comment">//            temp_strain_material_factor_sens = 0.0;</span>
<span class="comment">//            </span>
<span class="comment">//            // get the transformation matrix sensitivity and calculate the local_dof_sens</span>
<span class="comment">//            this-&gt;getStructuralT_matrix(&amp;transform_mat_sens, true);</span>
<span class="comment">//            </span>
<span class="comment">//            local_dof_sens.zero(); scratch_vec.zero();</span>
<span class="comment">//            transform_mat_sens.right_multiply_vector(dof_values, local_dof_sens);</span>
<span class="comment">//            </span>
<span class="comment">//            scratch_vec.zero();</span>
<span class="comment">//            transform_mat.right_multiply_vector(dof_value_sens, scratch_vec);</span>
<span class="comment">//            </span>
<span class="comment">//            local_dof_sens.add(1.0, scratch_vec);</span>
<span class="comment">//            </span>
<span class="comment">//            // now init the fe_sens to the perturbed DV and calculate the shape sensitivity of the</span>
<span class="comment">//            // B matrix</span>
<span class="comment">//            // then, reinit it at the base elem, at the element centroid, where the </span>
<span class="comment">//            // element strains and stresses will be evaluated</span>
<span class="comment">//            this-&gt;attachNewElem(this-&gt;perturbed_elem);</span>
<span class="comment">//            this-&gt;initialize_element(&amp;point_vec);</span>
<span class="comment">//</span>
<span class="comment">//            // get the necessary data out of this element </span>
<span class="comment">//            const std::vector&lt; std::vector&lt;Real&gt; &gt;&amp; dphi_dx_perturbed = </span>
<span class="comment">//              this-&gt;fe_base-&gt;get_dphidx();</span>
<span class="comment">//            const std::vector&lt; std::vector&lt;Real&gt; &gt;&amp; dphi_dy_perturbed = </span>
<span class="comment">//              this-&gt;fe_base-&gt;get_dphidy();</span>
<span class="comment">//            </span>
<span class="comment">//            dphi_dx_sens.zero();</span>
<span class="comment">//            dphi_dy_sens.zero();</span>
<span class="comment">//            </span>
<span class="comment">//            for (unsigned int i=0; i&lt;n_nodes; i++)</span>
<span class="comment">//              {</span>
<span class="comment">//              dphi_dx_sens(i) = dphi_dx_perturbed[i][0] - dphi_dx[i][0];</span>
<span class="comment">//              dphi_dy_sens(i) = dphi_dy_perturbed[i][0] - dphi_dy[i][0];</span>
<span class="comment">//              }</span>
<span class="comment">//            </span>
<span class="comment">//            dphi_dx_sens.scale(1.0/this-&gt;perturbation);</span>
<span class="comment">//            dphi_dy_sens.scale(1.0/this-&gt;perturbation);</span>
<span class="comment">//            </span>
<span class="comment">//            // calculate B_strain matrix. Since the calculation is being performed at a single point, </span>
<span class="comment">//            // the vector of shape factor derivatives should have size = 1</span>
<span class="comment">//            </span>
<span class="comment">//            for (unsigned int i=0; i &lt; n_nodes; i++)</span>
<span class="comment">//              {</span>
<span class="comment">//              B_strain_sens(0,i) = dphi_dx_sens(i);  // epsilon_xx</span>
<span class="comment">//              B_strain_sens(0,4*n_nodes+i) = 0.5 * (thickness * dphi_dx_sens(i) + </span>
<span class="comment">//                                                    thickness_sens * dphi_dx[i][0]); // bending contribution</span>
<span class="comment">//              B_strain_sens(1,n_nodes+i) = dphi_dy_sens(i);  // epsilon_yy</span>
<span class="comment">//              B_strain_sens(1,3*n_nodes+i) = - 0.5 * (thickness * dphi_dy_sens(i) + </span>
<span class="comment">//                                                      thickness_sens * dphi_dy[i][0]); // bending contribution</span>
<span class="comment">//              B_strain_sens(2,i) = dphi_dy_sens(i);  // epsilon  xy </span>
<span class="comment">//              B_strain_sens(2,3*n_nodes+i) = -0.5 * (thickness * dphi_dx_sens(i) + </span>
<span class="comment">//                                                     thickness_sens * dphi_dx[i][0]); // bending contribution</span>
<span class="comment">//              B_strain_sens(2,n_nodes+i) = dphi_dx_sens(i);  // epsilon xy</span>
<span class="comment">//              B_strain_sens(2,4*n_nodes+i) = 0.5 * (thickness * dphi_dy_sens(i) + </span>
<span class="comment">//                                                    thickness_sens * dphi_dy[i][0]); // bending contribution</span>
<span class="comment">//              }</span>
<span class="comment">//            </span>
<span class="comment">//          }</span>
<span class="comment">//          break;</span>
<span class="comment">//          </span>
<span class="comment">//        default:</span>
<span class="comment">//          abort();</span>
<span class="comment">//          break;</span>
<span class="comment">//        }</span>
<span class="comment">//      </span>
<span class="comment">//      // calculate the strain and stress</span>
<span class="comment">//      // calculate the factor and the strain and stress</span>
<span class="comment">//      strain_scratch.zero();</span>
<span class="comment">//      B_strain.right_multiply_vector(local_dof_sens, strain_sens);</span>
<span class="comment">//      B_strain_sens.right_multiply_vector(local_dof, strain_scratch);</span>
<span class="comment">//      strain_sens.add(1.0, strain_scratch);</span>
<span class="comment">//      </span>
<span class="comment">//      // add the thermal strain component and then calculate the stress</span>
<span class="comment">//      temp_sens = 0.0;</span>
<span class="comment">//      for (unsigned int i=0; i&lt;phi.size(); i++)</span>
<span class="comment">//        temp_sens += phi[i][0] * nodal_temp_sens(i);</span>
<span class="comment">//      </span>
<span class="comment">//      // add the temperture sensitivity effects to the strain sensitivity</span>
<span class="comment">//      strain_plus_thermal_sens.zero();</span>
<span class="comment">//      strain_plus_thermal_sens(0) = strain_sens(0) - temp_strain_material_factor * temp_sens -</span>
<span class="comment">//        temp_strain_material_factor_sens * (temp - ref_temp);</span>
<span class="comment">//      strain_plus_thermal_sens(1) = strain_sens(1) - temp_strain_material_factor * temp_sens -</span>
<span class="comment">//        temp_strain_material_factor_sens * (temp - ref_temp);</span>
<span class="comment">//      strain_plus_thermal_sens(2) = strain_sens(2);</span>
<span class="comment">//      </span>
<span class="comment">//      // now multiply to calculate the stresses</span>
<span class="comment">//      strain_scratch.zero();</span>
<span class="comment">//      material_factor_sens.right_multiply_vector(strain_plus_thermal, stress_sens);</span>
<span class="comment">//      material_factor.right_multiply_vector(strain_plus_thermal_sens, strain_scratch);</span>
<span class="comment">//      stress_sens.add(1.0, strain_scratch);</span>
<span class="comment">//      </span>
<span class="comment">//      // add the two tensors</span>
<span class="comment">//      tensor.zero();</span>
<span class="comment">//      tensor(0,0) = strain_sens(0);  // xx</span>
<span class="comment">//      tensor(1,1) = strain_sens(1);  // yy</span>
<span class="comment">//      tensor(0,1) = strain_sens(2);  // xy</span>
<span class="comment">//      tensor(1,0) = strain_sens(2);  // yx</span>
<span class="comment">//      return_qty-&gt;addStrainTensor(tensor, *load_case_it,  dv_ID);</span>
<span class="comment">//      </span>
<span class="comment">//      tensor.zero();</span>
<span class="comment">//      tensor(0,0) = stress_sens(0);  // xx</span>
<span class="comment">//      tensor(1,1) = stress_sens(1);  // yy</span>
<span class="comment">//      tensor(0,1) = stress_sens(2);  // xy</span>
<span class="comment">//      tensor(1,0) = stress_sens(2);  // yx</span>
<span class="comment">//      return_qty-&gt;addStressTensor(tensor, *load_case_it, dv_ID);</span>
<span class="comment">//      </span>
<span class="comment">//      tensor.zero();</span>
<span class="comment">//      tensor(0,0) = strain_plus_thermal_sens(0);  // xx</span>
<span class="comment">//      tensor(1,1) = strain_plus_thermal_sens(1);  // yy</span>
<span class="comment">//      tensor(0,1) = strain_plus_thermal_sens(2);  // xy</span>
<span class="comment">//      tensor(1,0) = strain_plus_thermal_sens(2);  // yx</span>
<span class="comment">//      return_qty-&gt;addMechanicalStrainTensor(tensor, *load_case_it,  dv_ID);</span>
<span class="comment">//      </span>
<span class="comment">//      }</span>
<span class="comment">//    }  </span>
<span class="comment">//  </span>
<span class="comment">//  return return_qty;</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa440d800b75eb23ada903a2c74f9850a"></a><!-- doxytag: member="FESystemElem::PlateDKBatoz::getFETypes" ref="aa440d800b75eb23ada903a2c74f9850a" args="(std::vector&lt; FEType &gt; &amp;fetypes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#aa440d800b75eb23ada903a2c74f9850a">FESystemElem::PlateDKBatoz::getFETypes</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; FEType &gt; &amp;&#160;</td>
          <td class="paramname"><em>fetypes</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>inserts the finite element types to be used for this element in the input parameters </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#a37fb0c443dc328281227b0edbc3ff6cf">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="_plate_d_k_batoz_8_c_source.html#l00041">41</a> of file <a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  fetypes.clear();
  
  fetypes.push_back(FEType());
  FEType* fe = &amp;(fetypes.back());
  fe-&gt;order = FIRST;
  fe-&gt;family = LAGRANGE;
  
  fetypes.push_back(FEType());
  fe = &amp;(fetypes.back());
  fe-&gt;order = SECOND;
  fe-&gt;family = BCIZ;

  fetypes.push_back(FEType());
  fe = &amp;(fetypes.back());
  fe-&gt;order = SECOND;
  fe-&gt;family = BATOZ;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5408f7d2c73594738f4b725680c57f5c"></a><!-- doxytag: member="FESystemElem::PlateDKBatoz::getQuadratureRules" ref="a5408f7d2c73594738f4b725680c57f5c" args="(std::map&lt; FEFamily, std::pair&lt; QuadratureType, Order &gt; &gt; &amp;quadratures)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_elem_1_1_plate_d_k_batoz.html#a5408f7d2c73594738f4b725680c57f5c">FESystemElem::PlateDKBatoz::getQuadratureRules</a> </td>
          <td>(</td>
          <td class="paramtype">std::map&lt; FEFamily, std::pair&lt; QuadratureType, Order &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>quadratures</em></td><td>)</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>inserts the quadrature rules to be used for the different elements </p>

<p>Implements <a class="el" href="class_f_e_system_elem_1_1_f_e_system_elem_base.html#ac4ee610fdbe303c87d6b4e4f901d96ba">FESystemElem::FESystemElemBase</a>.</p>

<p>Definition at line <a class="el" href="_plate_d_k_batoz_8_c_source.html#l00067">67</a> of file <a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  quadratures.clear();
  
  <span class="keywordtype">bool</span> insert_success = 
    quadratures.insert(std::map&lt;FEFamily, std::pair&lt;QuadratureType, Order&gt; &gt;::
                       value_type(LAGRANGE, std::make_pair(QGAUSS, NINTH))).second;
  
  Assert(insert_success, ExcInternalError());
  
  insert_success = 
  quadratures.insert(std::map&lt;FEFamily, std::pair&lt;QuadratureType, Order&gt; &gt;::
                     value_type(BCIZ, std::make_pair(QGAUSS, FIFTH))).second;
  
  Assert(insert_success, ExcInternalError());

  insert_success = 
    quadratures.insert(std::map&lt;FEFamily, std::pair&lt;QuadratureType, Order&gt; &gt;::
                       value_type(BATOZ, std::make_pair(QGAUSS, FIFTH))).second;
  
  Assert(insert_success, ExcInternalError());

}
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/StructuralElems/<a class="el" href="_plate_d_k_batoz_8h_source.html">PlateDKBatoz.h</a></li>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/StructuralElems/<a class="el" href="_plate_d_k_batoz_8_c_source.html">PlateDKBatoz.C</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 12 2012 18:06:22 for fesystem by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
