<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>fesystem: FESystemNumerics::PetscMatrixBase&lt; T &gt; Class Template Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">fesystem
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_f_e_system_numerics.html">FESystemNumerics</a>      </li>
      <li class="navelem"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">PetscMatrixBase</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">FESystemNumerics::PetscMatrixBase&lt; T &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="FESystemNumerics::PetscMatrixBase" --><!-- doxytag: inherits="FESystemNumerics::MatrixBase" -->
<p><code>#include &lt;<a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for FESystemNumerics::PetscMatrixBase&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base__inherit__graph.gif" border="0" usemap="#_f_e_system_numerics_1_1_petsc_matrix_base_3_01_t_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="_f_e_system_numerics_1_1_petsc_matrix_base_3_01_t_01_4_inherit__map" id="_f_e_system_numerics_1_1_petsc_matrix_base_3_01_t_01_4_inherit__map">
<area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html" title="FESystemNumerics::PetscSeqDenseMatrix\&lt; T \&gt;" alt="" coords="4,161,312,189"/><area shape="rect" id="node2" href="class_f_e_system_numerics_1_1_matrix_base.html" title="FESystemNumerics::MatrixBase\&lt; T \&gt;" alt="" coords="37,6,280,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for FESystemNumerics::PetscMatrixBase&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base__coll__graph.gif" border="0" usemap="#_f_e_system_numerics_1_1_petsc_matrix_base_3_01_t_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="_f_e_system_numerics_1_1_petsc_matrix_base_3_01_t_01_4_coll__map" id="_f_e_system_numerics_1_1_petsc_matrix_base_3_01_t_01_4_coll__map">
<area shape="rect" id="node2" href="class_f_e_system_numerics_1_1_matrix_base.html" title="FESystemNumerics::MatrixBase\&lt; T \&gt;" alt="" coords="21,6,264,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_f_e_system_numerics_1_1_petsc_matrix_base-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aa2627249281b0242b9945f8cf8a460bb">PetscMatrixBase</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor  <a href="#aa2627249281b0242b9945f8cf8a460bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae31a3a720c3b22dca683a44b7cf80d2d">~PetscMatrixBase</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a4f5214388cd61e98be5cd3776b216328">getMatrixPackage</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a3d1013fd45189ca10cd715ccf048857d">resize</a> (const unsigned int <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>, const unsigned int <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c">zero</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aedfc34e4545d0baee10a972a43e11cd3">el</a> (const unsigned int i, const unsigned int j) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a440da4d6191d314453b25d39aa879cbe">getRow</a> (const unsigned int i, <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;vec)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the <code>i</code> th row of the matrix in the given vector  <a href="#a440da4d6191d314453b25d39aa879cbe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a41de6854277687999d2d13fa124307b2">getDiagonal</a> (<a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;vec)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the diagonal of the matrix in the given vector  <a href="#a41de6854277687999d2d13fa124307b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a61d3ca9a3e1f750e2b28f1dd503990d7">shift</a> (const T val)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">adds <code>val</code> to all diagonal elements of the matrix  <a href="#a61d3ca9a3e1f750e2b28f1dd503990d7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38">set</a> (const unsigned int i, const unsigned int j, const T val)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a0f251edb6fa8ba71d4630398292b8797">set</a> (const std::vector&lt; unsigned int &gt; &amp;i, const std::vector&lt; unsigned int &gt; &amp;j, const T *val)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae18d819dc1f95b6b8f157055b2d9c27c">setRow</a> (const unsigned row_num, const <a class="el" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase</a>&lt; T &gt; &amp;vector)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1d9525c2c38f4c1d80943afe2f8bfe38">setRow</a> (const unsigned row_num, const std::vector&lt; unsigned int &gt; &amp;col_ids, const <a class="el" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase</a>&lt; T &gt; &amp;vector)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aa6a1ff5036f446d56c04ebc418ff2e2d">leftDiagonalScale</a> (const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;vector)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cb1fed88195cc69d3975f0287e8009c">rightDiagonalScale</a> (const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;vector)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a45ae316274d5acff404ef6bc0ceedaf9">leftMultiply</a> (const <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html">FESystemNumerics::MatrixBase</a>&lt; T &gt; &amp;matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a0923a736e4351ee9e148f8b1e3042d61">leftMultiplyTranspose</a> (const <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html">FESystemNumerics::MatrixBase</a>&lt; T &gt; &amp;matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ade5c4ab14ba12a86e8ccc6d8519287a7">rightMultiply</a> (const <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html">FESystemNumerics::MatrixBase</a>&lt; T &gt; &amp;matrix)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adee2257f7d4a1e65682a6ad595036d02">leftMultiplyVector</a> (const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;vector_in, <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;result)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a89fe3f3f5841376aa58fe144278c707c">rightMultiplyVector</a> (const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;vector_in, <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;result)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa">add</a> (const T val, const <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html">FESystemNumerics::MatrixBase</a>&lt; T &gt; &amp;matrix, const bool same_nonzer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ac6b5a99815855e866a3dbfafeec45b05">add</a> (const unsigned int i, const unsigned int j, const T factor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a75408aa61b45d0c9d5b0208f2e9ef910">add</a> (const std::vector&lt; unsigned int &gt; &amp;i, const std::vector&lt; unsigned int &gt; &amp;j, const T *val)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a15f229e47968131c7df600ba3e6f2448">diagonalAdd</a> (const T val, const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;diag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b">scale</a> (const T factor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d">getMat</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the Petsc matrix data structure  <a href="#a73251b033aaa5845cc318163239eac5d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6bfa448433308275bdd9f7631e629c48">getMat</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a3f24ec97182d2d15ee469c8a7b6a8758">flushAssemble</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">method to flush assemble the matrix  <a href="#a3f24ec97182d2d15ee469c8a7b6a8758"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9">finalAssemble</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">method to perform a final assembly of the matrix  <a href="#adbf89f7947378034e9f5ff67898981c9"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722">LastAction</a> { <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722aaf54fe0b4b7ad8f4660359fc7ed085ae">ADD</a>, 
<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722a525c7bdf246f47c83398fd3a4eeff39a">INSERT</a>, 
<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722a2d6bde575342d8fb8cc13c56a8b472ee">FLUSH_ASSEMBLE</a>, 
<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722aaa3a14b0bf319395263ce25c26243dd4">FINAL_ASSEMBLE</a>
 }</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">an enumeration to keep track of action performed  <a href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722">LastAction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1">petsc_mat</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Petsc matrix data structure.  <a href="#a96f18d0fa5cc3b25ec1a7f8106b342a1"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename T&gt;<br/>
class FESystemNumerics::PetscMatrixBase&lt; T &gt;</h3>

<p>this class provides a base class for different kinds of matrices </p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00024">24</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>
</div><hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="aef002a32c90536d0a22de2834f8fa722"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::LastAction" ref="aef002a32c90536d0a22de2834f8fa722" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722">FESystemNumerics::PetscMatrixBase::LastAction</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>an enumeration to keep track of action performed </p>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aef002a32c90536d0a22de2834f8fa722aaf54fe0b4b7ad8f4660359fc7ed085ae"></a><!-- doxytag: member="ADD" ref="aef002a32c90536d0a22de2834f8fa722aaf54fe0b4b7ad8f4660359fc7ed085ae" args="" -->ADD</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aef002a32c90536d0a22de2834f8fa722a525c7bdf246f47c83398fd3a4eeff39a"></a><!-- doxytag: member="INSERT" ref="aef002a32c90536d0a22de2834f8fa722a525c7bdf246f47c83398fd3a4eeff39a" args="" -->INSERT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aef002a32c90536d0a22de2834f8fa722a2d6bde575342d8fb8cc13c56a8b472ee"></a><!-- doxytag: member="FLUSH_ASSEMBLE" ref="aef002a32c90536d0a22de2834f8fa722a2d6bde575342d8fb8cc13c56a8b472ee" args="" -->FLUSH_ASSEMBLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aef002a32c90536d0a22de2834f8fa722aaa3a14b0bf319395263ce25c26243dd4"></a><!-- doxytag: member="FINAL_ASSEMBLE" ref="aef002a32c90536d0a22de2834f8fa722aaa3a14b0bf319395263ce25c26243dd4" args="" -->FINAL_ASSEMBLE</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00227">227</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>
<div class="fragment"><pre class="fragment">{<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722aaf54fe0b4b7ad8f4660359fc7ed085ae">ADD</a>, <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722a525c7bdf246f47c83398fd3a4eeff39a">INSERT</a>, <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722a2d6bde575342d8fb8cc13c56a8b472ee">FLUSH_ASSEMBLE</a>, <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722aaa3a14b0bf319395263ce25c26243dd4">FINAL_ASSEMBLE</a>};
</pre></div>
</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aa2627249281b0242b9945f8cf8a460bb"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::PetscMatrixBase" ref="aa2627249281b0242b9945f8cf8a460bb" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">PetscMatrixBase</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>constructor </p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00243">243</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>
<div class="fragment"><pre class="fragment">                                                   :
<a class="code" href="class_f_e_system_numerics_1_1_matrix_base.html">FESystemNumerics::MatrixBase&lt;T&gt;</a>()
{}
</pre></div>
</div>
</div>
<a class="anchor" id="ae31a3a720c3b22dca683a44b7cf80d2d"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::~PetscMatrixBase" ref="ae31a3a720c3b22dca683a44b7cf80d2d" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::~<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">PetscMatrixBase</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor. Empty. </p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00250">250</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>
<div class="fragment"><pre class="fragment">{}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a5cf620d20826ab76f11656a9e73acaaa"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::add" ref="a5cf620d20826ab76f11656a9e73acaaa" args="(const T val, const FESystemNumerics::MatrixBase&lt; T &gt; &amp;matrix, const bool same_nonzer)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa">add</a> </td>
          <td>(</td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html">FESystemNumerics::MatrixBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>same_nonzer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds  to this matrix </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a7952f9b4a54a73c3c5260ad680b2e9c9">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00897">897</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01069">FESystemNumerics::PetscMatrixBase&lt; T &gt;::getMat()</a>, and <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91">FESystemNumerics::MatrixBase&lt; T &gt;::getMatrixPackage()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">RadiationCavityAnalysis::calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00579">RadiationCavityAnalysis::calculateG_Matrix()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">RadiationCavityAnalysis::calculateShapeFactorMatrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(matrix.<a class="code" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91">getMatrixPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());

  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  
  <span class="keyword">const</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp; mat = 
    <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(matrix);
  <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(mat).<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();

  PetscErrorCode ierr;
  <span class="keywordflow">if</span> (same_nonzero)
    ierr = MatAXPY(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, val, mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure">getMat</a>(), SAME_NONZERO_PATTERN); 
  <span class="keywordflow">else</span>
    ierr = MatAXPY(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, val, mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure">getMat</a>(), DIFFERENT_NONZERO_PATTERN); 
  
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_a5cf620d20826ab76f11656a9e73acaaa_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_a5cf620d20826ab76f11656a9e73acaaa_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_a5cf620d20826ab76f11656a9e73acaaa_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_a5cf620d20826ab76f11656a9e73acaaa_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="347,5,642,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91" title="FESystemNumerics::MatrixBase::getMatrixPackage" alt="" coords="331,57,658,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac6b5a99815855e866a3dbfafeec45b05"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::add" ref="ac6b5a99815855e866a3dbfafeec45b05" args="(const unsigned int i, const unsigned int j, const T factor)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa">add</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds <code>factor</code> to every element in the matrix. </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#aa51b1a132d13c7742f2027a71e63a788">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00936">936</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a3f24ec97182d2d15ee469c8a7b6a8758" title="method to flush assemble the matrix">flushAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }

  PetscErrorCode ierr;
  ierr = MatSetValue (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, i, j,
                      val, ADD_VALUES);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
  
  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a> = <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a75408aa61b45d0c9d5b0208f2e9ef910"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::add" ref="a75408aa61b45d0c9d5b0208f2e9ef910" args="(const std::vector&lt; unsigned int &gt; &amp;i, const std::vector&lt; unsigned int &gt; &amp;j, const T *val)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa">add</a> </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>adds multiple elements with the indeces given in i and j. The val should be a 2-D matrix of dimensions equal to size of vectors i and j. </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a84ba4eec1d1d333adf91dccdf6ade078">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00967">967</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a3f24ec97182d2d15ee469c8a7b6a8758" title="method to flush assemble the matrix">flushAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }

  PetscErrorCode ierr;
  ierr = MatSetValues (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, i.size(), (<span class="keyword">const</span> PetscInt*) &amp;(i[0]), 
                       j.size(), (<span class="keyword">const</span> PetscInt*) &amp;(j[0]),
                       val, ADD_VALUES);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  
  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a> = <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a15f229e47968131c7df600ba3e6f2448"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::diagonalAdd" ref="a15f229e47968131c7df600ba3e6f2448" args="(const T val, const FESystemNumerics::VectorBase&lt; T &gt; &amp;diag)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a15f229e47968131c7df600ba3e6f2448">diagonalAdd</a> </td>
          <td>(</td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>diag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>adds a diagonal matrix times a factor to this matrix. The diagonal matrix is given as a vector. </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#ac6ff04b0fbb81652de9f166dd0c96ac3">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l01000">1000</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="ffp_8c_source.html#l00148">add</a>, <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">FESystemNumerics::VectorBase&lt; T &gt;::getVectorPackage()</a>, <a class="el" href="_arpack_eigen_solver_8h_source.html#l00290">n</a>, and <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6">FESystemNumerics::VectorBase&lt; T &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">RadiationCavityAnalysis::calculateB_Matrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert (vec.getVectorPackage() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  Assert (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>() == this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>(), ExcInternalError());
  Assert (vec.size() == this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>(), ExcInternalError());
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a3f24ec97182d2d15ee469c8a7b6a8758" title="method to flush assemble the matrix">flushAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  
  <span class="keyword">const</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a> &amp; pvec = 
    <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a> &amp;<span class="keyword">&gt;</span>(vec);
  <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a> &amp;<span class="keyword">&gt;</span>(pvec).assemble();
  Vec petsc_vector =   <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a> &amp;<span class="keyword">&gt;</span>(pvec).getVec();
  
  PetscErrorCode ierr;
  T *vec_vals;

  ierr = VecGetArray (petsc_vector, &amp;vec_vals);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a>(); i++)
    this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cf620d20826ab76f11656a9e73acaaa">add</a>(i,i, val * vec_vals[i]);
  
  ierr = VecRestoreArray (petsc_vector, &amp;vec_vals);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_a15f229e47968131c7df600ba3e6f2448_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_a15f229e47968131c7df600ba3e6f2448_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_a15f229e47968131c7df600ba3e6f2448_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_a15f229e47968131c7df600ba3e6f2448_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="381,5,712,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6" title="FESystemNumerics::VectorBase::size" alt="" coords="424,57,670,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aedfc34e4545d0baee10a972a43e11cd3"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::el" ref="aedfc34e4545d0baee10a972a43e11cd3" args="(const unsigned int i, const unsigned int j) const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aedfc34e4545d0baee10a972a43e11cd3">el</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the <code></code>(i,j) element of the matrix. Since internal data representations may differ, you must redefine this function. </dd></dl>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a9520183c336e8be3a7d61de161aa149d">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00281">281</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>

<p>Referenced by <a class="el" href="_thermal_analysis_8_c_source.html#l00698">Discipline::ThermalAnalysis::performAdditionalOperationsOnGlobalQuantities()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// if the data has not been flushed, do that before accessing the value</span>
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  
  PetscErrorCode ierr;
  PetscInt i_num = i;
  PetscInt j_num = j;
  T val;

  ierr = MatGetValues (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, 1, &amp;i_num, 1, &amp;j_num, (PetscScalar*) &amp;val);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);

  <span class="keywordflow">return</span> val;
}
</pre></div>
</div>
</div>
<a class="anchor" id="adbf89f7947378034e9f5ff67898981c9"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::finalAssemble" ref="adbf89f7947378034e9f5ff67898981c9" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9">finalAssemble</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>method to perform a final assembly of the matrix </p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l01103">1103</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00661">RadiationCavityAnalysis::calculateA_InverseMatrix()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00721">RadiationCavityAnalysis::calculateB_InverseMatrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr;
  ierr = MatAssemblyBegin(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>,MAT_FINAL_ASSEMBLY);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
  ierr = MatAssemblyEnd(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>,MAT_FINAL_ASSEMBLY);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
  
  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a> = <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3f24ec97182d2d15ee469c8a7b6a8758"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::flushAssemble" ref="a3f24ec97182d2d15ee469c8a7b6a8758" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a3f24ec97182d2d15ee469c8a7b6a8758">flushAssemble</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>method to flush assemble the matrix </p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l01088">1088</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr;
  ierr = MatAssemblyBegin(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>,MAT_FLUSH_ASSEMBLY);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
  ierr = MatAssemblyEnd(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>,MAT_FLUSH_ASSEMBLY);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
  
  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a> = <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a41de6854277687999d2d13fa124307b2"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::getDiagonal" ref="a41de6854277687999d2d13fa124307b2" args="(FESystemNumerics::VectorBase&lt; T &gt; &amp;vec)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a41de6854277687999d2d13fa124307b2">getDiagonal</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns the diagonal of the matrix in the given vector </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a0a158c637f8244ad77b868924eadb773">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00365">365</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">FESystemNumerics::VectorBase&lt; T &gt;::getVectorPackage()</a>, <a class="el" href="_arpack_eigen_solver_8h_source.html#l00290">n</a>, and <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6">FESystemNumerics::VectorBase&lt; T &gt;::size()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01592">RadiationCavityAnalysis::getTemperatureDependentFluxCorrectionVector()</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(vec.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">getVectorPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  
  Assert (vec.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6">size</a>() == this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>(), ExcInternalError());
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
  {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
  }
  
  PetscErrorCode ierr;

  Vec pvec = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vec).getVec();

  <span class="comment">// get the row</span>
  ierr = MatGetDiagonal(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, pvec);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_a41de6854277687999d2d13fa124307b2_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_a41de6854277687999d2d13fa124307b2_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_a41de6854277687999d2d13fa124307b2_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_a41de6854277687999d2d13fa124307b2_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="379,5,709,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6" title="FESystemNumerics::VectorBase::size" alt="" coords="421,57,667,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a73251b033aaa5845cc318163239eac5d"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::getMat" ref="a73251b033aaa5845cc318163239eac5d" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Mat <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d">getMat</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns the Petsc matrix data structure </p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l01069">1069</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>Referenced by <a class="el" href="_petsc_matrix_base_8h_source.html#l00897">FESystemNumerics::PetscMatrixBase&lt; T &gt;::add()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00661">RadiationCavityAnalysis::calculateA_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00721">RadiationCavityAnalysis::calculateB_InverseMatrix()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00169">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::leftMultiply()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00654">FESystemNumerics::PetscMatrixBase&lt; T &gt;::leftMultiply()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00213">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::leftMultiplyTranspose()</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l00698">FESystemNumerics::PetscMatrixBase&lt; T &gt;::leftMultiplyTranspose()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00091">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::PetscSeqDenseMatrix()</a>, <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00258">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::rightMultiply()</a>, and <a class="el" href="_petsc_matrix_base_8h_source.html#l00742">FESystemNumerics::PetscMatrixBase&lt; T &gt;::rightMultiply()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6bfa448433308275bdd9f7631e629c48"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::getMat" ref="a6bfa448433308275bdd9f7631e629c48" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">const Mat <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d">getMat</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>a constant Petsc matrix data structure </dd></dl>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l01079">1079</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4f5214388cd61e98be5cd3776b216328"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::getMatrixPackage" ref="a4f5214388cd61e98be5cd3776b216328" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a4f5214388cd61e98be5cd3776b216328">getMatrixPackage</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the matrix package </dd></dl>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00257">257</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> FESystem::PETSC_PACKAGE::num();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a440da4d6191d314453b25d39aa879cbe"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::getRow" ref="a440da4d6191d314453b25d39aa879cbe" args="(const unsigned int i, FESystemNumerics::VectorBase&lt; T &gt; &amp;vec)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a440da4d6191d314453b25d39aa879cbe">getRow</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns the <code>i</code> th row of the matrix in the given vector </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#adc882a12498d3fd72ac5f6c3e3848ceb">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00313">313</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">FESystemNumerics::VectorBase&lt; T &gt;::getVectorPackage()</a>, <a class="el" href="_arpack_eigen_solver_8h_source.html#l00290">n</a>, <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6">FESystemNumerics::VectorBase&lt; T &gt;::size()</a>, and <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#a0169b6538792acd62a1724ea15dfbe94">FESystemNumerics::VectorBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01661">RadiationCavityAnalysis::calculateB_TemperatureDependentJacobianContribution()</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(vec.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">getVectorPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());

  Assert (vec.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6">size</a>() == this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a>(), ExcInternalError());
    
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }

  PetscErrorCode ierr;
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_cols, *cols;
  T *row_vals, *vec_vals;
  
  <span class="comment">// get the row</span>
  ierr = MatGetRow (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, i, (PetscInt*) &amp;(n_cols), (<span class="keyword">const</span> PetscInt**) &amp;(cols), 
                    (<span class="keyword">const</span> PetscScalar**) &amp;(row_vals));
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="comment">// copy values in the vector</span>
  vec.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#a0169b6538792acd62a1724ea15dfbe94">zero</a>();
  Vec pvec = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vec).getVec();
  ierr = VecGetArray (pvec, &amp;vec_vals);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j &lt; n_cols; j++)
    vec_vals[cols[j]] = row_vals[j];

  ierr = VecRestoreArray (pvec, &amp;vec_vals);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);

  ierr = MatRestoreRow (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, i, (PetscInt*) &amp;(n_cols), (<span class="keyword">const</span> PetscInt**) &amp;(cols), 
                        (<span class="keyword">const</span> PetscScalar**) &amp;(row_vals));
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_a440da4d6191d314453b25d39aa879cbe_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_a440da4d6191d314453b25d39aa879cbe_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_a440da4d6191d314453b25d39aa879cbe_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_a440da4d6191d314453b25d39aa879cbe_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="352,5,683,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ac24529fdd3dbcd83847852bb7b2ed3c6" title="FESystemNumerics::VectorBase::size" alt="" coords="394,57,640,85"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_vector_base.html#a0169b6538792acd62a1724ea15dfbe94" title="FESystemNumerics::VectorBase::zero" alt="" coords="393,109,641,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa6a1ff5036f446d56c04ebc418ff2e2d"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::leftDiagonalScale" ref="aa6a1ff5036f446d56c04ebc418ff2e2d" args="(const FESystemNumerics::VectorBase&lt; T &gt; &amp;vector)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aa6a1ff5036f446d56c04ebc418ff2e2d">leftDiagonalScale</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vector</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>multiplies the matrix with a diagonal matrix on the left hand side. The diagonal matrix is represented as a vector. </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a27893d3645e4886846b9127263dae922">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00585">585</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00534">FESystemNumerics::PetscVectorBase&lt; T &gt;::getVec()</a>, and <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">FESystemNumerics::VectorBase&lt; T &gt;::getVectorPackage()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">RadiationCavityAnalysis::calculateB_Matrix()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01395">RadiationCavityAnalysis::getFEJacobianMatrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(vector.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">getVectorPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  
  <span class="keyword">const</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp; vec = 
    <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vector);
  <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vec).assemble();
  
  <span class="comment">// create a temporary matrix to store the result in</span>
  PetscErrorCode ierr = 0;
  ierr = MatDiagonalScale (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure">getVec</a>(), PETSC_NULL);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_aa6a1ff5036f446d56c04ebc418ff2e2d_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_aa6a1ff5036f446d56c04ebc418ff2e2d_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_aa6a1ff5036f446d56c04ebc418ff2e2d_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_aa6a1ff5036f446d56c04ebc418ff2e2d_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="428,5,724,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="411,57,741,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a45ae316274d5acff404ef6bc0ceedaf9"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::leftMultiply" ref="a45ae316274d5acff404ef6bc0ceedaf9" args="(const FESystemNumerics::MatrixBase&lt; T &gt; &amp;matrix)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a45ae316274d5acff404ef6bc0ceedaf9">leftMultiply</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html">FESystemNumerics::MatrixBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs the operation: (*this) &lt;- M2 * (*this) </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#aa26e1f7ef1c487bcc7b5a334335a5c05">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a63f0f418eefb914bea8c3cf8ed47bc9f">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00654">654</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01069">FESystemNumerics::PetscMatrixBase&lt; T &gt;::getMat()</a>, and <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91">FESystemNumerics::MatrixBase&lt; T &gt;::getMatrixPackage()</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(matrix.<a class="code" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91">getMatrixPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  

  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }

  <span class="keyword">const</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp; mat = 
    <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(matrix);
  <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(mat).<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
  
  <span class="comment">// create a temporary matrix to store the result in</span>
  Mat result_mat;
  PetscErrorCode ierr = 0;
  ierr = MatMatMult (mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure">getMat</a>(), this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, MAT_INITIAL_MATRIX, PETSC_DEFAULT, 
                     &amp;result_mat);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="comment">// since Petsc will itself create the result matrix, we can destroy the matrix </span>
  <span class="comment">// of this object, and store the pointer of result_mat</span>
  ierr = MatDestroy(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);

  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a> = result_mat;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_a45ae316274d5acff404ef6bc0ceedaf9_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_a45ae316274d5acff404ef6bc0ceedaf9_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_a45ae316274d5acff404ef6bc0ceedaf9_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_a45ae316274d5acff404ef6bc0ceedaf9_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="387,5,682,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91" title="FESystemNumerics::MatrixBase::getMatrixPackage" alt="" coords="371,57,698,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0923a736e4351ee9e148f8b1e3042d61"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::leftMultiplyTranspose" ref="a0923a736e4351ee9e148f8b1e3042d61" args="(const FESystemNumerics::MatrixBase&lt; T &gt; &amp;matrix)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a0923a736e4351ee9e148f8b1e3042d61">leftMultiplyTranspose</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html">FESystemNumerics::MatrixBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs the operation: (*this) &lt;- M2^T * (*this) </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#ad9fbd0642f659aba0413caa255f00fa4">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a4e686c59ee1ffbc455c0a330613d63b7">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00698">698</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01069">FESystemNumerics::PetscMatrixBase&lt; T &gt;::getMat()</a>, and <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91">FESystemNumerics::MatrixBase&lt; T &gt;::getMatrixPackage()</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(matrix.<a class="code" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91">getMatrixPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  
  <span class="keyword">const</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp; mat = 
    <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(matrix);
  <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(mat).<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
  
  <span class="comment">// create a temporary matrix to store the result in</span>
  Mat result_mat;
  PetscErrorCode ierr = 0;
  ierr = MatMatMultTranspose(mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure">getMat</a>(), this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, 
                             MAT_INITIAL_MATRIX, PETSC_DEFAULT, &amp;result_mat);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="comment">// since Petsc will itself create the result matrix, we can destroy the matrix </span>
  <span class="comment">// of this object, and store the pointer of result_mat</span>
  ierr = MatDestroy(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a> = result_mat;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_a0923a736e4351ee9e148f8b1e3042d61_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_a0923a736e4351ee9e148f8b1e3042d61_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_a0923a736e4351ee9e148f8b1e3042d61_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_a0923a736e4351ee9e148f8b1e3042d61_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="451,5,746,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91" title="FESystemNumerics::MatrixBase::getMatrixPackage" alt="" coords="435,57,762,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adee2257f7d4a1e65682a6ad595036d02"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::leftMultiplyVector" ref="adee2257f7d4a1e65682a6ad595036d02" args="(const FESystemNumerics::VectorBase&lt; T &gt; &amp;vector_in, FESystemNumerics::VectorBase&lt; T &gt; &amp;result)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adee2257f7d4a1e65682a6ad595036d02">leftMultiplyVector</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vector_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs the operation: (*this) &lt;- M2 * (*this) </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#ae251525f25e6544c3135635c250bb832">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00828">828</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00534">FESystemNumerics::PetscVectorBase&lt; T &gt;::getVec()</a>, <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">FESystemNumerics::VectorBase&lt; T &gt;::getVectorPackage()</a>, and <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01199">RadiationCavityAnalysis::getFENodalLoadVector()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01265">RadiationCavityAnalysis::getFENodalLoadVectorSensitivity()</a>.</p>
<div class="fragment"><pre class="fragment">{
  
  Assert(vector_in.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">getVectorPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  Assert(result.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">getVectorPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  
  <span class="keyword">const</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp; vec_in = 
    <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vector_in);
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp; vec_res = 
    <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(result);
  
  <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vec_in).assemble();
  vec_res.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();

  <span class="comment">// create a temporary matrix to store the result in</span>
  PetscErrorCode ierr = 0;
  ierr = MatMultTranspose(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, vec_in.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure">getVec</a>(), vec_res.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure">getVec</a>());
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_adee2257f7d4a1e65682a6ad595036d02_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_adee2257f7d4a1e65682a6ad595036d02_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_adee2257f7d4a1e65682a6ad595036d02_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_adee2257f7d4a1e65682a6ad595036d02_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="425,5,721,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="408,57,739,85"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="433,109,714,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aef539c1770a3365a9b70dd8be0097c91"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::m" ref="aef539c1770a3365a9b70dd8be0097c91" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef539c1770a3365a9b70dd8be0097c91">m</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the row-dimension of the matrix. </dd></dl>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a71a18ffe8bcad4d952c0c7d84c0da8da">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00869">869</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00661">RadiationCavityAnalysis::calculateA_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">RadiationCavityAnalysis::calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00721">RadiationCavityAnalysis::calculateB_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">RadiationCavityAnalysis::calculateB_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01661">RadiationCavityAnalysis::calculateB_TemperatureDependentJacobianContribution()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00579">RadiationCavityAnalysis::calculateG_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">RadiationCavityAnalysis::calculateShapeFactorMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01395">RadiationCavityAnalysis::getFEJacobianMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01592">RadiationCavityAnalysis::getTemperatureDependentFluxCorrectionVector()</a>, and <a class="el" href="_thermal_analysis_8_c_source.html#l00698">Discipline::ThermalAnalysis::performAdditionalOperationsOnGlobalQuantities()</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr;
  PetscInt num1=0, num2=0;
  ierr = MatGetSize (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, &amp;num1, &amp;num2);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
  <span class="keywordflow">return</span> num1;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6cd62edc363882589e4d9520f2c3f566"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::n" ref="a6cd62edc363882589e4d9520f2c3f566" args="() const " -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a6cd62edc363882589e4d9520f2c3f566">n</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the column-dimension of the matrix. </dd></dl>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a722fc7a4c72019f90a4cd40509a766ae">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00883">883</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00661">RadiationCavityAnalysis::calculateA_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">RadiationCavityAnalysis::calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00721">RadiationCavityAnalysis::calculateB_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">RadiationCavityAnalysis::calculateB_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01661">RadiationCavityAnalysis::calculateB_TemperatureDependentJacobianContribution()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00579">RadiationCavityAnalysis::calculateG_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">RadiationCavityAnalysis::calculateShapeFactorMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01395">RadiationCavityAnalysis::getFEJacobianMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01592">RadiationCavityAnalysis::getTemperatureDependentFluxCorrectionVector()</a>, and <a class="el" href="_thermal_analysis_8_c_source.html#l00698">Discipline::ThermalAnalysis::performAdditionalOperationsOnGlobalQuantities()</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr;
  PetscInt num1=0, num2=0;
  ierr = MatGetSize (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, &amp;num1, &amp;num2);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
  <span class="keywordflow">return</span> num2;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a3d1013fd45189ca10cd715ccf048857d"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::resize" ref="a3d1013fd45189ca10cd715ccf048857d" args="(const unsigned int m, const unsigned int n)=0" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a3d1013fd45189ca10cd715ccf048857d">resize</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>resize the matrix in the given dimensions </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a4d1951c58566ad9a53b524f91919f327">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Implemented in <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#a5acdf5297d21c760dfe0dda54f4d66ca">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;</a>.</p>

</div>
</div>
<a class="anchor" id="a5cb1fed88195cc69d3975f0287e8009c"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::rightDiagonalScale" ref="a5cb1fed88195cc69d3975f0287e8009c" args="(const FESystemNumerics::VectorBase&lt; T &gt; &amp;vector)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a5cb1fed88195cc69d3975f0287e8009c">rightDiagonalScale</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vector</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>multiplies the matrix with a diagonal matrix on the right hand side. The diagonal matrix is represented as a vector. </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a28bf7381e6c32d8cad0e009600308352">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00619">619</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00534">FESystemNumerics::PetscVectorBase&lt; T &gt;::getVec()</a>, and <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">FESystemNumerics::VectorBase&lt; T &gt;::getVectorPackage()</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(vector.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">getVectorPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  
  <span class="keyword">const</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp; vec = 
    <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vector);
  <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vec).assemble();
  
  <span class="comment">// create a temporary matrix to store the result in</span>
  PetscErrorCode ierr = 0;
  ierr = MatDiagonalScale (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, PETSC_NULL, vec.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure">getVec</a>());
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_a5cb1fed88195cc69d3975f0287e8009c_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_a5cb1fed88195cc69d3975f0287e8009c_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_a5cb1fed88195cc69d3975f0287e8009c_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_a5cb1fed88195cc69d3975f0287e8009c_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="436,5,732,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="419,57,749,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ade5c4ab14ba12a86e8ccc6d8519287a7"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::rightMultiply" ref="ade5c4ab14ba12a86e8ccc6d8519287a7" args="(const FESystemNumerics::MatrixBase&lt; T &gt; &amp;matrix)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ade5c4ab14ba12a86e8ccc6d8519287a7">rightMultiply</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html">FESystemNumerics::MatrixBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs the operation: (*this) &lt;- (*this) * M3 </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a24c18d011458f882cdb03401bc2a4716">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Reimplemented in <a class="el" href="class_f_e_system_numerics_1_1_petsc_seq_dense_matrix.html#af05e3824a67dca2e453e9d785983f2da">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00742">742</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_petsc_matrix_base_8h_source.html#l01069">FESystemNumerics::PetscMatrixBase&lt; T &gt;::getMat()</a>, and <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91">FESystemNumerics::MatrixBase&lt; T &gt;::getMatrixPackage()</a>.</p>
<div class="fragment"><pre class="fragment">{
  
  Assert(matrix.<a class="code" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91">getMatrixPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());

  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  
  <span class="keyword">const</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp; mat = 
    <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(matrix);
  <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(mat).<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();

  <span class="comment">// create a temporary matrix to store the result in</span>
  Mat result_mat;
  PetscErrorCode ierr = 0;
  ierr = MatMatMult (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, mat.<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure">getMat</a>(), MAT_INITIAL_MATRIX, PETSC_DEFAULT, &amp;result_mat);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="comment">// since Petsc will itself create the result matrix, we can destroy the matrix </span>
  <span class="comment">// of this object, and store the pointer of result_mat</span>
  ierr = MatDestroy(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a> = result_mat;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_ade5c4ab14ba12a86e8ccc6d8519287a7_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_ade5c4ab14ba12a86e8ccc6d8519287a7_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_ade5c4ab14ba12a86e8ccc6d8519287a7_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_ade5c4ab14ba12a86e8ccc6d8519287a7_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a73251b033aaa5845cc318163239eac5d" title="returns the Petsc matrix data structure" alt="" coords="395,5,690,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_matrix_base.html#a24af5737efd851ff093f7feec52caf91" title="FESystemNumerics::MatrixBase::getMatrixPackage" alt="" coords="379,57,706,85"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a89fe3f3f5841376aa58fe144278c707c"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::rightMultiplyVector" ref="a89fe3f3f5841376aa58fe144278c707c" args="(const FESystemNumerics::VectorBase&lt; T &gt; &amp;vector_in, FESystemNumerics::VectorBase&lt; T &gt; &amp;result)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a89fe3f3f5841376aa58fe144278c707c">rightMultiplyVector</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vector_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_f_e_system_numerics_1_1_vector_base.html">FESystemNumerics::VectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Performs the operation: (*this) &lt;- M2 * (*this) </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a5939f406bd8499c1a5de9e3c30d2e207">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00786">786</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_petsc_vector_base_8h_source.html#l00534">FESystemNumerics::PetscVectorBase&lt; T &gt;::getVec()</a>, <a class="el" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">FESystemNumerics::VectorBase&lt; T &gt;::getVectorPackage()</a>, and <a class="el" href="_petsc_vector_base_8h_source.html#l00175">FESystemNumerics::PetscVectorBase&lt; T &gt;::zero()</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01661">RadiationCavityAnalysis::calculateB_TemperatureDependentJacobianContribution()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01199">RadiationCavityAnalysis::getFENodalLoadVector()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01265">RadiationCavityAnalysis::getFENodalLoadVectorSensitivity()</a>.</p>
<div class="fragment"><pre class="fragment">{
  
  Assert(vector_in.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">getVectorPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  Assert(result.<a class="code" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501">getVectorPackage</a>() == FESystem::PETSC_PACKAGE::num(),
         ExcInternalError());
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  
  <span class="keyword">const</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp; vec_in = 
    <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vector_in);
  <a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp; vec_res = 
    <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(result);

  <span class="keyword">const_cast&lt;</span><a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase&lt;T&gt;</a>&amp;<span class="keyword">&gt;</span>(vec_in).assemble();
  vec_res.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49">zero</a>();
  
  <span class="comment">// create a temporary matrix to store the result in</span>
  PetscErrorCode ierr = 0;
  ierr = MatMult(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, vec_in.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure">getVec</a>(), vec_res.<a class="code" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure">getVec</a>());
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_f_e_system_numerics_1_1_petsc_matrix_base_a89fe3f3f5841376aa58fe144278c707c_cgraph.gif" border="0" usemap="#class_f_e_system_numerics_1_1_petsc_matrix_base_a89fe3f3f5841376aa58fe144278c707c_cgraph" alt=""/></div>
<map name="class_f_e_system_numerics_1_1_petsc_matrix_base_a89fe3f3f5841376aa58fe144278c707c_cgraph" id="class_f_e_system_numerics_1_1_petsc_matrix_base_a89fe3f3f5841376aa58fe144278c707c_cgraph">
<area shape="rect" id="node3" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a805d72fe99d9faf92f7adc389fcdd349" title="returns the Petsc matrix data structure" alt="" coords="433,5,729,33"/><area shape="rect" id="node5" href="class_f_e_system_numerics_1_1_vector_base.html#ad048c7dcc907007d67caa5918da54501" title="FESystemNumerics::VectorBase::getVectorPackage" alt="" coords="416,57,747,85"/><area shape="rect" id="node7" href="class_f_e_system_numerics_1_1_petsc_vector_base.html#a0404391bf1618ac71ab199e730c39d49" title="FESystemNumerics::PetscVectorBase::zero" alt="" coords="441,109,722,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1974a31b7aae6c6ff305dc612dc5113b"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::scale" ref="a1974a31b7aae6c6ff305dc612dc5113b" args="(const T factor)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a1974a31b7aae6c6ff305dc612dc5113b">scale</a> </td>
          <td>(</td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>factor</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds  to this matrix Adds  to this matrix multiplies <code>factor</code> to every element in the matrix. </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#aee1efbaf7a01d1d104e932177372bfdf">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l01043">1043</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">RadiationCavityAnalysis::calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00579">RadiationCavityAnalysis::calculateG_Matrix()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">RadiationCavityAnalysis::calculateShapeFactorMatrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }
  

  PetscErrorCode ierr;
  ierr = MatScale (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, factor);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
}
</pre></div>
</div>
</div>
<a class="anchor" id="a029417d563ab83a4825b417682e9ce38"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::set" ref="a029417d563ab83a4825b417682e9ce38" args="(const unsigned int i, const unsigned int j, const T val)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38">set</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>sets the given element to  </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a5cae1707208a8fd4d3596f21e5fdced5">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00425">425</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00661">RadiationCavityAnalysis::calculateA_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00721">RadiationCavityAnalysis::calculateB_InverseMatrix()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">RadiationCavityAnalysis::calculateShapeFactorMatrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a3f24ec97182d2d15ee469c8a7b6a8758" title="method to flush assemble the matrix">flushAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }

  PetscErrorCode ierr;
  ierr = MatSetValue (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, i, j,
                       val, INSERT_VALUES);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a> = <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0f251edb6fa8ba71d4630398292b8797"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::set" ref="a0f251edb6fa8ba71d4630398292b8797" args="(const std::vector&lt; unsigned int &gt; &amp;i, const std::vector&lt; unsigned int &gt; &amp;j, const T *val)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a029417d563ab83a4825b417682e9ce38">set</a> </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T *&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>sets multiple elements with the indeces given in i and j. The val should be a 2-D matrix of dimensions equal to size of vectors i and j. </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#aecda45ef11105e9857a4549e3a997b6a">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00455">455</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a3f24ec97182d2d15ee469c8a7b6a8758" title="method to flush assemble the matrix">flushAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }

  PetscErrorCode ierr;
  ierr = MatSetValues (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, i.size(), (<span class="keyword">const</span> PetscInt*) &amp;(i[0]), 
                       j.size(),  (<span class="keyword">const</span> PetscInt*) &amp;(j[0]),
                      val, INSERT_VALUES);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);

  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a> = <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae18d819dc1f95b6b8f157055b2d9c27c"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::setRow" ref="ae18d819dc1f95b6b8f157055b2d9c27c" args="(const unsigned row_num, const FESystemNumerics::PetscVectorBase&lt; T &gt; &amp;vector)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae18d819dc1f95b6b8f157055b2d9c27c">setRow</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>row_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds  to this matrix </p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00579">RadiationCavityAnalysis::calculateG_Matrix()</a>, and <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01395">RadiationCavityAnalysis::getFEJacobianMatrix()</a>.</p>

</div>
</div>
<a class="anchor" id="a1d9525c2c38f4c1d80943afe2f8bfe38"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::setRow" ref="a1d9525c2c38f4c1d80943afe2f8bfe38" args="(const unsigned row_num, const std::vector&lt; unsigned int &gt; &amp;col_ids, const FESystemNumerics::PetscVectorBase&lt; T &gt; &amp;vector)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#ae18d819dc1f95b6b8f157055b2d9c27c">setRow</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>row_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>col_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_f_e_system_numerics_1_1_petsc_vector_base.html">FESystemNumerics::PetscVectorBase</a>&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Adds  to this matrix </p>

</div>
</div>
<a class="anchor" id="a61d3ca9a3e1f750e2b28f1dd503990d7"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::shift" ref="a61d3ca9a3e1f750e2b28f1dd503990d7" args="(const T val)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a61d3ca9a3e1f750e2b28f1dd503990d7">shift</a> </td>
          <td>(</td>
          <td class="paramtype">const T&#160;</td>
          <td class="paramname"><em>val</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>adds <code>val</code> to all diagonal elements of the matrix </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a442411fb928fca29be41ee2b3735680c">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00399">399</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">RadiationCavityAnalysis::calculateA_Matrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a>)
    {
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::ADD</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::INSERT</a>:
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FLUSH_ASSEMBLE</a>:
      this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase&lt;T&gt;::FINAL_ASSEMBLE</a>:
      <span class="keywordflow">break</span>;
    }

  PetscErrorCode ierr;
  ierr = MatShift (this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>, val);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7f4e4f7b27462324d6c89aa908c3cb6c"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::zero" ref="a7f4e4f7b27462324d6c89aa908c3cb6c" args="()" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a7f4e4f7b27462324d6c89aa908c3cb6c">zero</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set every element in the matrix to 0. You must redefine what you mean by zeroing the matrix since it depends on how your values are stored. </p>

<p>Implements <a class="el" href="class_f_e_system_numerics_1_1_matrix_base.html#a482c90db137987f905331a3dd8d387e3">FESystemNumerics::MatrixBase&lt; T &gt;</a>.</p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00267">267</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>

<p>Referenced by <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00661">RadiationCavityAnalysis::calculateA_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00415">RadiationCavityAnalysis::calculateA_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00838">RadiationCavityAnalysis::calculateABInvFactorMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00721">RadiationCavityAnalysis::calculateB_InverseMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00472">RadiationCavityAnalysis::calculateB_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01005">RadiationCavityAnalysis::calculateFactorMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00579">RadiationCavityAnalysis::calculateG_Matrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l00316">RadiationCavityAnalysis::calculateShapeFactorMatrix()</a>, <a class="el" href="_radiation_cavity_analysis_8_c_source.html#l01395">RadiationCavityAnalysis::getFEJacobianMatrix()</a>, and <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00076">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::PetscSeqDenseMatrix()</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr;
  ierr = MatZeroEntries(this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1" title="Petsc matrix data structure.">petsc_mat</a>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  this-&gt;<a class="code" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#adbf89f7947378034e9f5ff67898981c9" title="method to perform a final assembly of the matrix">finalAssemble</a>();
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a98ac6d573c9a5e455e498a80dec9ea5c"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::matrix_last_action" ref="a98ac6d573c9a5e455e498a80dec9ea5c" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#aef002a32c90536d0a22de2834f8fa722">LastAction</a> <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a98ac6d573c9a5e455e498a80dec9ea5c">matrix_last_action</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>last action performed, to decide whether to flush the matrix operations or not </p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00231">231</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

</div>
</div>
<a class="anchor" id="a96f18d0fa5cc3b25ec1a7f8106b342a1"></a><!-- doxytag: member="FESystemNumerics::PetscMatrixBase::petsc_mat" ref="a96f18d0fa5cc3b25ec1a7f8106b342a1" args="" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Mat <a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html">FESystemNumerics::PetscMatrixBase</a>&lt; T &gt;::<a class="el" href="class_f_e_system_numerics_1_1_petsc_matrix_base.html#a96f18d0fa5cc3b25ec1a7f8106b342a1">petsc_mat</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Petsc matrix data structure. </p>

<p>Definition at line <a class="el" href="_petsc_matrix_base_8h_source.html#l00234">234</a> of file <a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a>.</p>

<p>Referenced by <a class="el" href="_petsc_seq_dense_matrix_8h_source.html#l00076">FESystemNumerics::PetscSeqDenseMatrix&lt; T &gt;::PetscSeqDenseMatrix()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Numerics/<a class="el" href="_petsc_matrix_base_8h_source.html">PetscMatrixBase.h</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 12 2012 18:06:22 for fesystem by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
