<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>fesystem: Solver::PetscLinearSolver Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">fesystem
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_solver.html">Solver</a>      </li>
      <li class="navelem"><a class="el" href="class_solver_1_1_petsc_linear_solver.html">PetscLinearSolver</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">Solver::PetscLinearSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="Solver::PetscLinearSolver" --><!-- doxytag: inherits="Solver::LinearSolver" -->
<p><code>#include &lt;<a class="el" href="_petsc_linear_solver_8h_source.html">PetscLinearSolver.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Solver::PetscLinearSolver:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_petsc_linear_solver__inherit__graph.gif" border="0" usemap="#_solver_1_1_petsc_linear_solver_inherit__map" alt="Inheritance graph"/></div>
<map name="_solver_1_1_petsc_linear_solver_inherit__map" id="_solver_1_1_petsc_linear_solver_inherit__map">
<area shape="rect" id="node2" href="class_solver_1_1_linear_solver.html" title="Solver::LinearSolver" alt="" coords="32,83,173,111"/><area shape="rect" id="node4" href="class_solver_1_1_f_e_system_solver_base.html" title="Solver::FESystemSolverBase" alt="" coords="5,6,200,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Solver::PetscLinearSolver:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_petsc_linear_solver__coll__graph.gif" border="0" usemap="#_solver_1_1_petsc_linear_solver_coll__map" alt="Collaboration graph"/></div>
<map name="_solver_1_1_petsc_linear_solver_coll__map" id="_solver_1_1_petsc_linear_solver_coll__map">
<area shape="rect" id="node2" href="class_solver_1_1_linear_solver.html" title="Solver::LinearSolver" alt="" coords="999,29,1140,57"/><area shape="rect" id="node4" href="class_solver_1_1_f_e_system_solver_base.html" title="Solver::FESystemSolverBase" alt="" coords="561,86,757,114"/><area shape="rect" id="node6" href="class_driver_1_1_analysis_driver.html" title="Driver::AnalysisDriver" alt="" coords="995,202,1144,230"/><area shape="rect" id="node8" href="class_solution_1_1_solution_base.html" title="this class provides the base functionality for all solutions" alt="" coords="581,169,736,197"/><area shape="rect" id="node10" href="class_f_e_system_1_1_f_e_system_controller.html" title="FESystem::FESystemController" alt="" coords="19,197,229,225"/><area shape="rect" id="node13" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; NumericVector\&lt; double \&gt; \&gt;" alt="" coords="469,286,848,314"/><area shape="rect" id="node15" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; T \&gt;" alt="" coords="6,286,242,314"/><area shape="rect" id="node18" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters." alt="" coords="558,338,760,366"/><area shape="rect" id="node20" href="class_solver_1_1_linear_solver_info.html" title="Solver::LinearSolverInfo" alt="" coords="577,6,740,34"/><area shape="rect" id="node22" href="class_solver_1_1_solver_info.html" title="Solver::SolverInfo" alt="" coords="61,6,187,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_solver_1_1_petsc_linear_solver-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a6cae376a5f621826a4e0d22b75bf5584">PetscLinearSolver</a> (const <a class="el" href="class_solver_1_1_linear_solver_info.html">LinearSolverInfo</a> &amp;<a class="el" href="_arpack_eigen_solver_8h.html#ab4bdba131592d57176f37f9670deec34">info</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a96e0b49ff9d0e9e169b197a84804b815">~PetscLinearSolver</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a2566396aac9a289b0e026065d9afa427">clear</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">method to clear the data structures  <a href="#a2566396aac9a289b0e026065d9afa427"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a0c99d607877c1219383d3db7b1d47333">solve</a> (NumericVector&lt; double &gt; &amp;rhs, NumericVector&lt; double &gt; &amp;sol)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">KSP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a2d0fef9547dda26fc7d5c4b211af9c22">getKSP</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">PC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#aaa84689e989668303583d12a8be4be37">getPC</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a3d6fbb730140ce7fb1172b9d86d9938e">createSolverContext</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#ae04717b24dbaf54545ca1ac55efcd683">DeclException1</a> (ExcInvalidKSPType, std::string,&lt;&lt; &quot;Invalid KSP type : &quot;&lt;&lt; arg1&lt;&lt; &quot; specified&quot;)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">KSP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48">ksp</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">the krylov solver context  <a href="#ac1a704d6f6d536d082eb20321d9c6c48"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">KSPType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd">ksptype</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">the type of KSP solver being used  <a href="#a28367414fa1e3d9db6cd892b08570efd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">PC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5">pc</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">the PC context that will handle all the factoring of the matrices  <a href="#a1e80860bfe428bc739b98d5ddda9fcf5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">PCType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5">pctype</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">type of the PC to be used  <a href="#a4be4bcaaf80ca0e1168ab8ce6c8fedb5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">PetscDrawLG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a7528bc78abf74d5957e79c204789af4e">petsc_draw</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="_petsc_linear_solver_8h_source.html#l00048">48</a> of file <a class="el" href="_petsc_linear_solver_8h_source.html">PetscLinearSolver.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a6cae376a5f621826a4e0d22b75bf5584"></a><!-- doxytag: member="Solver::PetscLinearSolver::PetscLinearSolver" ref="a6cae376a5f621826a4e0d22b75bf5584" args="(const LinearSolverInfo &amp;info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a6cae376a5f621826a4e0d22b75bf5584">Solver::PetscLinearSolver::PetscLinearSolver</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_solver_1_1_linear_solver_info.html">LinearSolverInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00022">22</a> of file <a class="el" href="_petsc_linear_solver_8cpp_source.html">PetscLinearSolver.cpp</a>.</p>

<p>References <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00182">createSolverContext()</a>, <a class="el" href="_linear_solver_8h_source.html#l00245">KSP_BCGS_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00311">KSP_BICG_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00206">KSP_CG_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00259">KSP_CGS_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00193">KSP_CHEBYCHEV_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00285">KSP_CR_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00219">KSP_GMRES_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00298">KSP_LSQR_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00323">KSP_PRE_ONLY_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00180">KSP_RICHARDSON_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00232">KSP_TCQMR_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00272">KSP_TFQMR_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00505">Solver::LinearSolver::ksp_type_enum_ID</a>, <a class="el" href="_petsc_linear_solver_8h_source.html#l00084">ksptype</a>, <a class="el" href="_linear_solver_8h_source.html#l00127">PC_ASM_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00062">PC_BJACOBI_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00154">PC_CHOLESKY_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00088">PC_EISENSTAT_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00101">PC_ICC_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00114">PC_ILU_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00049">PC_JACOBI_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00140">PC_KSP_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00036">PC_LU_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00167">PC_NONE_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00075">PC_SOR_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00506">Solver::LinearSolver::pc_type_enum_ID</a>, and <a class="el" href="_petsc_linear_solver_8h_source.html#l00090">pctype</a>.</p>
<div class="fragment"><pre class="fragment">                                                                      :
<a class="code" href="class_solver_1_1_linear_solver.html#a2d85dc220a441f8c1cfb1f5fd3ddce4d" title="constructor">Solver::LinearSolver</a>(<a class="code" href="_arpack_eigen_solver_8h.html#ab4bdba131592d57176f37f9670deec34">info</a>, PETSC_LINEAR_SOLVER::num()),
<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>(PETSC_NULL),
<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a>(PETSC_NULL),
<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a>(PETSC_NULL),
<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a>(PETSC_NULL),
<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a7528bc78abf74d5957e79c204789af4e">petsc_draw</a>(PETSC_NULL)
{
    <span class="comment">// set the pc type</span>
  <span class="keywordflow">switch</span>(this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a7d9a180c53de74ff85168049f6c65164">pc_type_enum_ID</a>)
  {
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#aa88ca48a2c52492e1d6b80dc2a744144">PC_LU_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCLU;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a0df4ca941039c828d772c059a538e787">PC_JACOBI_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCJACOBI;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a4dae99f9c7564604949830704d3d9b82">PC_BJACOBI_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCBJACOBI;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a6f011e490e047fb7a8c7e00b27594263">PC_SOR_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCSOR;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a0cbcb61499b3e9883ab9d36f1dadcb81">PC_EISENSTAT_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCEISENSTAT;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a9c2fe90476a89c1d7bac438d7e106cff">PC_ICC_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCICC;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#ad4f8d3adc20cf66c53fba04ddfb70a67">PC_ILU_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCILU;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a6ce9fafae6be5af91278f31378960882">PC_ASM_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCASM;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#ac3e07c0992497b4a927a5307348775bf">PC_KSP_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCKSP;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#ad8bf4fa46b14106560d2119b0047ed93">PC_CHOLESKY_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCCHOLESKY;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a6eb0b7983ef1b31a862dd6670ba86990">PC_NONE_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a> = PCNONE;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      Assert(<span class="keyword">false</span>,
             FESystemExceptions::ExcEnumCaseNotImplemented
             (Solver::PCTypeEnum::enumName(this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a7d9a180c53de74ff85168049f6c65164">pc_type_enum_ID</a>)));
  }
  
<span class="comment">// set the ksp type</span>
  <span class="keywordflow">switch</span>(this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#ad60c084790633e2ce81314285f252e6e">ksp_type_enum_ID</a>)
  {
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a33fce3afb6c5f64c9daaae7432c570f8">KSP_RICHARDSON_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPRICHARDSON;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#aa94cbec050f51fe062c295d9cc4a855f">KSP_CHEBYCHEV_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPCHEBYCHEV;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a5c29a3122968e8589f59894b8e4d3b86">KSP_CG_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPCG;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a508b2ef9c0ae9af647f87b7cefcdcb43">KSP_GMRES_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPGMRES;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#af9dc12efcd4fa65910a6c94af34a6fec">KSP_TCQMR_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPTCQMR;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#aadde39001088e6bee3c72d71a3422f09">KSP_BCGS_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPBCGS;
      <span class="keywordflow">break</span>;
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#ac97e167f0e8f7051ee5a077ffca63a94">KSP_CGS_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPCGS;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a244fd48c4d1d535d8d88c2b420475d08">KSP_TFQMR_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPTFQMR;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#ab8233e1d8271e0323e0e06422a240bc3">KSP_CR_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPCR;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#af6d287481cb3f7054ba2a4f576d5b47a">KSP_LSQR_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPLSQR;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#aae636c9e1e4076c0702fe915425919a1">KSP_BICG_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPBICG;
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a98b4d1477482c5de027622c21c9270fc">KSP_PRE_ONLY_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a> = KSPPREONLY;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      Assert(<span class="keyword">false</span>,
             FESystemExceptions::ExcEnumCaseNotImplemented
             (Solver::KSPTypeEnum::enumName(this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#ad60c084790633e2ce81314285f252e6e">ksp_type_enum_ID</a>)));
  }
  
  this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a3d6fbb730140ce7fb1172b9d86d9938e">createSolverContext</a>();
  
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_petsc_linear_solver_a6cae376a5f621826a4e0d22b75bf5584_cgraph.gif" border="0" usemap="#class_solver_1_1_petsc_linear_solver_a6cae376a5f621826a4e0d22b75bf5584_cgraph" alt=""/></div>
<map name="class_solver_1_1_petsc_linear_solver_a6cae376a5f621826a4e0d22b75bf5584_cgraph" id="class_solver_1_1_petsc_linear_solver_a6cae376a5f621826a4e0d22b75bf5584_cgraph">
<area shape="rect" id="node3" href="class_solver_1_1_petsc_linear_solver.html#a3d6fbb730140ce7fb1172b9d86d9938e" title="Solver::PetscLinearSolver::createSolverContext" alt="" coords="345,5,647,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a96e0b49ff9d0e9e169b197a84804b815"></a><!-- doxytag: member="Solver::PetscLinearSolver::~PetscLinearSolver" ref="a96e0b49ff9d0e9e169b197a84804b815" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#a96e0b49ff9d0e9e169b197a84804b815">Solver::PetscLinearSolver::~PetscLinearSolver</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00147">147</a> of file <a class="el" href="_petsc_linear_solver_8cpp_source.html">PetscLinearSolver.cpp</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, and <a class="el" href="_f_e_system_common_8h_source.html#l00022">FESystem::local_processor</a>.</p>
<div class="fragment"><pre class="fragment">{
    PetscErrorCode ierr=0;
  
  <span class="comment">// the petsc draw context is to be deleted only on the 0 processor</span>
  <span class="keywordflow">if</span> (<a class="code" href="namespace_f_e_system.html#a53399996849d09877c3231214d49478a" title="local processor ID">FESystem::local_processor</a> == 0)
    {
      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a7528bc78abf74d5957e79c204789af4e">petsc_draw</a> != PETSC_NULL)
        {
          ierr = KSPMonitorLGDestroy(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a7528bc78abf74d5957e79c204789af4e">petsc_draw</a>);
          CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
          this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a7528bc78abf74d5957e79c204789af4e">petsc_draw</a> = PETSC_NULL;
        }
    }

  <span class="comment">// delete the PC and KSP contexts if they have been created</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a> != PETSC_NULL)
  {
    ierr = PCDestroy(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a>);
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a> = PETSC_NULL;
  }
  
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a> != PETSC_NULL)
  {
    ierr = KSPDestroy(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>);
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a> = PETSC_NULL;
  }
  
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a2566396aac9a289b0e026065d9afa427"></a><!-- doxytag: member="Solver::PetscLinearSolver::clear" ref="a2566396aac9a289b0e026065d9afa427" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_petsc_linear_solver.html#a2566396aac9a289b0e026065d9afa427">Solver::PetscLinearSolver::clear</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>method to clear the data structures </p>

<p>Reimplemented from <a class="el" href="class_solver_1_1_linear_solver.html#adf5fbac605f462db9ce974a2b20aee4f">Solver::LinearSolver</a>.</p>

<p>Definition at line <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00257">257</a> of file <a class="el" href="_petsc_linear_solver_8cpp_source.html">PetscLinearSolver.cpp</a>.</p>

<p>References <a class="el" href="_linear_solver_8_c_source.html#l00044">Solver::LinearSolver::clear()</a>.</p>
<div class="fragment"><pre class="fragment">{
  
  <a class="code" href="class_solver_1_1_petsc_linear_solver.html#a2566396aac9a289b0e026065d9afa427" title="method to clear the data structures">Solver::LinearSolver::clear</a>();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_petsc_linear_solver_a2566396aac9a289b0e026065d9afa427_cgraph.gif" border="0" usemap="#class_solver_1_1_petsc_linear_solver_a2566396aac9a289b0e026065d9afa427_cgraph" alt=""/></div>
<map name="class_solver_1_1_petsc_linear_solver_a2566396aac9a289b0e026065d9afa427_cgraph" id="class_solver_1_1_petsc_linear_solver_a2566396aac9a289b0e026065d9afa427_cgraph">
<area shape="rect" id="node3" href="class_solver_1_1_linear_solver.html#adf5fbac605f462db9ce974a2b20aee4f" title="method to clear the data structures after use" alt="" coords="264,5,442,33"/><area shape="rect" id="node5" href="class_solver_1_1_f_e_system_solver_base.html#a8a0975de208bb425f4c1b21d12a9f7b0" title="Solver::FESystemSolverBase::clear" alt="" coords="490,5,723,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3d6fbb730140ce7fb1172b9d86d9938e"></a><!-- doxytag: member="Solver::PetscLinearSolver::createSolverContext" ref="a3d6fbb730140ce7fb1172b9d86d9938e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_petsc_linear_solver.html#a3d6fbb730140ce7fb1172b9d86d9938e">Solver::PetscLinearSolver::createSolverContext</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00182">182</a> of file <a class="el" href="_petsc_linear_solver_8cpp_source.html">PetscLinearSolver.cpp</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, and <a class="el" href="_f_e_system_common_8h_source.html#l00022">FESystem::local_processor</a>.</p>

<p>Referenced by <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00022">PetscLinearSolver()</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr = 0;

  <span class="comment">// the petsc draw context is to be deleted only on the 0 processor</span>
  <span class="keywordflow">if</span> (<a class="code" href="namespace_f_e_system.html#a53399996849d09877c3231214d49478a" title="local processor ID">FESystem::local_processor</a> == 0)
    {
      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a7528bc78abf74d5957e79c204789af4e">petsc_draw</a> != PETSC_NULL)
        {
          ierr = KSPMonitorLGDestroy(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a7528bc78abf74d5957e79c204789af4e">petsc_draw</a>);
          CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
          this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a7528bc78abf74d5957e79c204789af4e">petsc_draw</a> = PETSC_NULL;
        }
    }

  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a> != PETSC_NULL)
    {
      ierr = PCDestroy(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a>);
      CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a> = PETSC_NULL;
    }

  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a> != PETSC_NULL)
    {
      ierr = KSPDestroy(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>); 
      CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr); 
      this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a> = PETSC_NULL;
    }

  {
    ierr = KSPCreate(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, &amp;(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>));
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    
    ierr = KSPSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>, this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd" title="the type of KSP solver being used">ksptype</a>);
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    
    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a7d9a180c53de74ff85168049f6c65164">pc_type_enum_ID</a> != Solver::PC_NONE::num())
      {
        ierr = PCCreate(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, &amp;(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a>));
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
        
        ierr = PCSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a>, this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5" title="type of the PC to be used">pctype</a>);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
        
        ierr = KSPSetPC(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>, this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a>);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
      }
  }
  
<span class="comment">//  ierr = KSPMonitorLGTrueResidualNormCreate</span>
<span class="comment">//  (FESystem::COMM_WORLD, PETSC_NULL, &quot;residual norm&quot;, 0, 0, 500, 500, &amp;(this-&gt;petsc_draw));</span>
<span class="comment">//  CHKERRABORT(FESystem::COMM_WORLD, ierr);  </span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae04717b24dbaf54545ca1ac55efcd683"></a><!-- doxytag: member="Solver::PetscLinearSolver::DeclException1" ref="ae04717b24dbaf54545ca1ac55efcd683" args="(ExcInvalidKSPType, std::string,&lt;&lt; &quot;Invalid KSP type : &quot;&lt;&lt; arg1&lt;&lt; &quot; specified&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_solver_1_1_petsc_linear_solver.html#ae04717b24dbaf54545ca1ac55efcd683">Solver::PetscLinearSolver::DeclException1</a> </td>
          <td>(</td>
          <td class="paramtype">ExcInvalidKSPType&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&lt;&lt; &quot;Invalid KSP type : &quot;&lt;&lt; arg1&lt;&lt; &quot; specified&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2d0fef9547dda26fc7d5c4b211af9c22"></a><!-- doxytag: member="Solver::PetscLinearSolver::getKSP" ref="a2d0fef9547dda26fc7d5c4b211af9c22" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KSP <a class="el" href="class_solver_1_1_petsc_linear_solver.html#a2d0fef9547dda26fc7d5c4b211af9c22">Solver::PetscLinearSolver::getKSP</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the Petsc KSP object </dd></dl>

<p>Definition at line <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00239">239</a> of file <a class="el" href="_petsc_linear_solver_8cpp_source.html">PetscLinearSolver.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aaa84689e989668303583d12a8be4be37"></a><!-- doxytag: member="Solver::PetscLinearSolver::getPC" ref="aaa84689e989668303583d12a8be4be37" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PC <a class="el" href="class_solver_1_1_petsc_linear_solver.html#aaa84689e989668303583d12a8be4be37">Solver::PetscLinearSolver::getPC</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the Petsc PC object </dd></dl>

<p>Definition at line <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00248">248</a> of file <a class="el" href="_petsc_linear_solver_8cpp_source.html">PetscLinearSolver.cpp</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5" title="the PC context that will handle all the factoring of the matrices">pc</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0c99d607877c1219383d3db7b1d47333"></a><!-- doxytag: member="Solver::PetscLinearSolver::solve" ref="a0c99d607877c1219383d3db7b1d47333" args="(NumericVector&lt; double &gt; &amp;rhs, NumericVector&lt; double &gt; &amp;sol)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_petsc_linear_solver.html#a0c99d607877c1219383d3db7b1d47333">Solver::PetscLinearSolver::solve</a> </td>
          <td>(</td>
          <td class="paramtype">NumericVector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NumericVector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>sol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this is a function that implements the solution steps. Before this function is called, the matrices should already have been set. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">rhs</td><td>right hand side of the system of equations </td></tr>
    <tr><td class="paramname">sol</td><td>vector in which solution will be stored </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_solver_1_1_linear_solver.html#aa2932e9f9425532adfb25e1331d63a01">Solver::LinearSolver</a>.</p>

<p>Definition at line <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00269">269</a> of file <a class="el" href="_petsc_linear_solver_8cpp_source.html">PetscLinearSolver.cpp</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  
  this-&gt;<a class="code" href="class_solver_1_1_f_e_system_solver_base.html#ad52a2063f53a41980f6da440ba289c64" title="analysis driver pointer">analysis_driver</a>-&gt;<a class="code" href="class_driver_1_1_analysis_driver.html#afc031cf4f9058917779cec23a3f8b995">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;DirectLinearSolver::solve()&quot;</span>, <span class="stringliteral">&quot;Solver&quot;</span>);
  
  PetscErrorCode ierr = 0;
  
  <span class="comment">// next, solve</span>
  PetscVector&lt;double&gt;&amp; rhs_ref = <span class="keyword">dynamic_cast&lt;</span>PetscVector&lt;double&gt;&amp; <span class="keyword">&gt;</span>(rhs);
  PetscVector&lt;double&gt;&amp; sol_ref = <span class="keyword">dynamic_cast&lt;</span>PetscVector&lt;double&gt;&amp; <span class="keyword">&gt;</span>(sol);
  
  MatStructure petsc_pc_option;

  <span class="comment">// if the same matrix option between solves is false, then new matrices must </span>
  <span class="comment">// be specified, otherwise, there should be no change between the solves</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a28c30a04e4f8b3c28764a9606d01ba27">same_matrices_between_solves</a>)
  {
    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#aa7c975e83915d32a397d6c5c5aae463b" title="bool to check if the PC matrix is new">new_PC_matrix</a> || this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a5f93f375356befae40ceb20248254d32" title="bool to check if the system matrix is new">new_system_matrix</a>)
    {
      <span class="comment">// if same matrix is to be used, and new ones have been specified, then</span>
      <span class="comment">// the number of time these have been used should be zero</span>
      Assert (this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#acdeca238cae8fc5d3b574940d2a5174b">n_solves_after_new_matrices</a> == 0, ExcInternalError());
    }
    <span class="keywordflow">else</span> 
    {
      <span class="comment">// if new matrices have not been given, then these must have been used</span>
      Assert (this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#acdeca238cae8fc5d3b574940d2a5174b">n_solves_after_new_matrices</a> &gt; 0, ExcInternalError());
    }
    petsc_pc_option = SAME_PRECONDITIONER;
  }
  <span class="keywordflow">else</span>
  {
    <span class="comment">// if new matrices have to be given at each iteration, then </span>
    <span class="comment">// the number of solves after new matrices should be 0</span>
    Assert (this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#acdeca238cae8fc5d3b574940d2a5174b">n_solves_after_new_matrices</a> == 0, ExcInternalError());
    petsc_pc_option = DIFFERENT_NONZERO_PATTERN;
  }
  
  <span class="comment">// attach the matrices to the solver before solving if new ones have been specified</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a5f93f375356befae40ceb20248254d32" title="bool to check if the system matrix is new">new_system_matrix</a> || this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#aa7c975e83915d32a397d6c5c5aae463b" title="bool to check if the PC matrix is new">new_PC_matrix</a>)
  {
    this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#a3d6fbb730140ce7fb1172b9d86d9938e">createSolverContext</a>();
    Assert(this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a0106c15fc8470b97c74f2baa97859a3e" title="the preconditioner matrix">system_matrix</a> != NULL, ExcInternalError());
    this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a0106c15fc8470b97c74f2baa97859a3e" title="the preconditioner matrix">system_matrix</a>-&gt;close();
    Mat sys_mat = (<span class="keyword">dynamic_cast&lt;</span>PetscMatrix&lt;double&gt;* <span class="keyword">&gt;</span>(this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a0106c15fc8470b97c74f2baa97859a3e" title="the preconditioner matrix">system_matrix</a>))-&gt;mat();
    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a7d9a180c53de74ff85168049f6c65164">pc_type_enum_ID</a> != Solver::PC_NONE::num())
    {
      Assert(this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a939f8c6eda31867aacf68b30ddbf3ad3" title="the preconditioner matrix">preconditioner_matrix</a> != NULL, ExcInternalError());
      this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a939f8c6eda31867aacf68b30ddbf3ad3" title="the preconditioner matrix">preconditioner_matrix</a>-&gt;close();
      Mat pc_mat = (<span class="keyword">dynamic_cast&lt;</span>PetscMatrix&lt;double&gt;* <span class="keyword">&gt;</span>(this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a939f8c6eda31867aacf68b30ddbf3ad3" title="the preconditioner matrix">preconditioner_matrix</a>))-&gt;mat();
      ierr = KSPSetOperators(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>, sys_mat, pc_mat, petsc_pc_option);
    }
    <span class="keywordflow">else</span>
      ierr = KSPSetOperators(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>, sys_mat, sys_mat, petsc_pc_option);

    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    ierr = KSPSetUp(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>);
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  }

  rhs_ref.close();
  sol_ref.close();
    
  ierr = KSPSolve(this-&gt;<a class="code" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48" title="the krylov solver context">ksp</a>, rhs_ref.vec(), sol_ref.vec());
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#acdeca238cae8fc5d3b574940d2a5174b">n_solves_after_new_matrices</a> += 1;
  <span class="comment">// the matrices now are no longer new</span>
  this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#a5f93f375356befae40ceb20248254d32" title="bool to check if the system matrix is new">new_system_matrix</a> = <span class="keyword">false</span>;
  this-&gt;<a class="code" href="class_solver_1_1_linear_solver.html#aa7c975e83915d32a397d6c5c5aae463b" title="bool to check if the PC matrix is new">new_PC_matrix</a> = <span class="keyword">false</span>;
  
  this-&gt;<a class="code" href="class_solver_1_1_f_e_system_solver_base.html#ad52a2063f53a41980f6da440ba289c64" title="analysis driver pointer">analysis_driver</a>-&gt;<a class="code" href="class_driver_1_1_analysis_driver.html#afc031cf4f9058917779cec23a3f8b995">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
  (<span class="stringliteral">&quot;DirectLinearSolver::solve()&quot;</span>, <span class="stringliteral">&quot;Solver&quot;</span>);
  
}
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ac1a704d6f6d536d082eb20321d9c6c48"></a><!-- doxytag: member="Solver::PetscLinearSolver::ksp" ref="ac1a704d6f6d536d082eb20321d9c6c48" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KSP <a class="el" href="class_solver_1_1_petsc_linear_solver.html#ac1a704d6f6d536d082eb20321d9c6c48">Solver::PetscLinearSolver::ksp</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the krylov solver context </p>

<p>Definition at line <a class="el" href="_petsc_linear_solver_8h_source.html#l00081">81</a> of file <a class="el" href="_petsc_linear_solver_8h_source.html">PetscLinearSolver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a28367414fa1e3d9db6cd892b08570efd"></a><!-- doxytag: member="Solver::PetscLinearSolver::ksptype" ref="a28367414fa1e3d9db6cd892b08570efd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KSPType <a class="el" href="class_solver_1_1_petsc_linear_solver.html#a28367414fa1e3d9db6cd892b08570efd">Solver::PetscLinearSolver::ksptype</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the type of KSP solver being used </p>

<p>Definition at line <a class="el" href="_petsc_linear_solver_8h_source.html#l00084">84</a> of file <a class="el" href="_petsc_linear_solver_8h_source.html">PetscLinearSolver.h</a>.</p>

<p>Referenced by <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00022">PetscLinearSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a1e80860bfe428bc739b98d5ddda9fcf5"></a><!-- doxytag: member="Solver::PetscLinearSolver::pc" ref="a1e80860bfe428bc739b98d5ddda9fcf5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PC <a class="el" href="class_solver_1_1_petsc_linear_solver.html#a1e80860bfe428bc739b98d5ddda9fcf5">Solver::PetscLinearSolver::pc</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the PC context that will handle all the factoring of the matrices </p>

<p>Definition at line <a class="el" href="_petsc_linear_solver_8h_source.html#l00087">87</a> of file <a class="el" href="_petsc_linear_solver_8h_source.html">PetscLinearSolver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a4be4bcaaf80ca0e1168ab8ce6c8fedb5"></a><!-- doxytag: member="Solver::PetscLinearSolver::pctype" ref="a4be4bcaaf80ca0e1168ab8ce6c8fedb5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PCType <a class="el" href="class_solver_1_1_petsc_linear_solver.html#a4be4bcaaf80ca0e1168ab8ce6c8fedb5">Solver::PetscLinearSolver::pctype</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>type of the PC to be used </p>

<p>Definition at line <a class="el" href="_petsc_linear_solver_8h_source.html#l00090">90</a> of file <a class="el" href="_petsc_linear_solver_8h_source.html">PetscLinearSolver.h</a>.</p>

<p>Referenced by <a class="el" href="_petsc_linear_solver_8cpp_source.html#l00022">PetscLinearSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="a7528bc78abf74d5957e79c204789af4e"></a><!-- doxytag: member="Solver::PetscLinearSolver::petsc_draw" ref="a7528bc78abf74d5957e79c204789af4e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscDrawLG <a class="el" href="class_solver_1_1_petsc_linear_solver.html#a7528bc78abf74d5957e79c204789af4e">Solver::PetscLinearSolver::petsc_draw</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_petsc_linear_solver_8h_source.html#l00092">92</a> of file <a class="el" href="_petsc_linear_solver_8h_source.html">PetscLinearSolver.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Solvers/<a class="el" href="_petsc_linear_solver_8h_source.html">PetscLinearSolver.h</a></li>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Solvers/<a class="el" href="_petsc_linear_solver_8cpp_source.html">PetscLinearSolver.cpp</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 12 2012 18:06:23 for fesystem by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
