<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>fesystem: Solver::PetscNonlinearTransientSolver Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">fesystem
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_solver.html">Solver</a>      </li>
      <li class="navelem"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html">PetscNonlinearTransientSolver</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">Solver::PetscNonlinearTransientSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="Solver::PetscNonlinearTransientSolver" --><!-- doxytag: inherits="Solver::NonlinearTransientSolverBase" -->
<p><code>#include &lt;<a class="el" href="_petsc_transient_solver_8h_source.html">PetscTransientSolver.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Solver::PetscNonlinearTransientSolver:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_petsc_nonlinear_transient_solver__inherit__graph.gif" border="0" usemap="#_solver_1_1_petsc_nonlinear_transient_solver_inherit__map" alt="Inheritance graph"/></div>
<map name="_solver_1_1_petsc_nonlinear_transient_solver_inherit__map" id="_solver_1_1_petsc_nonlinear_transient_solver_inherit__map">
<area shape="rect" id="node2" href="class_solver_1_1_nonlinear_transient_solver_base.html" title="Solver::NonlinearTransientSolverBase" alt="" coords="6,161,252,189"/><area shape="rect" id="node4" href="class_solver_1_1_transient_solver_base.html" title="Solver::TransientSolverBase" alt="" coords="34,83,224,111"/><area shape="rect" id="node6" href="class_solver_1_1_f_e_system_solver_base.html" title="Solver::FESystemSolverBase" alt="" coords="31,6,227,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Solver::PetscNonlinearTransientSolver:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_petsc_nonlinear_transient_solver__coll__graph.gif" border="0" usemap="#_solver_1_1_petsc_nonlinear_transient_solver_coll__map" alt="Collaboration graph"/></div>
<map name="_solver_1_1_petsc_nonlinear_transient_solver_coll__map" id="_solver_1_1_petsc_nonlinear_transient_solver_coll__map">
<area shape="rect" id="node2" href="class_solver_1_1_nonlinear_transient_solver_base.html" title="Solver::NonlinearTransientSolverBase" alt="" coords="1321,407,1567,435"/><area shape="rect" id="node4" href="class_solver_1_1_transient_solver_base.html" title="Solver::TransientSolverBase" alt="" coords="1080,353,1270,381"/><area shape="rect" id="node6" href="class_solver_1_1_f_e_system_solver_base.html" title="Solver::FESystemSolverBase" alt="" coords="561,279,757,307"/><area shape="rect" id="node8" href="class_driver_1_1_analysis_driver.html" title="Driver::AnalysisDriver" alt="" coords="1100,163,1249,191"/><area shape="rect" id="node10" href="class_solution_1_1_solution_base.html" title="this class provides the base functionality for all solutions" alt="" coords="581,87,736,115"/><area shape="rect" id="node12" href="class_f_e_system_1_1_f_e_system_controller.html" title="FESystem::FESystemController" alt="" coords="19,50,229,78"/><area shape="rect" id="node15" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; NumericVector\&lt; double \&gt; \&gt;" alt="" coords="469,139,848,167"/><area shape="rect" id="node17" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; T \&gt;" alt="" coords="6,139,242,167"/><area shape="rect" id="node20" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters." alt="" coords="558,191,760,219"/><area shape="rect" id="node22" href="class_solver_1_1_transient_solver_info_base.html" title="Solver::TransientSolverInfoBase" alt="" coords="553,359,765,387"/><area shape="rect" id="node24" href="class_solver_1_1_solver_info.html" title="Solver::SolverInfo" alt="" coords="61,411,187,439"/><area shape="rect" id="node26" href="class_solver_1_1_linear_solver_info.html" title="Solver::LinearSolverInfo" alt="" coords="882,409,1046,437"/><area shape="rect" id="node29" href="class_solver_1_1_nonlinear_solver_info.html" title="this class stores the information for initialization of a nonlinear solver." alt="" coords="872,465,1056,493"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_solver_1_1_petsc_nonlinear_transient_solver-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a3f88f165fe96e7dd911e47747223e21a">PetscNonlinearTransientSolver</a> (const <a class="el" href="class_solver_1_1_nonlinear_transient_solver_info.html">Solver::NonlinearTransientSolverInfo</a> &amp;transient_info, const <a class="el" href="class_solver_1_1_nonlinear_solver_info.html">Solver::NonlinearSolverInfo</a> &amp;nonlinear_info, const <a class="el" href="class_solver_1_1_linear_solver_info.html">Solver::LinearSolverInfo</a> &amp;linear_info)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor  <a href="#a3f88f165fe96e7dd911e47747223e21a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a7f06f8f979098da7400eece2d025c94a">~PetscNonlinearTransientSolver</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a81d892946af6d70a04822a8c0e033857">clear</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a43437a4313e37fdc386dc2dadf3dcfde">solve</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">method to solve the eigen system  <a href="#a43437a4313e37fdc386dc2dadf3dcfde"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a82a90f90ab5f631540e04883711a8ae9">getSimulatedTime</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a5ed79bf8f1c4a57da127ce83da23daf1">getCurrentTime</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a25b663e29e609fb793ebabe0fdfdfaa9">getCurrentStepSize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a5cbf1e6b2ca6dc6e6f955bc80fa3053f">getSimulatedIterationNumber</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a10b005f6e714f41d45eaf8ea70af819c">getCurrentIterationNumber</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#aaf555e6c48234a6ea8f48f9a843b78b6">setInitialCondition</a> (std::vector&lt; NumericVector&lt; double &gt; * &gt; &amp;state_vecs)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">set initial conditions for the analysis  <a href="#aaf555e6c48234a6ea8f48f9a843b78b6"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c">petsc_ts</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">petsc transient solver context  <a href="#a40615928d2c9d962bcce7bf3f19f842c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">SNES&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788">petsc_snes</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">PETSc nonlinear solver context.  <a href="#a8a03e28f9bccaa9f2cb2869568c81788"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">KSP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a10efd3596f8fbde055c506a2ed4a66b9">petsc_ksp</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">PETSc KSP solver for the nonlinear solver.  <a href="#a10efd3596f8fbde055c506a2ed4a66b9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">PC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#ac00c7b2b0b29179b2188a218800e2567">petsc_pc</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">a PC context for the linear solver  <a href="#ac00c7b2b0b29179b2188a218800e2567"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>this class provides an interface to a solver for the solution of eigensystem. This inherits from the <a class="el" href="class_solver_1_1_f_e_system_solver_base.html">FESystemSolverBase</a> class. It takes a pointer to the analysis driver object that owns an instantiation of this class </p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8h_source.html#l00098">98</a> of file <a class="el" href="_petsc_transient_solver_8h_source.html">PetscTransientSolver.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3f88f165fe96e7dd911e47747223e21a"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::PetscNonlinearTransientSolver" ref="a3f88f165fe96e7dd911e47747223e21a" args="(const Solver::NonlinearTransientSolverInfo &amp;transient_info, const Solver::NonlinearSolverInfo &amp;nonlinear_info, const Solver::LinearSolverInfo &amp;linear_info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a3f88f165fe96e7dd911e47747223e21a">Solver::PetscNonlinearTransientSolver::PetscNonlinearTransientSolver</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_solver_1_1_nonlinear_transient_solver_info.html">Solver::NonlinearTransientSolverInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>transient_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_solver_1_1_nonlinear_solver_info.html">Solver::NonlinearSolverInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>nonlinear_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_solver_1_1_linear_solver_info.html">Solver::LinearSolverInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>linear_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>constructor </p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8_c_source.html#l00036">36</a> of file <a class="el" href="_petsc_transient_solver_8_c_source.html">PetscTransientSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_linear_solver_8h_source.html#l00323">KSP_PRE_ONLY_ENUM_ID</a>, <a class="el" href="_petsc_nonlinear_solver_8h_source.html#l00017">NEWTON_NONLINEAR_SOLVER_CUBIC_LINE_SEARCH_ENUM_ID</a>, <a class="el" href="_petsc_nonlinear_solver_8h_source.html#l00045">NEWTON_NONLINEAR_SOLVER_NO_LINE_SEARCH_ENUM_ID</a>, <a class="el" href="_petsc_nonlinear_solver_8h_source.html#l00057">NEWTON_NONLINEAR_SOLVER_NO_NORMS_LINE_SEARCH_ENUM_ID</a>, <a class="el" href="_petsc_nonlinear_solver_8h_source.html#l00031">NEWTON_NONLINEAR_SOLVER_QUADRATIC_LINE_SEARCH_ENUM_ID</a>, <a class="el" href="_linear_solver_8h_source.html#l00036">PC_LU_ENUM_ID</a>, <a class="el" href="_petsc_transient_solver_8h_source.html#l00016">PETSC_BEULER_TRANSIENT_SOLVER_ENUM_ID</a>, <a class="el" href="_petsc_transient_solver_8h_source.html#l00057">PETSC_CRANK_NICHOLSON_TRANSIENT_SOLVER_ENUM_ID</a>, <a class="el" href="_petsc_transient_solver_8h_source.html#l00030">PETSC_FEULER_TRANSIENT_SOLVER_ENUM_ID</a>, and <a class="el" href="_petsc_transient_solver_8h_source.html#l00043">PETSC_RUNGE_KUTTA_TRANSIENT_SOLVER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">                                           :
<a class="code" href="class_solver_1_1_nonlinear_transient_solver_base.html#a962029c25c0f66bd832f0bc8ac44b80b" title="constructor">Solver::NonlinearTransientSolverBase</a>(transient_info,
                                     nonlinear_info, 
                                     linear_info)
{
  <span class="comment">// create the SNES context and set the KSP and PC options</span>
  PetscErrorCode ierr = 0;
  ierr = TSCreate(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, &amp;(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>));
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="comment">// set the options for the SNES</span>
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_solver_1_1_transient_solver_base.html#a611e556bed59cb54163e73099d18edfa" title="TransientSolverInfo that stores information about this solver.">transient_solver_info</a>.<a class="code" href="class_solver_1_1_transient_solver_info_base.html#adad9ea5579ae53386ad110834c11eecd">getTransientSolverKindEnumID</a>())
    {
    <span class="keywordflow">case</span> <a class="code" href="_petsc_transient_solver_8h.html#a0733d511fb951dd0feee2c34ab90b6e9">PETSC_FEULER_TRANSIENT_SOLVER_ENUM_ID</a>:
      {
        ierr = TSSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, TS_EULER);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_petsc_transient_solver_8h.html#a1b84509814d5de000e075d84ce771338">PETSC_BEULER_TRANSIENT_SOLVER_ENUM_ID</a>:
      {
        ierr = TSSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, TS_BEULER);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
      }
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="_petsc_transient_solver_8h.html#a307516b6769aef9936e94636b2c20135">PETSC_CRANK_NICHOLSON_TRANSIENT_SOLVER_ENUM_ID</a>:
      {
        ierr = TSSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, TS_CRANK_NICHOLSON);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_petsc_transient_solver_8h.html#a787845c6106d7b69915e602c5a7ce37c">PETSC_RUNGE_KUTTA_TRANSIENT_SOLVER_ENUM_ID</a>:
      {
        ierr = TSSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, TS_RUNGE_KUTTA);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      Assert(<span class="keyword">false</span>, ExcInternalError());
    }
  
  ierr = TSSetProblemType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, TS_NONLINEAR);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
  
  ierr = TSSetDuration(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>,
                       this-&gt;<a class="code" href="class_solver_1_1_transient_solver_base.html#a611e556bed59cb54163e73099d18edfa" title="TransientSolverInfo that stores information about this solver.">transient_solver_info</a>.<a class="code" href="class_solver_1_1_transient_solver_info_base.html#a7b2d04bd0a121aaedd7a14d7be8c8430">getMaxTimeIterations</a>(),
                       this-&gt;<a class="code" href="class_solver_1_1_transient_solver_base.html#a611e556bed59cb54163e73099d18edfa" title="TransientSolverInfo that stores information about this solver.">transient_solver_info</a>.<a class="code" href="class_solver_1_1_transient_solver_info_base.html#adecce12d8580ec6098c7f117c34ee87e">getDuration</a>());
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
  
  ierr = TSSetInitialTimeStep(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>,
                              this-&gt;<a class="code" href="class_solver_1_1_transient_solver_base.html#a611e556bed59cb54163e73099d18edfa" title="TransientSolverInfo that stores information about this solver.">transient_solver_info</a>.<a class="code" href="class_solver_1_1_transient_solver_info_base.html#a0fb333504e6bd004ccc4514cf02a82c9">getInitialTime</a>(),
                              this-&gt;<a class="code" href="class_solver_1_1_transient_solver_base.html#a611e556bed59cb54163e73099d18edfa" title="TransientSolverInfo that stores information about this solver.">transient_solver_info</a>.<a class="code" href="class_solver_1_1_transient_solver_info_base.html#a9d28dc23cc62df0e44acf04ddae0d315">getInitialTimeStep</a>());
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
  
  <span class="comment">// now, set the tolerance for adaptive time stepping. However, adaptive time stepping</span>
  <span class="comment">// is allowed only for RK methods, and that should be assured for this</span>
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_transient_solver_base.html#a611e556bed59cb54163e73099d18edfa" title="TransientSolverInfo that stores information about this solver.">transient_solver_info</a>.<a class="code" href="class_solver_1_1_transient_solver_info_base.html#a7ffd5c644c9538fa26e96d1979df230f">ifAdaptiveTimeSteps</a>())
    {
    AssertThrow (this-&gt;<a class="code" href="class_solver_1_1_transient_solver_base.html#a611e556bed59cb54163e73099d18edfa" title="TransientSolverInfo that stores information about this solver.">transient_solver_info</a>.<a class="code" href="class_solver_1_1_transient_solver_info_base.html#adad9ea5579ae53386ad110834c11eecd">getTransientSolverKindEnumID</a>() == 
                 Solver::PETSC_RUNGE_KUTTA_TRANSIENT_SOLVER::num(),
                 ExcInternalError());
    
    ierr = TSRKSetTolerance(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>,
                            this-&gt;<a class="code" href="class_solver_1_1_transient_solver_base.html#a611e556bed59cb54163e73099d18edfa" title="TransientSolverInfo that stores information about this solver.">transient_solver_info</a>.<a class="code" href="class_solver_1_1_transient_solver_info_base.html#adac2f53c1a15a91fe5df28bb42b141c8">getGlobalTolerance</a>());
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
    }


  <span class="comment">// set the nonlinear solver options</span>
  ierr = TSGetSNES(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, &amp;(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>));
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);

  <span class="comment">// set the options for the SNES</span>
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_solver_1_1_nonlinear_transient_solver_base.html#a98ece375114436615acb03b2468a294a" title="LinearSolverInfo that stores information about this solver.">nonlinear_solver_info</a>.<a class="code" href="class_solver_1_1_nonlinear_solver_info.html#a9d456de6c8076bef1f09d4f1f2c23e9b">getNonlinearSolverKindEnumID</a>())
    {
    <span class="keywordflow">case</span> <a class="code" href="_petsc_nonlinear_solver_8h.html#aa0662560ede79452338be1947f09318f">NEWTON_NONLINEAR_SOLVER_CUBIC_LINE_SEARCH_ENUM_ID</a>:
      {
        <span class="comment">// set the solver type to line search, and also set the line</span>
        <span class="comment">// search type</span>
        ierr = SNESSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, SNESLS);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
        
        ierr = SNESLineSearchSet(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, SNESLineSearchCubic, PETSC_NULL);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_petsc_nonlinear_solver_8h.html#ae44fb47b4687f6f0378f52b1b8a4f774">NEWTON_NONLINEAR_SOLVER_QUADRATIC_LINE_SEARCH_ENUM_ID</a>:
      {
        <span class="comment">// set the solver type to line search, and also set the line</span>
        <span class="comment">// search type</span>
        ierr = SNESSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, SNESLS);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
        
        ierr = SNESLineSearchSet(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, SNESLineSearchQuadratic, PETSC_NULL);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_petsc_nonlinear_solver_8h.html#a09b2caae80b3495aa54a35a68cf65c5e">NEWTON_NONLINEAR_SOLVER_NO_LINE_SEARCH_ENUM_ID</a>:
      {
        <span class="comment">// set the solver type to line search, and also set the line</span>
        <span class="comment">// search type</span>
        ierr = SNESSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, SNESLS);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
        
        ierr = SNESLineSearchSet(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, SNESLineSearchNo, PETSC_NULL);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_petsc_nonlinear_solver_8h.html#a8831bcfbb08100ad603982524cf4a271">NEWTON_NONLINEAR_SOLVER_NO_NORMS_LINE_SEARCH_ENUM_ID</a>:
      {
        <span class="comment">// set the solver type to line search, and also set the line</span>
        <span class="comment">// search type</span>
        ierr = SNESSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, SNESLS);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
        
        ierr = SNESLineSearchSet(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, SNESLineSearchNoNorms, PETSC_NULL);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      Assert(<span class="keyword">false</span>, ExcInternalError());
    }
  
    <span class="keyword">const</span> <span class="keywordtype">double</span> nonlinear_tol = this-&gt;<a class="code" href="class_solver_1_1_nonlinear_transient_solver_base.html#a98ece375114436615acb03b2468a294a" title="LinearSolverInfo that stores information about this solver.">nonlinear_solver_info</a>.<a class="code" href="class_solver_1_1_nonlinear_solver_info.html#aedbb95520b8de73a6ccfd7b218605f36">getConvergenceTolerance</a>();
    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nonlinear_maxits = this-&gt;<a class="code" href="class_solver_1_1_nonlinear_transient_solver_base.html#a98ece375114436615acb03b2468a294a" title="LinearSolverInfo that stores information about this solver.">nonlinear_solver_info</a>.<a class="code" href="class_solver_1_1_nonlinear_solver_info.html#a564250db21ea91e90dc0996233337caf">getMaximumIterations</a>();
    
    ierr = SNESSetTolerances(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, nonlinear_tol, nonlinear_tol, nonlinear_tol, 
                             nonlinear_maxits, 1000);
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    
    <span class="comment">// set the default monitor for the solver</span>
    ierr = SNESSetMonitor(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>,
                          SNESDefaultMonitor, 
                          PETSC_NULL, PETSC_NULL);
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
        
    <span class="comment">// get the KSP context from the SNES and set its options</span>
    ierr = SNESGetKSP(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788" title="PETSc nonlinear solver context.">petsc_snes</a>, &amp;(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a10efd3596f8fbde055c506a2ed4a66b9" title="PETSc KSP solver for the nonlinear solver.">petsc_ksp</a>));
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,ierr);
<span class="comment">//    }</span>
<span class="comment">//  else if (this-&gt;transient_solver_info.getTransientProblemKindEnumID() == </span>
<span class="comment">//           Solver::NONLINEAR_TRANSIENT_PROBLEM::num())</span>
<span class="comment">//    {</span>
<span class="comment">//    ierr = TSSetProblemType(this-&gt;petsc_ts, TS_LINEAR);</span>
<span class="comment">//    CHKERRABORT(FESystem::COMM_WORLD,ierr);</span>
<span class="comment">//    </span>
<span class="comment">//    ierr = TSGetKSP(this-&gt;petsc_ts, &amp;(this-&gt;petsc_ksp));</span>
<span class="comment">//    CHKERRABORT(FESystem::COMM_WORLD,ierr);</span>
<span class="comment">//    }</span>
    
  <span class="comment">// set the KSP type</span>
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_solver_1_1_nonlinear_transient_solver_base.html#aa73caa0314411002f55f5eb03e3f6ada" title="LinearSolverInfo that stores information about this solver.">linear_solver_info</a>.<a class="code" href="class_solver_1_1_linear_solver_info.html#a73fe9bd5d6dd0e9b74cc3bfb63dcbf0c">getKSPTypeEnumID</a>())
    {
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#a98b4d1477482c5de027622c21c9270fc">KSP_PRE_ONLY_ENUM_ID</a>:
      {
        ierr = KSPSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a10efd3596f8fbde055c506a2ed4a66b9" title="PETSc KSP solver for the nonlinear solver.">petsc_ksp</a> , KSPPREONLY);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      Assert(<span class="keyword">false</span>, ExcInternalError());
    }
  
  
  <span class="comment">// set the PC to LU</span>
  ierr = KSPGetPC(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a10efd3596f8fbde055c506a2ed4a66b9" title="PETSc KSP solver for the nonlinear solver.">petsc_ksp</a>, &amp;(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#ac00c7b2b0b29179b2188a218800e2567" title="a PC context for the linear solver">petsc_pc</a>));
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="class_solver_1_1_nonlinear_transient_solver_base.html#aa73caa0314411002f55f5eb03e3f6ada" title="LinearSolverInfo that stores information about this solver.">linear_solver_info</a>.<a class="code" href="class_solver_1_1_linear_solver_info.html#a86adddbd6628766bf573514c09700baa">getPCTypeEnumID</a>())
    {
    <span class="keywordflow">case</span> <a class="code" href="_linear_solver_8h.html#aa88ca48a2c52492e1d6b80dc2a744144">PC_LU_ENUM_ID</a>:
      {
        ierr = PCSetType(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#ac00c7b2b0b29179b2188a218800e2567" title="a PC context for the linear solver">petsc_pc</a> , PCLU);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      Assert(<span class="keyword">false</span>, ExcInternalError());
    }
  
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7f06f8f979098da7400eece2d025c94a"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::~PetscNonlinearTransientSolver" ref="a7f06f8f979098da7400eece2d025c94a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a7f06f8f979098da7400eece2d025c94a">Solver::PetscNonlinearTransientSolver::~PetscNonlinearTransientSolver</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_petsc_transient_solver_8_c_source.html#l00232">232</a> of file <a class="el" href="_petsc_transient_solver_8_c_source.html">PetscTransientSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, and <a class="el" href="_petsc_transient_solver_8h_source.html#l00138">petsc_ts</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// destroy the TS context</span>
  PetscErrorCode ierr = TSDestroy(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a81d892946af6d70a04822a8c0e033857"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::clear" ref="a81d892946af6d70a04822a8c0e033857" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a81d892946af6d70a04822a8c0e033857">Solver::PetscNonlinearTransientSolver::clear</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this method clears the data structures of this object. This should be called each time the used finishes using this object. </p>

<p>Reimplemented from <a class="el" href="class_solver_1_1_nonlinear_transient_solver_base.html#a18f3f5898d0ea130bd40e49b0daaf6fd">Solver::NonlinearTransientSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8_c_source.html#l00243">243</a> of file <a class="el" href="_petsc_transient_solver_8_c_source.html">PetscTransientSolver.C</a>.</p>

<p>References <a class="el" href="_transient_solver_8_c_source.html#l00107">Solver::NonlinearTransientSolverBase::clear()</a>.</p>
<div class="fragment"><pre class="fragment">{
  <a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a81d892946af6d70a04822a8c0e033857">Solver::NonlinearTransientSolverBase::clear</a>();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_petsc_nonlinear_transient_solver_a81d892946af6d70a04822a8c0e033857_cgraph.gif" border="0" usemap="#class_solver_1_1_petsc_nonlinear_transient_solver_a81d892946af6d70a04822a8c0e033857_cgraph" alt=""/></div>
<map name="class_solver_1_1_petsc_nonlinear_transient_solver_a81d892946af6d70a04822a8c0e033857_cgraph" id="class_solver_1_1_petsc_nonlinear_transient_solver_a81d892946af6d70a04822a8c0e033857_cgraph">
<area shape="rect" id="node3" href="class_solver_1_1_nonlinear_transient_solver_base.html#a18f3f5898d0ea130bd40e49b0daaf6fd" title="Solver::NonlinearTransientSolverBase::clear" alt="" coords="341,5,624,33"/><area shape="rect" id="node5" href="class_solver_1_1_transient_solver_base.html#afbcb490c46ae9203351898f500ac20f0" title="Solver::TransientSolverBase::clear" alt="" coords="672,5,898,33"/><area shape="rect" id="node7" href="class_solver_1_1_f_e_system_solver_base.html#a8a0975de208bb425f4c1b21d12a9f7b0" title="Solver::FESystemSolverBase::clear" alt="" coords="946,5,1179,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a10b005f6e714f41d45eaf8ea70af819c"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::getCurrentIterationNumber" ref="a10b005f6e714f41d45eaf8ea70af819c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a10b005f6e714f41d45eaf8ea70af819c">Solver::PetscNonlinearTransientSolver::getCurrentIterationNumber</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the current time iteration of the solver integration </dd></dl>

<p>Implements <a class="el" href="class_solver_1_1_transient_solver_base.html#ae9e0efebc3ac324a55f9371d08093c48">Solver::TransientSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8_c_source.html#l00331">331</a> of file <a class="el" href="_petsc_transient_solver_8_c_source.html">PetscTransientSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscInt time;
  PetscErrorCode ierr;
  ierr = TSGetTimeStepNumber(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, &amp;time);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="keywordflow">return</span> time;  
}
</pre></div>
</div>
</div>
<a class="anchor" id="a25b663e29e609fb793ebabe0fdfdfaa9"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::getCurrentStepSize" ref="a25b663e29e609fb793ebabe0fdfdfaa9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a25b663e29e609fb793ebabe0fdfdfaa9">Solver::PetscNonlinearTransientSolver::getCurrentStepSize</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the current time step of the solver integration </dd></dl>

<p>Implements <a class="el" href="class_solver_1_1_transient_solver_base.html#a0738310f7236d529b523c26eeb1a169b">Solver::TransientSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8_c_source.html#l00316">316</a> of file <a class="el" href="_petsc_transient_solver_8_c_source.html">PetscTransientSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> time;
  PetscErrorCode ierr;
  ierr = TSGetTimeStep(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, &amp;time);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="keywordflow">return</span> time;  
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5ed79bf8f1c4a57da127ce83da23daf1"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::getCurrentTime" ref="a5ed79bf8f1c4a57da127ce83da23daf1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a5ed79bf8f1c4a57da127ce83da23daf1">Solver::PetscNonlinearTransientSolver::getCurrentTime</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the current time of the solver integration </dd></dl>

<p>Implements <a class="el" href="class_solver_1_1_transient_solver_base.html#a943fb6fd05b853b6328a9044a587a3e8">Solver::TransientSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8_c_source.html#l00301">301</a> of file <a class="el" href="_petsc_transient_solver_8_c_source.html">PetscTransientSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="keywordtype">double</span> time;
  PetscErrorCode ierr;
  ierr = TSGetTime(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, &amp;time);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="keywordflow">return</span> time;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5cbf1e6b2ca6dc6e6f955bc80fa3053f"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::getSimulatedIterationNumber" ref="a5cbf1e6b2ca6dc6e6f955bc80fa3053f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual unsigned int <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a5cbf1e6b2ca6dc6e6f955bc80fa3053f">Solver::PetscNonlinearTransientSolver::getSimulatedIterationNumber</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the current time iteration of the solver integration </dd></dl>

<p>Implements <a class="el" href="class_solver_1_1_transient_solver_base.html#a907309fd525dc7b1bdaffeb9e2233f96">Solver::TransientSolverBase</a>.</p>

</div>
</div>
<a class="anchor" id="a82a90f90ab5f631540e04883711a8ae9"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::getSimulatedTime" ref="a82a90f90ab5f631540e04883711a8ae9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual double <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a82a90f90ab5f631540e04883711a8ae9">Solver::PetscNonlinearTransientSolver::getSimulatedTime</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the current time of the solver integration </dd></dl>

<p>Implements <a class="el" href="class_solver_1_1_transient_solver_base.html#a84c8621459557767c61562af5ae0c2b0">Solver::TransientSolverBase</a>.</p>

</div>
</div>
<a class="anchor" id="aaf555e6c48234a6ea8f48f9a843b78b6"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::setInitialCondition" ref="aaf555e6c48234a6ea8f48f9a843b78b6" args="(std::vector&lt; NumericVector&lt; double &gt; * &gt; &amp;state_vecs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#aaf555e6c48234a6ea8f48f9a843b78b6">Solver::PetscNonlinearTransientSolver::setInitialCondition</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; NumericVector&lt; double &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>state_vecs</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>set initial conditions for the analysis </p>

<p>Implements <a class="el" href="class_solver_1_1_transient_solver_base.html#ac8058c8b3553b9c3ff2a3b245b08f697">Solver::TransientSolverBase</a>.</p>

</div>
</div>
<a class="anchor" id="a43437a4313e37fdc386dc2dadf3dcfde"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::solve" ref="a43437a4313e37fdc386dc2dadf3dcfde" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a43437a4313e37fdc386dc2dadf3dcfde">Solver::PetscNonlinearTransientSolver::solve</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>method to solve the eigen system </p>

<p>Implements <a class="el" href="class_solver_1_1_transient_solver_base.html#ad56d883aa1b90cf2405c27e05da6e0a6">Solver::TransientSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8_c_source.html#l00253">253</a> of file <a class="el" href="_petsc_transient_solver_8_c_source.html">PetscTransientSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_petsc_transient_solver_8_c_source.html#l00345">FESystemNonlinearTransientSolverRHSFunctionEvaluation()</a>, <a class="el" href="_petsc_transient_solver_8_c_source.html#l00367">FESystemNonlinearTransientSolverRHSJacobianEvaluation()</a>, and <a class="el" href="_petsc_transient_solver_8_c_source.html#l00391">FESystemTransientSolverMonitor()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_solver_1_1_f_e_system_solver_base.html#ad52a2063f53a41980f6da440ba289c64" title="analysis driver pointer">analysis_driver</a>-&gt;<a class="code" href="class_driver_1_1_analysis_driver.html#afc031cf4f9058917779cec23a3f8b995">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;PetscNonlinearSolver::solve()&quot;</span>, <span class="stringliteral">&quot;Solver&quot;</span>);

  Assert(this-&gt;jacobian != NULL, ExcInternalError());
  
  this-&gt;jacobian-&gt;close();
  solution.close();
  
  Mat petsc_jac = <span class="keyword">dynamic_cast&lt;</span>PetscMatrix&lt;double&gt;*<span class="keyword">&gt;</span>(this-&gt;jacobian)-&gt;mat();
  Vec petsc_sol = <span class="keyword">dynamic_cast&lt;</span>PetscVector&lt;double&gt;&amp;<span class="keyword">&gt;</span>(solution).vec();

  PetscErrorCode ierr;
  ierr = TSSetRHSFunction(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, <a class="code" href="_petsc_transient_solver_8_c.html#ac3e9cdc937a42c28c491f6599086f07d">FESystemNonlinearTransientSolverRHSFunctionEvaluation</a>,
                          <span class="keyword">this</span>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);

  ierr = TSSetRHSJacobian(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, petsc_jac, petsc_jac,
                          <a class="code" href="_petsc_transient_solver_8_c.html#afbbb252d96594b0179d3023b0359e9d0">FESystemNonlinearTransientSolverRHSJacobianEvaluation</a>,
                          <span class="keyword">this</span>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  ierr = TSSetSolution(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, petsc_sol);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);

  
  ierr = TSSetMonitor(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, 
                      <a class="code" href="_petsc_transient_solver_8_c.html#a6caf2838fcd55527af7e0e8d28782cf3">FESystemTransientSolverMonitor</a>,
                      <span class="keyword">this</span>, PETSC_NULL);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="comment">// now step</span>
  PetscInt steps=0;
  <span class="keywordtype">double</span> time=0.0;
  ierr = TSStep(this-&gt;<a class="code" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c" title="petsc transient solver context">petsc_ts</a>, &amp;steps, &amp;time);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  
  this-&gt;<a class="code" href="class_solver_1_1_f_e_system_solver_base.html#ad52a2063f53a41980f6da440ba289c64" title="analysis driver pointer">analysis_driver</a>-&gt;<a class="code" href="class_driver_1_1_analysis_driver.html#afc031cf4f9058917779cec23a3f8b995">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
    (<span class="stringliteral">&quot;PetscNonlinearSolver::solve()&quot;</span>, <span class="stringliteral">&quot;Solver&quot;</span>); 
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_petsc_nonlinear_transient_solver_a43437a4313e37fdc386dc2dadf3dcfde_cgraph.gif" border="0" usemap="#class_solver_1_1_petsc_nonlinear_transient_solver_a43437a4313e37fdc386dc2dadf3dcfde_cgraph" alt=""/></div>
<map name="class_solver_1_1_petsc_nonlinear_transient_solver_a43437a4313e37fdc386dc2dadf3dcfde_cgraph" id="class_solver_1_1_petsc_nonlinear_transient_solver_a43437a4313e37fdc386dc2dadf3dcfde_cgraph">
<area shape="rect" id="node3" href="_petsc_transient_solver_8_c.html#ac3e9cdc937a42c28c491f6599086f07d" title="FESystemNonlinearTransientSolverRHSFunctionEvaluation" alt="" coords="342,5,717,33"/><area shape="rect" id="node7" href="_petsc_transient_solver_8_c.html#afbbb252d96594b0179d3023b0359e9d0" title="FESystemNonlinearTransientSolverRHSJacobianEvaluation" alt="" coords="341,57,718,85"/><area shape="rect" id="node11" href="_petsc_transient_solver_8_c.html#a6caf2838fcd55527af7e0e8d28782cf3" title="FESystemTransientSolverMonitor" alt="" coords="419,109,639,137"/><area shape="rect" id="node5" href="class_solver_1_1_nonlinear_transient_solver_base.html#aaac30d39fc2fee2e8289400263060224" title="Solver::NonlinearTransientSolverBase::evaluateRHSFunction" alt="" coords="767,5,1151,33"/><area shape="rect" id="node9" href="class_solver_1_1_nonlinear_transient_solver_base.html#a9ccfb4b2a8d1c8b330ff877734350c4a" title="Solver::NonlinearTransientSolverBase::evaluateRHSJacobian" alt="" coords="766,57,1152,85"/><area shape="rect" id="node13" href="class_solver_1_1_f_e_system_solver_base.html#a2771c244ff238f4710f40de9935659f7" title="Solver::FESystemSolverBase::getAnalysisDriver" alt="" coords="805,109,1112,137"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a10efd3596f8fbde055c506a2ed4a66b9"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::petsc_ksp" ref="a10efd3596f8fbde055c506a2ed4a66b9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KSP <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a10efd3596f8fbde055c506a2ed4a66b9">Solver::PetscNonlinearTransientSolver::petsc_ksp</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>PETSc KSP solver for the nonlinear solver. </p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8h_source.html#l00144">144</a> of file <a class="el" href="_petsc_transient_solver_8h_source.html">PetscTransientSolver.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac00c7b2b0b29179b2188a218800e2567"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::petsc_pc" ref="ac00c7b2b0b29179b2188a218800e2567" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PC <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#ac00c7b2b0b29179b2188a218800e2567">Solver::PetscNonlinearTransientSolver::petsc_pc</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>a PC context for the linear solver </p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8h_source.html#l00147">147</a> of file <a class="el" href="_petsc_transient_solver_8h_source.html">PetscTransientSolver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8a03e28f9bccaa9f2cb2869568c81788"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::petsc_snes" ref="a8a03e28f9bccaa9f2cb2869568c81788" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SNES <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a8a03e28f9bccaa9f2cb2869568c81788">Solver::PetscNonlinearTransientSolver::petsc_snes</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>PETSc nonlinear solver context. </p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8h_source.html#l00141">141</a> of file <a class="el" href="_petsc_transient_solver_8h_source.html">PetscTransientSolver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a40615928d2c9d962bcce7bf3f19f842c"></a><!-- doxytag: member="Solver::PetscNonlinearTransientSolver::petsc_ts" ref="a40615928d2c9d962bcce7bf3f19f842c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TS <a class="el" href="class_solver_1_1_petsc_nonlinear_transient_solver.html#a40615928d2c9d962bcce7bf3f19f842c">Solver::PetscNonlinearTransientSolver::petsc_ts</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>petsc transient solver context </p>

<p>Definition at line <a class="el" href="_petsc_transient_solver_8h_source.html#l00138">138</a> of file <a class="el" href="_petsc_transient_solver_8h_source.html">PetscTransientSolver.h</a>.</p>

<p>Referenced by <a class="el" href="_petsc_transient_solver_8_c_source.html#l00232">~PetscNonlinearTransientSolver()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Solvers/<a class="el" href="_petsc_transient_solver_8h_source.html">PetscTransientSolver.h</a></li>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Solvers/<a class="el" href="_petsc_transient_solver_8_c_source.html">PetscTransientSolver.C</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 12 2012 18:06:23 for fesystem by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
