<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>fesystem: Solver::SlepcEigenSolver Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">fesystem
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="namespace_solver.html">Solver</a>      </li>
      <li class="navelem"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html">SlepcEigenSolver</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<div class="title">Solver::SlepcEigenSolver Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="Solver::SlepcEigenSolver" --><!-- doxytag: inherits="Solver::EigenSolverBase" -->
<p><code>#include &lt;<a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Solver::SlepcEigenSolver:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_slepc_eigen_solver__inherit__graph.gif" border="0" usemap="#_solver_1_1_slepc_eigen_solver_inherit__map" alt="Inheritance graph"/></div>
<map name="_solver_1_1_slepc_eigen_solver_inherit__map" id="_solver_1_1_slepc_eigen_solver_inherit__map">
<area shape="rect" id="node2" href="class_solver_1_1_eigen_solver_base.html" title="Solver::EigenSolverBase" alt="" coords="18,83,187,111"/><area shape="rect" id="node4" href="class_solver_1_1_f_e_system_solver_base.html" title="Solver::FESystemSolverBase" alt="" coords="5,6,200,34"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for Solver::SlepcEigenSolver:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_slepc_eigen_solver__coll__graph.gif" border="0" usemap="#_solver_1_1_slepc_eigen_solver_coll__map" alt="Collaboration graph"/></div>
<map name="_solver_1_1_slepc_eigen_solver_coll__map" id="_solver_1_1_slepc_eigen_solver_coll__map">
<area shape="rect" id="node2" href="class_solver_1_1_eigen_solver_base.html" title="Solver::EigenSolverBase" alt="" coords="1006,57,1175,85"/><area shape="rect" id="node4" href="class_solver_1_1_f_e_system_solver_base.html" title="Solver::FESystemSolverBase" alt="" coords="561,137,757,165"/><area shape="rect" id="node6" href="class_driver_1_1_analysis_driver.html" title="Driver::AnalysisDriver" alt="" coords="1016,253,1165,281"/><area shape="rect" id="node8" href="class_solution_1_1_solution_base.html" title="this class provides the base functionality for all solutions" alt="" coords="581,219,736,247"/><area shape="rect" id="node10" href="class_f_e_system_1_1_f_e_system_controller.html" title="FESystem::FESystemController" alt="" coords="19,249,229,277"/><area shape="rect" id="node13" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; NumericVector\&lt; double \&gt; \&gt;" alt="" coords="469,337,848,365"/><area shape="rect" id="node15" href="class_f_e_system_utility_1_1_auto_ptr_vector.html" title="FESystemUtility::AutoPtrVector\&lt; T \&gt;" alt="" coords="6,337,242,365"/><area shape="rect" id="node18" href="class_design_data_1_1_design_parameter.html" title="this class forms the base class for all design parameters." alt="" coords="558,389,760,417"/><area shape="rect" id="node20" href="class_solver_1_1_linear_solver_info.html" title="Solver::LinearSolverInfo" alt="" coords="577,6,740,34"/><area shape="rect" id="node22" href="class_solver_1_1_solver_info.html" title="Solver::SolverInfo" alt="" coords="61,33,187,61"/><area shape="rect" id="node24" href="class_solver_1_1_eigen_solver_info.html" title="Solver::EigenSolverInfo" alt="" coords="578,58,739,86"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_solver_1_1_slepc_eigen_solver-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a1ec6ca25ea63e218f3204d56a83827aa">SlepcEigenSolver</a> (const <a class="el" href="class_solver_1_1_eigen_solver_info.html">Solver::EigenSolverInfo</a> &amp;eigen_info, const <a class="el" href="class_solver_1_1_linear_solver_info.html">Solver::LinearSolverInfo</a> &amp;linear_info)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor  <a href="#a1ec6ca25ea63e218f3204d56a83827aa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a91bc313c216ab311fe8d8ae891bcad7c">~SlepcEigenSolver</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ab5abb46caef01bfd8c89753415bf52f2">clear</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a5845ca3c45b3f3323feaf17aacb1fe75">getNConvergedEigenPairs</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a70b6fdbe984df6c22417ae484c65caf1">getEigenValue</a> (unsigned int eigen_index, double *real_value, double *img_value)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ae25271a5c01f45949f6fe36692b2625b">getEigenPair</a> (unsigned int pair_index, double *real_value, double *img_value, NumericVector&lt; double &gt; &amp;real_vec, NumericVector&lt; double &gt; &amp;img_vec)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a7889ef300cce7ba0a40920f68b1f5e81">getInvariantSubspace</a> (std::vector&lt; NumericVector&lt; double &gt; * &gt; &amp;vectors)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a86a8b975f24058cf032ee32e5613afcf">getEigenPairResidualError</a> (const unsigned int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a638925a42bf0b42f4d466c5db4819d2f">getEigenPairRelativeError</a> (const unsigned int index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#aafd2f0f44a64ccffb1e469043a2fe2a7">solve</a> (SparseMatrix&lt; double &gt; *A_mat, SparseMatrix&lt; double &gt; *B_mat=NULL)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">method to solve the eigen system  <a href="#aafd2f0f44a64ccffb1e469043a2fe2a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#abc07eb2e85d98560b29e281f9723dbcd">getResidualForEigenPair</a> (const unsigned int i)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">this method calculates a residual for the given eigen value and returns it  <a href="#abc07eb2e85d98560b29e281f9723dbcd"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a76514cac29097b5caa931a9d828953ff">setSolverOptions</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">sets the solver options  <a href="#a76514cac29097b5caa931a9d828953ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a509415779e349528dd4a302a53d870ef">setSolverType</a> (const unsigned int enum_ID)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">sets the problem type  <a href="#a509415779e349528dd4a302a53d870ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a64e916c319b719b6e788838d1c505f43">setProblemKind</a> (const unsigned int enum_ID)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">this sets the problem kind  <a href="#a64e916c319b719b6e788838d1c505f43"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ac6236f402f8a82180ea10640e09f8fe1">setNEigenSetsToCompute</a> (const unsigned int n_eigs)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">sets the number of eigen sets to compute  <a href="#ac6236f402f8a82180ea10640e09f8fe1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#aa6d16795669629b83c837d8c0a0516db">setEigenSpectrumEnd</a> (const unsigned int eigen_spectrum_end)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">sets the eigen spectrum end to solve for  <a href="#aa6d16795669629b83c837d8c0a0516db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a79bebe8f3bfbe86ad2d1a0df3fe1bdbf">setEigenShift</a> (const unsigned int eigen_shift_kind, const double shift_value)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">sets the shift for the solver  <a href="#a79bebe8f3bfbe86ad2d1a0df3fe1bdbf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a50e890bd799a1739e6b1e1f2f2a8ec44">setLinearSolverDetails</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">sets the linear solver details  <a href="#a50e890bd799a1739e6b1e1f2f2a8ec44"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a8f8856ed0d2f4d75dcb995035c9a2f17">solution_completed</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">if the solution has been performed  <a href="#a8f8856ed0d2f4d75dcb995035c9a2f17"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b">n_converged_eigen_pairs</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">number of converged eigenpairs  <a href="#a0766936bb4c769fb389046578c41923b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EPS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3">eps</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">an eigenvalue problem solver context  <a href="#a22216116688906a1d27a5471e04c57e3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EPSWhich&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760">eps_spectrum_end</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">which eigenspectrum end to solve for  <a href="#ae2a38abb22f9a513532154a8ad246760"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8">eigen_val_permutation</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">vector of sorted eigenvalue indexes, for permutation  <a href="#a610f9043fb85097f8c134973ff1741d8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::auto_ptr<br class="typebreak"/>
&lt; <a class="el" href="class_solver_1_1_petsc_linear_solver.html">Solver::PetscLinearSolver</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ae7b7ab632a0c55ec800aebc8d9ed782d">petsc_linear_solver</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>this class provides an interface to a solver for the solution of eigensystem. This inherits from the <a class="el" href="class_solver_1_1_f_e_system_solver_base.html">FESystemSolverBase</a> class. It takes a pointer to the analysis driver object that owns an instantiation of this class </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8h_source.html#l00135">135</a> of file <a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1ec6ca25ea63e218f3204d56a83827aa"></a><!-- doxytag: member="Solver::SlepcEigenSolver::SlepcEigenSolver" ref="a1ec6ca25ea63e218f3204d56a83827aa" args="(const Solver::EigenSolverInfo &amp;eigen_info, const Solver::LinearSolverInfo &amp;linear_info)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a1ec6ca25ea63e218f3204d56a83827aa">Solver::SlepcEigenSolver::SlepcEigenSolver</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_solver_1_1_eigen_solver_info.html">Solver::EigenSolverInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>eigen_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_solver_1_1_linear_solver_info.html">Solver::LinearSolverInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>linear_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>constructor </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00019">19</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, and <a class="el" href="_slepc_eigen_solver_8h_source.html#l00236">eps</a>.</p>
<div class="fragment"><pre class="fragment">                                                                           :
<a class="code" href="class_solver_1_1_eigen_solver_base.html#a1788505af4f91ba52f108c4d71d1dc84" title="constructor">Solver::EigenSolverBase</a>(eigen_info, linear_info),
<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a8f8856ed0d2f4d75dcb995035c9a2f17" title="if the solution has been performed">solution_completed</a>(<span class="keyword">false</span>),
<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>(<a class="code" href="namespace_f_e_system_numbers.html#a6247b3ec1c348e954beffbd2fabd2bef" title="an ID that will always be considered to be invalid in the code.">FESystemNumbers::InvalidID</a>)
{
  PetscErrorCode ierr = 0;

  <span class="comment">// create the solver</span>
  ierr = EPSCreate(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, &amp;(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>));
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a91bc313c216ab311fe8d8ae891bcad7c"></a><!-- doxytag: member="Solver::SlepcEigenSolver::~SlepcEigenSolver" ref="a91bc313c216ab311fe8d8ae891bcad7c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a91bc313c216ab311fe8d8ae891bcad7c">Solver::SlepcEigenSolver::~SlepcEigenSolver</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00035">35</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// destroy the solver context</span>
  PetscErrorCode ierr = 0;
  ierr = EPSDestroy(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ab5abb46caef01bfd8c89753415bf52f2"></a><!-- doxytag: member="Solver::SlepcEigenSolver::clear" ref="ab5abb46caef01bfd8c89753415bf52f2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ab5abb46caef01bfd8c89753415bf52f2">Solver::SlepcEigenSolver::clear</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this method clears the data structures of this object. This should be called each time the used finishes using this object. </p>

<p>Reimplemented from <a class="el" href="class_solver_1_1_f_e_system_solver_base.html#a8a0975de208bb425f4c1b21d12a9f7b0">Solver::FESystemSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00047">47</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_solver_base_8_c_source.html#l00044">Solver::FESystemSolverBase::clear()</a>, and <a class="el" href="_f_e_system_numbers_8h_source.html#l00010">FESystemNumbers::InvalidID</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a8f8856ed0d2f4d75dcb995035c9a2f17" title="if the solution has been performed">solution_completed</a> = <span class="keyword">false</span>;
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a> = <a class="code" href="namespace_f_e_system_numbers.html#a6247b3ec1c348e954beffbd2fabd2bef" title="an ID that will always be considered to be invalid in the code.">FESystemNumbers::InvalidID</a>;
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8" title="vector of sorted eigenvalue indexes, for permutation">eigen_val_permutation</a>.clear();
  
  <a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ab5abb46caef01bfd8c89753415bf52f2">Solver::FESystemSolverBase::clear</a>();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_slepc_eigen_solver_ab5abb46caef01bfd8c89753415bf52f2_cgraph.gif" border="0" usemap="#class_solver_1_1_slepc_eigen_solver_ab5abb46caef01bfd8c89753415bf52f2_cgraph" alt=""/></div>
<map name="class_solver_1_1_slepc_eigen_solver_ab5abb46caef01bfd8c89753415bf52f2_cgraph" id="class_solver_1_1_slepc_eigen_solver_ab5abb46caef01bfd8c89753415bf52f2_cgraph">
<area shape="rect" id="node3" href="class_solver_1_1_f_e_system_solver_base.html#a8a0975de208bb425f4c1b21d12a9f7b0" title="Solver::FESystemSolverBase::clear" alt="" coords="261,5,494,33"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae25271a5c01f45949f6fe36692b2625b"></a><!-- doxytag: member="Solver::SlepcEigenSolver::getEigenPair" ref="ae25271a5c01f45949f6fe36692b2625b" args="(unsigned int pair_index, double *real_value, double *img_value, NumericVector&lt; double &gt; &amp;real_vec, NumericVector&lt; double &gt; &amp;img_vec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ae25271a5c01f45949f6fe36692b2625b">Solver::SlepcEigenSolver::getEigenPair</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>pair_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>real_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>img_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NumericVector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>real_vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NumericVector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>img_vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this method returns the eigen pair </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pair_index</td><td>index of the requested eigenpair </td></tr>
    <tr><td class="paramname">real_value</td><td>real part of the eigenvalue </td></tr>
    <tr><td class="paramname">img_value</td><td>imaginary part of the eigenvalue </td></tr>
    <tr><td class="paramname">real_vec</td><td>real part of the eigenvector </td></tr>
    <tr><td class="paramname">img_vec</td><td>imaginary part of the eigenvector </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_solver_1_1_eigen_solver_base.html#a87793fd4af037c0c72c281946084ab2f">Solver::EigenSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00598">598</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// make sure that the requested index is less than the number of converged </span>
  <span class="comment">// eigenpairs </span>
  Assert(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a8f8856ed0d2f4d75dcb995035c9a2f17" title="if the solution has been performed">solution_completed</a>, ExcInvalidState()); 
  Assert(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a> &gt; 0, ExcInternalError()); 
  Assert((<span class="keywordtype">int</span>) pair_index &lt; this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>, ExcInternalError()); 
  
  PetscVector&lt;double&gt;&amp; real_vec_ref = <span class="keyword">dynamic_cast&lt;</span>PetscVector&lt;double&gt;&amp; <span class="keyword">&gt;</span>(real_vec); 
  PetscVector&lt;double&gt;&amp; img_vec_ref = <span class="keyword">dynamic_cast&lt;</span>PetscVector&lt;double&gt;&amp; <span class="keyword">&gt;</span>(img_vec); 
  
  <span class="comment">// now get the eigen pair</span>
  PetscErrorCode ierr = 0; 
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#add762d4a9c00847e56e6ef3f26359c80">ifSwapMatrices</a>())
    {
    <span class="keywordtype">double</span> rval=0.0, ival=0.0, mag=0.0;
    ierr = EPSGetEigenpair(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8" title="vector of sorted eigenvalue indexes, for permutation">eigen_val_permutation</a>[pair_index],
                           &amp;rval, &amp;ival,
                           real_vec_ref.vec(), img_vec_ref.vec());
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    mag = rval * rval + ival * ival;
      *real_value = rval/mag;
      *img_value = -ival/mag;
    }
  <span class="keywordflow">else</span>
    {
    ierr = EPSGetEigenpair(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8" title="vector of sorted eigenvalue indexes, for permutation">eigen_val_permutation</a>[pair_index],
                           real_value, img_value,
                           real_vec_ref.vec(), img_vec_ref.vec());
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a638925a42bf0b42f4d466c5db4819d2f"></a><!-- doxytag: member="Solver::SlepcEigenSolver::getEigenPairRelativeError" ref="a638925a42bf0b42f4d466c5db4819d2f" args="(const unsigned int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual double <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a638925a42bf0b42f4d466c5db4819d2f">Solver::SlepcEigenSolver::getEigenPairRelativeError</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this method computes and returns the relative error for the specified eigen value index. This is only for Hermitian problems </p>

<p>Implements <a class="el" href="class_solver_1_1_eigen_solver_base.html#af78320277b9fea3745e0c4c44310617e">Solver::EigenSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8h_source.html#l00191">191</a> of file <a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>.</p>
<div class="fragment"><pre class="fragment">    {
      (void) index;
      Assert(<span class="keyword">false</span>, ExcInternalError());
      <span class="keywordflow">return</span> (<span class="keywordtype">double</span>) NULL;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a86a8b975f24058cf032ee32e5613afcf"></a><!-- doxytag: member="Solver::SlepcEigenSolver::getEigenPairResidualError" ref="a86a8b975f24058cf032ee32e5613afcf" args="(const unsigned int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual double <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a86a8b975f24058cf032ee32e5613afcf">Solver::SlepcEigenSolver::getEigenPairResidualError</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>index</em></td><td>)</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this method computes and returns the residual error for the specified eigen value index. This is only for Hermitian problems </p>

<p>Implements <a class="el" href="class_solver_1_1_eigen_solver_base.html#a3f5c892c04b4cf923c1a6fa34d3adb01">Solver::EigenSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8h_source.html#l00181">181</a> of file <a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>.</p>
<div class="fragment"><pre class="fragment">    {
      (void) index;
      Assert(<span class="keyword">false</span>, ExcInternalError());
      <span class="keywordflow">return</span> (<span class="keywordtype">double</span>) NULL;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a70b6fdbe984df6c22417ae484c65caf1"></a><!-- doxytag: member="Solver::SlepcEigenSolver::getEigenValue" ref="a70b6fdbe984df6c22417ae484c65caf1" args="(unsigned int eigen_index, double *real_value, double *img_value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a70b6fdbe984df6c22417ae484c65caf1">Solver::SlepcEigenSolver::getEigenValue</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>eigen_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>real_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>img_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>this method returns the eigen valie </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pair_index</td><td>index of the requested eigenvalue </td></tr>
    <tr><td class="paramname">real_value</td><td>real part of the eigenvalue </td></tr>
    <tr><td class="paramname">img_value</td><td>imaginary part of the eigenvalue </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_solver_1_1_eigen_solver_base.html#a455f62a05d7600dfa2a1ab0fd0c461da">Solver::EigenSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00540">540</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// make sure that the requested index is less than the number of converged </span>
  <span class="comment">// eigenpairs</span>
  Assert(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a8f8856ed0d2f4d75dcb995035c9a2f17" title="if the solution has been performed">solution_completed</a>, ExcInvalidState());
  Assert(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a> &gt; 0, ExcInternalError());
  Assert((<span class="keywordtype">int</span>) eigen_index &lt; this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>, ExcInternalError());
  
  <span class="comment">// now get the eigen pair</span>
  PetscErrorCode ierr = 0;
  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#add762d4a9c00847e56e6ef3f26359c80">ifSwapMatrices</a>())
    {
    <span class="keywordtype">double</span> rval=0.0, ival=0.0, mag=0.0;
    ierr = EPSGetValue(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8" title="vector of sorted eigenvalue indexes, for permutation">eigen_val_permutation</a>[eigen_index],
                       &amp;rval, &amp;ival);
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    mag = sqrt(rval * rval + ival * ival);
    *real_value = rval / mag;
    *img_value = ival / mag;
    }
  <span class="keywordflow">else</span>
    {
    ierr = EPSGetValue(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8" title="vector of sorted eigenvalue indexes, for permutation">eigen_val_permutation</a>[eigen_index],
                       real_value, img_value);
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a7889ef300cce7ba0a40920f68b1f5e81"></a><!-- doxytag: member="Solver::SlepcEigenSolver::getInvariantSubspace" ref="a7889ef300cce7ba0a40920f68b1f5e81" args="(std::vector&lt; NumericVector&lt; double &gt; * &gt; &amp;vectors)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a7889ef300cce7ba0a40920f68b1f5e81">Solver::SlepcEigenSolver::getInvariantSubspace</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; NumericVector&lt; double &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>vectors</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="class_solver_1_1_eigen_solver_base.html#acc1d24c8ae155c9f6e723c98b3b006ef">Solver::EigenSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00574">574</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  Assert(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a8f8856ed0d2f4d75dcb995035c9a2f17" title="if the solution has been performed">solution_completed</a>, ExcInvalidState()); 
  Assert(vectors.size() == this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a5845ca3c45b3f3323feaf17aacb1fe75">getNConvergedEigenPairs</a>(), ExcInternalError());
  PetscErrorCode ierr = 0; 
  Vec pvec = PETSC_NULL;
  
  std::vector&lt;Vec&gt; vecs(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a5845ca3c45b3f3323feaf17aacb1fe75">getNConvergedEigenPairs</a>());
  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a5845ca3c45b3f3323feaf17aacb1fe75">getNConvergedEigenPairs</a>(); i++)
    {
      pvec = <span class="keyword">dynamic_cast&lt;</span>PetscVector&lt;double&gt;*<span class="keyword">&gt;</span>(vectors[i])-&gt;vec();
      vecs[i] = pvec;
    }
  
  ierr = EPSGetInvariantSubspace(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, &amp;(vecs[0]));
  
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5845ca3c45b3f3323feaf17aacb1fe75"></a><!-- doxytag: member="Solver::SlepcEigenSolver::getNConvergedEigenPairs" ref="a5845ca3c45b3f3323feaf17aacb1fe75" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a5845ca3c45b3f3323feaf17aacb1fe75">Solver::SlepcEigenSolver::getNConvergedEigenPairs</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="return"><dt><b>Returns:</b></dt><dd>the number of converged eigen pairs </dd></dl>

<p>Implements <a class="el" href="class_solver_1_1_eigen_solver_base.html#a8f47a2b7250baba3cb8a49ac88160ebc">Solver::EigenSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00059">59</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// make sure that the solution has been performed.</span>
  Assert(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a8f8856ed0d2f4d75dcb995035c9a2f17" title="if the solution has been performed">solution_completed</a>, ExcInvalidState());

  <span class="keywordflow">return</span> this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>;
}
</pre></div>
</div>
</div>
<a class="anchor" id="abc07eb2e85d98560b29e281f9723dbcd"></a><!-- doxytag: member="Solver::SlepcEigenSolver::getResidualForEigenPair" ref="abc07eb2e85d98560b29e281f9723dbcd" args="(const unsigned int i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#abc07eb2e85d98560b29e281f9723dbcd">Solver::SlepcEigenSolver::getResidualForEigenPair</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>this method calculates a residual for the given eigen value and returns it </p>

<p>Implements <a class="el" href="class_solver_1_1_eigen_solver_base.html#aca341b2d219090a4981c0adf90f2d347">Solver::EigenSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00637">637</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr = 0; 
  <span class="keywordtype">double</span> return_val = 0.0;
  ierr = EPSComputeResidualNorm(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8" title="vector of sorted eigenvalue indexes, for permutation">eigen_val_permutation</a>[i], &amp;return_val);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="keywordflow">return</span> return_val;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a79bebe8f3bfbe86ad2d1a0df3fe1bdbf"></a><!-- doxytag: member="Solver::SlepcEigenSolver::setEigenShift" ref="a79bebe8f3bfbe86ad2d1a0df3fe1bdbf" args="(const unsigned int eigen_shift_kind, const double shift_value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a79bebe8f3bfbe86ad2d1a0df3fe1bdbf">Solver::SlepcEigenSolver::setEigenShift</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>eigen_shift_kind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>shift_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sets the shift for the solver </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00130">130</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_eigen_solver_8h_source.html#l00221">CAYLEY_SHIFT_ENUM_ID</a>, <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_eigen_solver_8h_source.html#l00168">NO_SHIFT_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00181">ORIGIN_SHIFT_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00207">SHIFT_AND_INVERT_ENUM_ID</a>, and <a class="el" href="_eigen_solver_8h_source.html#l00194">SPECTRUM_FOLD_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr = 0;
  <span class="keywordtype">bool</span> apply_shift = <span class="keyword">true</span>;
  STType type;
    
  <span class="keywordflow">switch</span>(eigen_shift_kind)
    {
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a7fcb81f7bca9376b44b893b3e587b5db">NO_SHIFT_ENUM_ID</a>:
      apply_shift = <span class="keyword">false</span>;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a3380e650a614349600d1334591429e40">ORIGIN_SHIFT_ENUM_ID</a>:
      type = STSHIFT;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a10dd8b8afe17bdd510835311e587c4eb">SPECTRUM_FOLD_ENUM_ID</a>:
      type = STFOLD;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#ac75851b86f29078532c057505a57a77d">SHIFT_AND_INVERT_ENUM_ID</a>:
      type = STSINV;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a5eeb3c6ccecd3d1563ce8c5bdfb4ca16">CAYLEY_SHIFT_ENUM_ID</a>:
      type = STCAYLEY;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>: 
      AssertThrow(<span class="keyword">false</span>, ExcInternalError());
    }
  
  ST st;
  ierr = EPSGetST(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, &amp;st); 
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);

  <span class="keywordflow">if</span> (apply_shift)
    {
    ierr = STSetType(st, type); 
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    
    ierr = STSetShift(st, shift_value); 
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    }
  <span class="keywordflow">else</span>
    {
    <span class="comment">// Slepc handles the no shift as STSHIFT with shift of 0.0</span>
    ierr = STSetType(st, STSHIFT); 
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    
    ierr = STSetShift(st, 0.0); 
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa6d16795669629b83c837d8c0a0516db"></a><!-- doxytag: member="Solver::SlepcEigenSolver::setEigenSpectrumEnd" ref="aa6d16795669629b83c837d8c0a0516db" args="(const unsigned int eigen_spectrum_end)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#aa6d16795669629b83c837d8c0a0516db">Solver::SlepcEigenSolver::setEigenSpectrumEnd</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>eigen_spectrum_end</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sets the eigen spectrum end to solve for </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00087">87</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_eigen_solver_8h_source.html#l00143">LARGEST_IMAGINARY_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00092">LARGEST_MAGNITUDE_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00117">LARGEST_REAL_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00155">SMALLEST_IMAGINARY_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00104">SMALLEST_MAGNITUDE_ENUM_ID</a>, and <a class="el" href="_eigen_solver_8h_source.html#l00129">SMALLEST_REAL_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr = 0;
  
  <span class="keywordflow">switch</span>(eigen_spectrum_end)
    {
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#aded56689822639d6a47d336e0e448889">LARGEST_MAGNITUDE_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760" title="which eigenspectrum end to solve for">eps_spectrum_end</a> = EPS_LARGEST_MAGNITUDE;
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a48051e3fb91480f2ff2b8a04d7b41c58">SMALLEST_MAGNITUDE_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760" title="which eigenspectrum end to solve for">eps_spectrum_end</a> = EPS_SMALLEST_MAGNITUDE;
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a363a3ac2c2f75ca5c162ae1c7bc85aa2">LARGEST_REAL_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760" title="which eigenspectrum end to solve for">eps_spectrum_end</a> = EPS_LARGEST_REAL;
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a55b530cbe0d5f71d482cd67f9ca1cf3d">SMALLEST_REAL_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760" title="which eigenspectrum end to solve for">eps_spectrum_end</a> = EPS_SMALLEST_REAL;
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a3173b471c1b0eed7ffd14fa28e6b9613">LARGEST_IMAGINARY_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760" title="which eigenspectrum end to solve for">eps_spectrum_end</a> = EPS_LARGEST_IMAGINARY;
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a092f17a05656dfc9cc22b771ab6b5930">SMALLEST_IMAGINARY_ENUM_ID</a>:
      this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760" title="which eigenspectrum end to solve for">eps_spectrum_end</a> = EPS_SMALLEST_IMAGINARY;
      <span class="keywordflow">break</span>;

    <span class="keywordflow">default</span>: 
      AssertThrow(<span class="keyword">false</span>, ExcInternalError());
    }
    
  ierr = EPSSetWhichEigenpairs(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760" title="which eigenspectrum end to solve for">eps_spectrum_end</a>); 
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a50e890bd799a1739e6b1e1f2f2a8ec44"></a><!-- doxytag: member="Solver::SlepcEigenSolver::setLinearSolverDetails" ref="a50e890bd799a1739e6b1e1f2f2a8ec44" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a50e890bd799a1739e6b1e1f2f2a8ec44">Solver::SlepcEigenSolver::setLinearSolverDetails</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sets the linear solver details </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00290">290</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr = 0;

  <span class="comment">// get ST context </span>
  ST st;
  ierr = EPSGetST(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, &amp;st); 
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae7b7ab632a0c55ec800aebc8d9ed782d">petsc_linear_solver</a>.reset(<span class="keyword">new</span> <a class="code" href="class_solver_1_1_petsc_linear_solver.html">Solver::PetscLinearSolver</a>(this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#a2d3c176ab7b3677b66bfbdbdd01ccdf4" title="LinearSolverInfo that stores information about this solver.">linear_solver_info</a>));
  
  KSP ksp = this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae7b7ab632a0c55ec800aebc8d9ed782d">petsc_linear_solver</a>-&gt;getKSP();

  ierr = STSetKSP(st, ksp);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);


}
</pre></div>
</div>
</div>
<a class="anchor" id="ac6236f402f8a82180ea10640e09f8fe1"></a><!-- doxytag: member="Solver::SlepcEigenSolver::setNEigenSetsToCompute" ref="ac6236f402f8a82180ea10640e09f8fe1" args="(const unsigned int n_eigs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ac6236f402f8a82180ea10640e09f8fe1">Solver::SlepcEigenSolver::setNEigenSetsToCompute</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>n_eigs</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sets the number of eigen sets to compute </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00073">73</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr = 0;
  
  <span class="comment">// set the number of eigen values to compute</span>
  ierr = EPSSetDimensions(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, 
                          n_eigs,
                          PETSC_DECIDE, PETSC_DECIDE); 
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a64e916c319b719b6e788838d1c505f43"></a><!-- doxytag: member="Solver::SlepcEigenSolver::setProblemKind" ref="a64e916c319b719b6e788838d1c505f43" args="(const unsigned int enum_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a64e916c319b719b6e788838d1c505f43">Solver::SlepcEigenSolver::setProblemKind</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>enum_ID</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>this sets the problem kind </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00246">246</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_eigen_solver_8h_source.html#l00052">GENERALIZED_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00078">GENERALIZED_NON_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00039">HERMITIAN_EIGENPROBLEM_ENUM_ID</a>, and <a class="el" href="_eigen_solver_8h_source.html#l00065">NON_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr = 0;

  <span class="comment">// now set the  problem type </span>
  <span class="keywordflow">switch</span> (enum_ID)
    {
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a0c8ccea7a98ed15cd9e8c64a9975c7d3">HERMITIAN_EIGENPROBLEM_ENUM_ID</a>:
      {
        ierr = EPSSetProblemType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPS_HEP);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a058084cdb9894a435d2675993c9811d3">NON_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>:
      {
        ierr = EPSSetProblemType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPS_NHEP);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a8486529cfae0cb472ba66ac183edfe62">GENERALIZED_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>:
      {
        ierr = EPSSetProblemType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPS_GHEP);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a2eac58428a4b49442a91309a92c96e8e">GENERALIZED_NON_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>:
      {
        ierr = EPSSetProblemType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPS_GNHEP);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      AssertThrow(<span class="keyword">false</span>, ExcInternalError());
      <span class="keywordflow">break</span>;
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a76514cac29097b5caa931a9d828953ff"></a><!-- doxytag: member="Solver::SlepcEigenSolver::setSolverOptions" ref="a76514cac29097b5caa931a9d828953ff" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a76514cac29097b5caa931a9d828953ff">Solver::SlepcEigenSolver::setSolverOptions</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sets the solver options </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00316">316</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>
<div class="fragment"><pre class="fragment">{
  <span class="comment">// the options for this solver are set based on how Slepc handles them in a sequence. </span>
  <span class="comment">// the sequence in 2.3.2 is</span>
  <span class="comment">// type, problem type, class, orthogonalization, orthogonalization refinement, </span>
  <span class="comment">// tolerances, dimensions, monitor, which eigenpairs, st_options</span>
  <span class="comment">// and the st options are handles in the following sequence</span>
  <span class="comment">// type, shift, mat mode, mat structure</span>
  
  <span class="comment">// now all of these options are handles in this solver, but the ones that are, will be set</span>
  <span class="comment">// in the same sequence.</span>

  <span class="comment">// type</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> solver_type = this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#a474204afe0dbfb5979a516b0a8137794">getEigenSolverKindEnumID</a>();
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a509415779e349528dd4a302a53d870ef" title="sets the problem type">setSolverType</a>(solver_type);
  
  <span class="comment">// problem type</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> problem_type_enum_ID = this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#ae910499b4b65cbd181f3f9864955249e">getEigenProblemKindEnumID</a>();
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a64e916c319b719b6e788838d1c505f43" title="this sets the problem kind">setProblemKind</a>(problem_type_enum_ID);
  
  <span class="comment">// class not handled</span>
  
  <span class="comment">// orthogonalization not handled</span>
  
  <span class="comment">// orthogonalization refinement not handled</span>
  
  <span class="comment">// tolerances not handled</span>
  
  <span class="comment">// dimensions</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_eigen_sets = this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#a5124de3d68d6cc5bc23830d9193ca8c0">getNEigenPairsToSolve</a>();
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ac6236f402f8a82180ea10640e09f8fe1" title="sets the number of eigen sets to compute">setNEigenSetsToCompute</a>(n_eigen_sets);
  
  <span class="comment">// monitor not handled</span>
  
  <span class="comment">// which eigenpairs</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> eigen_spectrum_end = this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#a30f69314045e22b0dc000da572520be1">getEigenSpectrumToCompute</a>();
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#aa6d16795669629b83c837d8c0a0516db" title="sets the eigen spectrum end to solve for">setEigenSpectrumEnd</a>(eigen_spectrum_end);
  
  <span class="comment">// ST type and shift</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> eigen_shift_kind = this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#aaa4e4eb4cfe448bb59fbeace353931aa">getEigenSolverShiftKind</a>();
  <span class="keywordtype">double</span> shift_value = this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#a17b794f6285fcb334a91b2104d1df477">getEigenSolverShiftValue</a>();
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a79bebe8f3bfbe86ad2d1a0df3fe1bdbf" title="sets the shift for the solver">setEigenShift</a>(eigen_shift_kind, shift_value);
  
  <span class="comment">// set the details of the ksp and pc for the linear solver used in the solver</span>
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a50e890bd799a1739e6b1e1f2f2a8ec44" title="sets the linear solver details">setLinearSolverDetails</a>();
}
</pre></div>
</div>
</div>
<a class="anchor" id="a509415779e349528dd4a302a53d870ef"></a><!-- doxytag: member="Solver::SlepcEigenSolver::setSolverType" ref="a509415779e349528dd4a302a53d870ef" args="(const unsigned int enum_ID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a509415779e349528dd4a302a53d870ef">Solver::SlepcEigenSolver::setSolverType</a> </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>enum_ID</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>sets the problem type </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00189">189</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_slepc_eigen_solver_8h_source.html#l00060">EPS_ARNOLDI_EIGEN_SOLVER_ENUM_ID</a>, <a class="el" href="_slepc_eigen_solver_8h_source.html#l00086">EPS_KRYLOV_SCHUR_EIGEN_SOLVER_ENUM_ID</a>, <a class="el" href="_slepc_eigen_solver_8h_source.html#l00073">EPS_LANCZOS_EIGEN_SOLVER_ENUM_ID</a>, <a class="el" href="_slepc_eigen_solver_8h_source.html#l00021">EPS_LAPACK_EIGEN_SOLVER_ENUM_ID</a>, <a class="el" href="_slepc_eigen_solver_8h_source.html#l00034">EPS_POWER_EIGEN_SOLVER_ENUM_ID</a>, and <a class="el" href="_slepc_eigen_solver_8h_source.html#l00047">EPS_SUBSPACE_EIGEN_SOLVER_ENUM_ID</a>.</p>
<div class="fragment"><pre class="fragment">{
  PetscErrorCode ierr = 0;
  
  <span class="comment">// and set the solver type</span>
  <span class="keywordflow">switch</span> (enum_ID)
    {
    <span class="keywordflow">case</span> <a class="code" href="_slepc_eigen_solver_8h.html#a231a99d58b7f943e9e529c1482312475">EPS_LAPACK_EIGEN_SOLVER_ENUM_ID</a>:
      {
        ierr = EPSSetType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPSLAPACK);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_slepc_eigen_solver_8h.html#ad053559c44cde9e4be15ebaf0c31124c">EPS_POWER_EIGEN_SOLVER_ENUM_ID</a>:
      {
        ierr = EPSSetType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPSPOWER);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_slepc_eigen_solver_8h.html#a44350932963a17d615f015faaa3afac2">EPS_SUBSPACE_EIGEN_SOLVER_ENUM_ID</a>:
      {
        ierr = EPSSetType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPSSUBSPACE);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_slepc_eigen_solver_8h.html#abb50f71f95187c9f58789500399a7e4a">EPS_ARNOLDI_EIGEN_SOLVER_ENUM_ID</a>:
      {
        ierr = EPSSetType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPSARNOLDI);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_slepc_eigen_solver_8h.html#a3e51c9b8dce663da2398873b63ac9f23">EPS_LANCZOS_EIGEN_SOLVER_ENUM_ID</a>:
      {
        ierr = EPSSetType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPSLANCZOS);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> <a class="code" href="_slepc_eigen_solver_8h.html#a9ec1dc3079551b84a370e340b6d22289">EPS_KRYLOV_SCHUR_EIGEN_SOLVER_ENUM_ID</a>:
      {
        ierr = EPSSetType(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, EPSKRYLOVSCHUR);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      AssertThrow(<span class="keyword">false</span>, ExcInternalError());
      <span class="keywordflow">break</span>;
    }
  
}
</pre></div>
</div>
</div>
<a class="anchor" id="aafd2f0f44a64ccffb1e469043a2fe2a7"></a><!-- doxytag: member="Solver::SlepcEigenSolver::solve" ref="aafd2f0f44a64ccffb1e469043a2fe2a7" args="(SparseMatrix&lt; double &gt; *A_mat, SparseMatrix&lt; double &gt; *B_mat=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#aafd2f0f44a64ccffb1e469043a2fe2a7">Solver::SlepcEigenSolver::solve</a> </td>
          <td>(</td>
          <td class="paramtype">SparseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>A_mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SparseMatrix&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>B_mat</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>method to solve the eigen system </p>

<p>Implements <a class="el" href="class_solver_1_1_eigen_solver_base.html#aeba0a5c4b70a3b2bc87607b508912a72">Solver::EigenSolverBase</a>.</p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00368">368</a> of file <a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a>.</p>

<p>References <a class="el" href="_f_e_system_common_8h_source.html#l00013">FESystem::COMM_WORLD</a>, <a class="el" href="_eigen_solver_8h_source.html#l00052">GENERALIZED_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00078">GENERALIZED_NON_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00039">HERMITIAN_EIGENPROBLEM_ENUM_ID</a>, <a class="el" href="_eigen_solver_8h_source.html#l00065">NON_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>, and <a class="el" href="_parallel_utility_8h_source.html#l00034">FESystemUtility::Parallel::PrintAll()</a>.</p>
<div class="fragment"><pre class="fragment">{
  this-&gt;<a class="code" href="class_solver_1_1_f_e_system_solver_base.html#ad52a2063f53a41980f6da440ba289c64" title="analysis driver pointer">analysis_driver</a>-&gt;<a class="code" href="class_driver_1_1_analysis_driver.html#afc031cf4f9058917779cec23a3f8b995">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;setEvent
  (<span class="stringliteral">&quot;SlepcEigenSolver::solve()&quot;</span>, <span class="stringliteral">&quot;Solver&quot;</span>);
  
  PetscErrorCode ierr = 0;
  
  Assert(A_mat != NULL, ExcInternalError());
  
  A_mat-&gt;close();
  PetscMatrix&lt;double&gt; *petsc_A_mat = <span class="keyword">dynamic_cast&lt;</span>PetscMatrix&lt;double&gt;*<span class="keyword">&gt;</span>(A_mat);

  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> problem_type_enum_ID = this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#ae910499b4b65cbd181f3f9864955249e">getEigenProblemKindEnumID</a>();

  <span class="keywordflow">switch</span>(problem_type_enum_ID)
    {
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a0c8ccea7a98ed15cd9e8c64a9975c7d3">HERMITIAN_EIGENPROBLEM_ENUM_ID</a>:
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a058084cdb9894a435d2675993c9811d3">NON_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>:
      {
        <span class="comment">// if the problem is not generalized eigen problem, then only the A_matrix </span>
        <span class="comment">// needs to be specified</span>
        Assert(B_mat == NULL, ExcInternalError());
        ierr = EPSSetOperators(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, petsc_A_mat-&gt;mat(), PETSC_NULL);
        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);  
      }
      <span class="keywordflow">break</span>;

    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a8486529cfae0cb472ba66ac183edfe62">GENERALIZED_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>:
    <span class="keywordflow">case</span> <a class="code" href="_eigen_solver_8h.html#a2eac58428a4b49442a91309a92c96e8e">GENERALIZED_NON_HERMITIAN_EIGENPROBLEM_ENUM_ID</a>:
      {
        <span class="comment">// if the problem is a generalized eigen problem, then both the A and B matrices </span>
        <span class="comment">// need to be specified</span>
        Assert(B_mat != NULL, ExcInternalError());
        B_mat-&gt;close();
        PetscMatrix&lt;double&gt; *petsc_B_mat = <span class="keyword">dynamic_cast&lt;</span>PetscMatrix&lt;double&gt;*<span class="keyword">&gt;</span>(B_mat);
        
        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="class_solver_1_1_eigen_solver_base.html#af4effacca48a5897347d1300c9e0b4e8" title="EigenSolverInfo that stores information about this solver.">eigen_solver_info</a>.<a class="code" href="class_solver_1_1_eigen_solver_info.html#add762d4a9c00847e56e6ef3f26359c80">ifSwapMatrices</a>())
          ierr = EPSSetOperators(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, petsc_B_mat-&gt;mat(), petsc_A_mat-&gt;mat());
        <span class="keywordflow">else</span>
          ierr = EPSSetOperators(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, petsc_A_mat-&gt;mat(), petsc_B_mat-&gt;mat());

        CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      AssertThrow(<span class="keyword">false</span>, ExcInternalError());
      <span class="keywordflow">break</span>;
    }
  

  <span class="comment">// before solution, set all the options of the solver</span>
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a76514cac29097b5caa931a9d828953ff" title="sets the solver options">setSolverOptions</a>();
  
 <span class="comment">// ierr = EPSSetType(eps, EPSLANCZOS); CHKERRABORT(FESystem::COMM_WORLD, ierr);  </span>
<span class="comment">//  </span>
<span class="comment">//  ierr = EPSSetProblemType(eps, EPS_GHEP); CHKERRABORT(FESystem::COMM_WORLD, ierr);  </span>
<span class="comment">//  </span>
<span class="comment">//  ierr = EPSSetDimensions(eps, 4, PETSC_DECIDE); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
<span class="comment">//  </span>
<span class="comment">//  ierr = EPSSetWhichEigenpairs(eps, EPS_SMALLEST_MAGNITUDE); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
<span class="comment">//  </span>
<span class="comment">//  ST st;</span>
<span class="comment">//  ierr = EPSGetST(eps, &amp;st); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
<span class="comment">//  </span>
<span class="comment">//  ierr = STSetType(st, STSINV); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
<span class="comment">//  </span>
<span class="comment">//  ierr = STSetShift(st, 40000.0); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
<span class="comment">//  </span>
<span class="comment">//  ierr = EPSGetST(eps, &amp;st); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
<span class="comment">//  </span>
<span class="comment">//  KSP ksp;</span>
<span class="comment">//  PC pc;</span>
<span class="comment">//  </span>
<span class="comment">//  ierr = STGetKSP(st, &amp;ksp); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
<span class="comment">//  </span>
<span class="comment">//  ierr = KSPGetPC(ksp, &amp;pc); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
<span class="comment">//  </span>
<span class="comment">//  ierr = KSPSetType(ksp, KSPPREONLY); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
<span class="comment">//  </span>
<span class="comment">//  ierr = PCSetType(pc, PCLU); CHKERRABORT(FESystem::COMM_WORLD, ierr);</span>
  
  <span class="comment">// solve </span>
  ierr = EPSSolve(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  <span class="comment">// get the reason for convergence of the solver</span>
  EPSConvergedReason reason;
  ierr = EPSGetConvergedReason(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, &amp;reason);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
  
  
  <span class="comment">// get the number of converged eigenpairs</span>
  ierr = EPSGetConverged(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, &amp;this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
        
  
  <span class="keywordflow">switch</span>(reason)
    {
    <span class="keywordflow">case</span> EPS_CONVERGED_TOL:
      {
        <a class="code" href="namespace_f_e_system_utility_1_1_parallel.html#ada2fd6d252a18aa62e81cfedab493838">FESystemUtility::Parallel::PrintAll</a>(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,<span class="stringliteral">&quot; EigenSolver converged up to tolerance.&quot;</span>);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> EPS_DIVERGED_ITS:
      {
        <a class="code" href="namespace_f_e_system_utility_1_1_parallel.html#ada2fd6d252a18aa62e81cfedab493838">FESystemUtility::Parallel::PrintAll</a>(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,
                                            <span class="stringliteral">&quot; EigenSolver did not converge in maximum iterations.&quot;</span>);
      }      
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> EPS_DIVERGED_BREAKDOWN:
      {
        <a class="code" href="namespace_f_e_system_utility_1_1_parallel.html#ada2fd6d252a18aa62e81cfedab493838">FESystemUtility::Parallel::PrintAll</a>(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,<span class="stringliteral">&quot; EigenSolver broke down.&quot;</span>);
      }      
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">case</span> EPS_DIVERGED_NONSYMMETRIC:
      {
        <a class="code" href="namespace_f_e_system_utility_1_1_parallel.html#ada2fd6d252a18aa62e81cfedab493838">FESystemUtility::Parallel::PrintAll</a>(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>,<span class="stringliteral">&quot; EigenSolver operator is non-symmetric.&quot;</span>);
      }
      <span class="keywordflow">break</span>;
      
    <span class="keywordflow">default</span>:
      abort();
      <span class="keywordflow">break</span>;
    }
  
  <span class="comment">// once the solution is done, sort the eigen values according to the </span>
  <span class="comment">// criteria for solution</span>
  <span class="keywordtype">int</span> *permute_vec = <span class="keyword">new</span> <span class="keywordtype">int</span>[this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>];
  <span class="keywordtype">double</span> *val_r_vec = <span class="keyword">new</span> <span class="keywordtype">double</span>[this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>],
    *val_i_vec = <span class="keyword">new</span> <span class="keywordtype">double</span>[this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>];
  
  <span class="keywordtype">double</span> r_val, i_val;
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>; i++)
    {
    r_val = 0.0; i_val = 0.0;
    ierr = EPSGetValue(this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3" title="an eigenvalue problem solver context">eps</a>, i, &amp;r_val, &amp;i_val);
    CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);
    val_r_vec[i] = r_val;
    val_i_vec[i] = i_val;
    }
  
  ierr = EPSSortEigenvalues(this-&gt;n_converged_eigen_pairs,
                            val_r_vec, val_i_vec,
                            this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760" title="which eigenspectrum end to solve for">eps_spectrum_end</a>,
                            this-&gt;n_converged_eigen_pairs,
                            permute_vec);
  CHKERRABORT(<a class="code" href="namespace_f_e_system.html#a5853d15aa6f256e9f068a040b5f13b6e" title="world MPI communicator for all processors">FESystem::COMM_WORLD</a>, ierr);

  <span class="comment">// now store the permutation indices</span>
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8" title="vector of sorted eigenvalue indexes, for permutation">eigen_val_permutation</a>.resize(this-&gt;n_converged_eigen_pairs);
  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b" title="number of converged eigenpairs">n_converged_eigen_pairs</a>; i++)
    this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8" title="vector of sorted eigenvalue indexes, for permutation">eigen_val_permutation</a>[i] = permute_vec[i];
  
  <span class="comment">// now delete the vectors created</span>
  <span class="keyword">delete</span>[] permute_vec;
  <span class="keyword">delete</span>[] val_r_vec;
  <span class="keyword">delete</span>[] val_i_vec;
  
  this-&gt;<a class="code" href="class_solver_1_1_slepc_eigen_solver.html#a8f8856ed0d2f4d75dcb995035c9a2f17" title="if the solution has been performed">solution_completed</a> = <span class="keyword">true</span>;

  this-&gt;<a class="code" href="class_solver_1_1_f_e_system_solver_base.html#ad52a2063f53a41980f6da440ba289c64" title="analysis driver pointer">analysis_driver</a>-&gt;<a class="code" href="class_driver_1_1_analysis_driver.html#afc031cf4f9058917779cec23a3f8b995">getFESystemController</a>().<a class="code" href="class_f_e_system_1_1_f_e_system_controller.html#a4201bf5919eac5fb0fcc87ba36368d6c" title="Performance logging.">performance_logging</a>-&gt;unsetEvent
    (<span class="stringliteral">&quot;SlepcEigenSolver::solve()&quot;</span>, <span class="stringliteral">&quot;Solver&quot;</span>);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="class_solver_1_1_slepc_eigen_solver_aafd2f0f44a64ccffb1e469043a2fe2a7_cgraph.gif" border="0" usemap="#class_solver_1_1_slepc_eigen_solver_aafd2f0f44a64ccffb1e469043a2fe2a7_cgraph" alt=""/></div>
<map name="class_solver_1_1_slepc_eigen_solver_aafd2f0f44a64ccffb1e469043a2fe2a7_cgraph" id="class_solver_1_1_slepc_eigen_solver_aafd2f0f44a64ccffb1e469043a2fe2a7_cgraph">
<area shape="rect" id="node3" href="namespace_f_e_system_utility_1_1_parallel.html#ada2fd6d252a18aa62e81cfedab493838" title="FESystemUtility::Parallel::PrintAll" alt="" coords="265,5,482,33"/></map>
</div>
</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a610f9043fb85097f8c134973ff1741d8"></a><!-- doxytag: member="Solver::SlepcEigenSolver::eigen_val_permutation" ref="a610f9043fb85097f8c134973ff1741d8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;int&gt; <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a610f9043fb85097f8c134973ff1741d8">Solver::SlepcEigenSolver::eigen_val_permutation</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>vector of sorted eigenvalue indexes, for permutation </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8h_source.html#l00242">242</a> of file <a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a22216116688906a1d27a5471e04c57e3"></a><!-- doxytag: member="Solver::SlepcEigenSolver::eps" ref="a22216116688906a1d27a5471e04c57e3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EPS <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a22216116688906a1d27a5471e04c57e3">Solver::SlepcEigenSolver::eps</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>an eigenvalue problem solver context </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8h_source.html#l00236">236</a> of file <a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>.</p>

<p>Referenced by <a class="el" href="_slepc_eigen_solver_8_c_source.html#l00019">SlepcEigenSolver()</a>.</p>

</div>
</div>
<a class="anchor" id="ae2a38abb22f9a513532154a8ad246760"></a><!-- doxytag: member="Solver::SlepcEigenSolver::eps_spectrum_end" ref="ae2a38abb22f9a513532154a8ad246760" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EPSWhich <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ae2a38abb22f9a513532154a8ad246760">Solver::SlepcEigenSolver::eps_spectrum_end</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>which eigenspectrum end to solve for </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8h_source.html#l00239">239</a> of file <a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0766936bb4c769fb389046578c41923b"></a><!-- doxytag: member="Solver::SlepcEigenSolver::n_converged_eigen_pairs" ref="a0766936bb4c769fb389046578c41923b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a0766936bb4c769fb389046578c41923b">Solver::SlepcEigenSolver::n_converged_eigen_pairs</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>number of converged eigenpairs </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8h_source.html#l00233">233</a> of file <a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae7b7ab632a0c55ec800aebc8d9ed782d"></a><!-- doxytag: member="Solver::SlepcEigenSolver::petsc_linear_solver" ref="ae7b7ab632a0c55ec800aebc8d9ed782d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::auto_ptr&lt;<a class="el" href="class_solver_1_1_petsc_linear_solver.html">Solver::PetscLinearSolver</a>&gt; <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#ae7b7ab632a0c55ec800aebc8d9ed782d">Solver::SlepcEigenSolver::petsc_linear_solver</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8h_source.html#l00244">244</a> of file <a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8f8856ed0d2f4d75dcb995035c9a2f17"></a><!-- doxytag: member="Solver::SlepcEigenSolver::solution_completed" ref="a8f8856ed0d2f4d75dcb995035c9a2f17" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_solver_1_1_slepc_eigen_solver.html#a8f8856ed0d2f4d75dcb995035c9a2f17">Solver::SlepcEigenSolver::solution_completed</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>if the solution has been performed </p>

<p>Definition at line <a class="el" href="_slepc_eigen_solver_8h_source.html#l00230">230</a> of file <a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Solvers/<a class="el" href="_slepc_eigen_solver_8h_source.html">SlepcEigenSolver.h</a></li>
<li>/Users/manav/Documents/codes/FESystemOld/FESystem/src/Solvers/<a class="el" href="_slepc_eigen_solver_8_c_source.html">SlepcEigenSolver.C</a></li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Apr 12 2012 18:06:23 for fesystem by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
